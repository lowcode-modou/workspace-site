import{a as re,u as se,R as L,b as tt,m as $,O as it}from"./main.93d08f0f.js";import{M as J,g as K}from"./router.120ec539.js";import{P as at,d as nt,p as Pe,F as rt,M as st,b as ot,B as Ie,c as lt,T as V,D as dt,e as ct,I as mt,l as _,C as pt,u as gt,f as ut}from"./AppFactoryContext.0477c70a.js";import{r as p,K as oe,v as le,a as x,j as s,x as i,Z as ft,I as ht,J as xt,O as D,V as vt,A as yt,B as ee,s as be,S as we,F as de,_ as q,n as Me,o as ze,aj as St,m as C}from"./client.35724ad0.js";import{K as bt}from"./index.modern.f7f7ec74.js";import{C as Ct,O as Pt,aB as Ce,R as It,A as Ee,au as wt,at as Mt}from"./SettingOutlined.e1c14717.js";import{L as j}from"./index.85f1f51a.js";var Ne=globalThis&&globalThis.__rest||function(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(t);o<a.length;o++)e.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(t,a[o])&&(r[a[o]]=t[a[o]]);return r},zt=function(e){var r=e.prefixCls,a=e.className,o=e.avatar,l=e.title,d=e.description,c=Ne(e,["prefixCls","className","avatar","title","description"]),n=p.exports.useContext(oe),g=n.getPrefixCls,f=g("list",r),m=le(f+"-item-meta",a),v=x("div",{className:f+"-item-meta-content",children:[l&&s("h4",{className:f+"-item-meta-title",children:l}),d&&s("div",{className:f+"-item-meta-description",children:d})]});return x("div",{...c,className:m,children:[o&&s("div",{className:f+"-item-meta-avatar",children:o}),(l||d)&&v]})},Et=function(e,r){var a=e.prefixCls,o=e.children,l=e.actions,d=e.extra,c=e.className,n=e.colStyle,g=Ne(e,["prefixCls","children","actions","extra","className","colStyle"]),f=p.exports.useContext(ce),m=f.grid,v=f.itemLayout,u=p.exports.useContext(oe),P=u.getPrefixCls,E=function(){var w;return p.exports.Children.forEach(o,function(B){typeof B=="string"&&(w=!0)}),w&&p.exports.Children.count(o)>1},T=function(){return v==="vertical"?!!d:!E()},I=P("list",a),N=l&&l.length>0&&s("ul",{className:I+"-item-action",children:l.map(function(S,w){return x("li",{children:[S,w!==l.length-1&&s("em",{className:I+"-item-action-split"})]},I+"-item-action-"+w)})},"actions"),O=m?"div":"li",A=s(O,{...g,...m?{}:{ref:r},className:le(I+"-item",i({},I+"-item-no-flex",!T()),c),children:v==="vertical"&&d?[x("div",{className:I+"-item-main",children:[o,N]},"content"),s("div",{className:I+"-item-extra",children:d},"extra")]:[o,N,ft(d,{key:"extra"})]});return m?s(Ct,{ref:r,flex:1,style:n,children:A}):A},Le=p.exports.forwardRef(Et);Le.Meta=zt;const Nt=Le;var Lt=function(e){var r,a,o=e.listBorderedCls,l=e.componentCls,d=e.paddingLG,c=e.margin,n=e.padding,g=e.listItemPaddingSM,f=e.marginLG,m=e.borderRadiusLG;return a={},i(a,""+o,(r={border:e.lineWidth+"px "+e.lineType+" "+e.colorBorder,borderRadius:m},i(r,l+"-header,"+l+"-footer,"+l+"-item",{paddingInline:d}),i(r,l+"-pagination",{margin:c+"px "+f+"px"}),r)),i(a,""+o+l+"-sm",i({},l+"-item,"+l+"-header,"+l+"-footer",{padding:g})),i(a,""+o+l+"-lg",i({},l+"-item,"+l+"-header,"+l+"-footer",{padding:n+"px "+d+"px"})),a},Ot=function(e){var r,a,o,l,d=e.componentCls,c=e.screenSM,n=e.screenMD,g=e.marginLG,f=e.marginSM,m=e.margin;return l={},i(l,"@media screen and (max-width:"+n+")",(r={},i(r,""+d,i({},d+"-item",i({},d+"-item-action",{marginInlineStart:g}))),i(r,d+"-vertical",i({},d+"-item",i({},d+"-item-extra",{marginInlineStart:g}))),r)),i(l,"@media screen and (max-width: "+c+")",(o={},i(o,""+d,i({},d+"-item",i({flexWrap:"wrap"},d+"-action",{marginInlineStart:f}))),i(o,d+"-vertical",i({},d+"-item",(a={flexWrap:"wrap-reverse"},i(a,d+"-item-main",{minWidth:e.contentWidth}),i(a,d+"-item-extra",{margin:"auto auto "+m+"px"}),a))),o)),l},At=function(e){var r,a,o,l,d,c,n=e.componentCls,g=e.antCls,f=e.controlHeight,m=e.minHeight,v=e.paddingSM,u=e.marginLG,P=e.padding,E=e.listItemPadding,T=e.colorPrimary,I=e.listItemPaddingSM,N=e.listItemPaddingLG,O=e.paddingXS,A=e.margin,S=e.colorText,w=e.colorTextDescription,B=e.motionDurationSlow,U=e.lineWidth;return c={},i(c,""+n,D(D({},vt(e)),(l={position:"relative","*":{outline:"none"}},i(l,n+"-header, "+n+"-footer",{background:"transparent",paddingBlock:v}),i(l,n+"-pagination",i({marginBlockStart:u,textAlign:"end"},g+"-pagination-options",{textAlign:"start"})),i(l,n+"-spin",{minHeight:m,textAlign:"center"}),i(l,n+"-items",{margin:0,padding:0,listStyle:"none"}),i(l,n+"-item",(o={display:"flex",alignItems:"center",justifyContent:"space-between",padding:E,color:S},i(o,n+"-item-meta",(r={display:"flex",flex:1,alignItems:"flex-start",maxWidth:"100%"},i(r,n+"-item-meta-avatar",{marginInlineEnd:P}),i(r,n+"-item-meta-content",{flex:"1 0",width:0,color:S}),i(r,n+"-item-meta-title",{marginBottom:e.marginXXS,color:S,fontSize:e.fontSize,lineHeight:e.lineHeight,"> a":i({color:S,transition:"all "+B},"&:hover",{color:T})}),i(r,n+"-item-meta-description",{color:w,fontSize:e.fontSize,lineHeight:e.lineHeight}),r)),i(o,n+"-item-action",(a={flex:"0 0 auto",marginInlineStart:e.marginXXL,padding:0,fontSize:0,listStyle:"none"},i(a,"& > li",i({position:"relative",display:"inline-block",padding:"0 "+O+"px",color:w,fontSize:e.fontSize,lineHeight:e.lineHeight,textAlign:"center"},"&:first-child",{paddingInlineStart:0})),i(a,n+"-item-action-split",{position:"absolute",insetBlockStart:"50%",insetInlineEnd:0,width:U,height:Math.ceil(e.fontSize*e.lineHeight)-e.marginXXS*2,transform:"translateY(-50%)",backgroundColor:e.colorSplit}),a)),o)),i(l,n+"-empty",{padding:P+"px 0",color:w,fontSize:e.fontSizeSM,textAlign:"center"}),i(l,n+"-empty-text",{padding:P,color:e.colorTextDisabled,fontSize:e.fontSize,textAlign:"center"}),i(l,n+"-item-no-flex",{display:"block"}),l))),i(c,n+"-grid "+g+"-col > "+n+"-item",{display:"block",maxWidth:"100%",marginBlockEnd:A,paddingBlock:0,borderBlockEnd:"none"}),i(c,n+"-vertical "+n+"-item",(d={alignItems:"initial"},i(d,n+"-item-main",{display:"block",flex:1}),i(d,n+"-item-extra",{marginInlineStart:u}),i(d,n+"-item-meta",i({marginBlockEnd:P},n+"-item-meta-title",{marginBlockEnd:v,color:S,fontSize:e.fontSizeLG,lineHeight:e.lineHeightLG})),i(d,n+"-item-action",{marginBlockStart:P,marginInlineStart:"auto","> li":i({padding:"0 "+P+"px"},"&:first-child",{paddingInlineStart:0})}),d)),i(c,n+"-split "+n+"-item",i({borderBlockEnd:e.lineWidth+"px "+e.lineType+" "+e.colorSplit},"&:last-child",{borderBlockEnd:"none"})),i(c,n+"-split "+n+"-header",{borderBlockEnd:e.lineWidth+"px "+e.lineType+" "+e.colorSplit}),i(c,n+"-split"+n+"-empty "+n+"-footer",{borderTop:e.lineWidth+"px "+e.lineType+" "+e.colorSplit}),i(c,n+"-loading "+n+"-spin-nested-loading",{minHeight:f}),i(c,n+"-split"+n+"-something-after-last-item "+g+"-spin-container > "+n+"-items > "+n+"-item:last-child",{borderBlockEnd:e.lineWidth+"px "+e.lineType+" "+e.colorSplit}),i(c,n+"-lg "+n+"-item",{padding:N}),i(c,n+"-sm "+n+"-item",{padding:I}),i(c,n+":not("+n+"-vertical)",i({},n+"-item-no-flex",i({},n+"-item-action",{float:"right"}))),c};const Bt=ht("List",function(t){var e=xt(t,{listBorderedCls:t.componentCls+"-bordered",minHeight:t.controlHeightLG,listItemPadding:t.paddingContentVertical+"px "+t.paddingContentHorizontalLG+"px",listItemPaddingSM:t.paddingContentVerticalSM+"px "+t.paddingContentHorizontal+"px",listItemPaddingLG:t.paddingContentVerticalLG+"px "+t.paddingContentHorizontalLG+"px"});return[At(e),Lt(e),Ot(e)]},{contentWidth:220});var Ht=globalThis&&globalThis.__rest||function(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(t);o<a.length;o++)e.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(t,a[o])&&(r[a[o]]=t[a[o]]);return r},ce=p.exports.createContext({});ce.Consumer;function ne(t){var e,r=t.pagination,a=r===void 0?!1:r,o=t.prefixCls,l=t.bordered,d=l===void 0?!1:l,c=t.split,n=c===void 0?!0:c,g=t.className,f=t.children,m=t.itemLayout,v=t.loadMore,u=t.grid,P=t.dataSource,E=P===void 0?[]:P,T=t.size,I=t.header,N=t.footer,O=t.loading,A=O===void 0?!1:O,S=t.rowKey,w=t.renderItem,B=t.locale,U=Ht(t,["pagination","prefixCls","bordered","split","className","children","itemLayout","loadMore","grid","dataSource","size","header","footer","loading","rowKey","renderItem","locale"]),me=a&&yt(a)==="object"?a:{},Be=p.exports.useState(me.defaultCurrent||1),pe=ee(Be,2),He=pe[0],Re=pe[1],Te=p.exports.useState(me.defaultPageSize||10),ge=ee(Te,2),_e=ge[0],je=ge[1],Y=p.exports.useContext(oe),De=Y.getPrefixCls,Fe=Y.renderEmpty,Ge=Y.direction,We={current:1,total:0},ue=function(b){return function(R,Se){Re(R),je(Se),a&&a[b]&&a[b](R,Se)}},$e=ue("onChange"),Ve=ue("onShowSizeChange"),Xe=function(b,R){return w?(typeof S=="function"?S(b):S?b[S]:b.key,s(de,{children:w(b,R)})):null},Ke=function(){return!!(v||a||N)},qe=function(b,R){return s("div",{className:b+"-empty-text",children:B&&B.emptyText||R("List")})},y=De("list",o),Je=Bt(y),fe=ee(Je,2),Ue=fe[0],Ye=fe[1],H=A;typeof H=="boolean"&&(H={spinning:H});var Z=H&&H.spinning,F="";switch(T){case"large":F="lg";break;case"small":F="sm";break}var Ze=le(y,(e={},i(e,y+"-vertical",m==="vertical"),i(e,y+"-"+F,F),i(e,y+"-split",n),i(e,y+"-bordered",d),i(e,y+"-loading",Z),i(e,y+"-grid",!!u),i(e,y+"-something-after-last-item",Ke()),i(e,y+"-rtl",Ge==="rtl"),e),g,Ye),M=D(D(D({},We),{total:E.length,current:He,pageSize:_e}),a||{}),he=Math.ceil(M.total/M.pageSize);M.current>he&&(M.current=he);var xe=a?s("div",{className:y+"-pagination",children:s(at,{...M,onChange:$e,onShowSizeChange:Ve})}):null,Q=be(E);a&&E.length>(M.current-1)*M.pageSize&&(Q=be(E).splice((M.current-1)*M.pageSize,M.pageSize));var Qe=Object.keys(u||{}).some(function(h){return["xs","sm","md","lg","xl","xxl"].includes(h)}),ve=Pt(Qe),G=p.exports.useMemo(function(){for(var h=0;h<Ce.length;h+=1){var b=Ce[h];if(ve[b])return b}},[ve]),ke=p.exports.useMemo(function(){if(!!u){var h=G&&u[G]?u[G]:u.column;if(h)return{width:100/h+"%",maxWidth:100/h+"%"}}},[u==null?void 0:u.column,G]),k=Z&&s("div",{style:{minHeight:53}});if(Q.length>0){var ye=Q.map(function(h,b){return Xe(h,b)});k=u?s(It,{gutter:u.gutter,children:p.exports.Children.map(ye,function(h){return s("div",{style:ke,children:h},h==null?void 0:h.key)})}):s("ul",{className:y+"-items",children:ye})}else!f&&!Z&&(k=qe(y,Fe||nt));var W=M.position||"bottom",et=p.exports.useMemo(function(){return{grid:u,itemLayout:m}},[JSON.stringify(u),m]);return Ue(s(ce.Provider,{value:et,children:x("div",{className:Ze,...U,children:[(W==="top"||W==="both")&&xe,I&&s("div",{className:y+"-header",children:I}),x(we,{...H,children:[k,f]}),N&&s("div",{className:y+"-footer",children:N}),v||(W==="bottom"||W==="both")&&xe]})}))}ne.Item=Nt;var Rt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"};const Tt=Rt;var Oe=function(e,r){return s(Ee,{...q(q({},e),{},{ref:r,icon:Tt})})};Oe.displayName="DatabaseOutlined";const _t=p.exports.forwardRef(Oe);var jt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"};const Dt=jt;var Ae=function(e,r){return s(Ee,{...q(q({},e),{},{ref:r,icon:Dt})})};Ae.displayName="MoreOutlined";const Ft=p.exports.forwardRef(Ae);var z=(t=>(t.Page="Page",t.Entity="Entity",t))(z||{});const Gt=()=>s("div",{children:"ModuleManagerEntity"}),Wt=()=>{const t=Me(J.pagesSelector);return{addPage:p.exports.useCallback(r=>{t(Pe(a=>{a.push(r)}))},[t])}},$t=()=>{const t=Me(J.pageByIdSelector);return{removePage:p.exports.useCallback(r=>{t(Pe(a=>{Reflect.deleteProperty(a,r)}))},[t])}},Vt=({searchVal:t,itemAddRef:e})=>{const{appId:r,pageId:a}=re(),o=se(),d=ze(J.pagesSelector).filter(m=>m.name.includes(t)),[c]=rt.useForm(),{addPage:n}=Wt(),{removePage:g}=$t(),f=m=>s(ne.Item,{className:te.listItem,onClick:()=>{o(K(L.PAGE,{appId:r,pageId:m.id}))},children:x("div",{className:te.listItemContent,children:[m.id===a?s(V.Link,{children:m.name}):s(V.Text,{children:m.name}),s(dt,{trigger:["hover"],menu:{onClick:({key:v})=>{switch(v){case"Delete":g(m.id);break}},items:[{label:s(V.Text,{children:"\u590D\u5236"}),key:"Copy"},{label:s(V.Text,{type:"danger",children:"\u5220\u9664"}),key:"Delete"}]},children:s(Ft,{className:`${te.moreAction} mm_p-list_item_more_action`})},m.id)]})});return x(de,{children:[e&&St.exports.createPortal(s(st,{form:c,layout:"horizontal",title:"\u521B\u5EFA\u9875\u9762",modalProps:{mask:!1},onFinish:async m=>(await c.validateFields(),console.log(m),n(ot.generateDefaultPage(m.name)),c.resetFields(),!0),trigger:s(Ie,{type:"text",shape:"circle",size:"small",children:s(wt,{})}),children:s(lt,{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9875\u9762\u540D\u79F0"}],name:"name",label:"\u9875\u9762\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u9875\u9762\u540D\u79F0"})}),e),s(ne,{dataSource:d,size:"small",rowKey:"id",renderItem:f})]})},te={listItem:C({name:"19u7x2f",styles:"margin-left:-16px;margin-right:-16px;padding-left:16px;padding-right:16px;border:none!important;cursor:default;&:hover{background-color:rgba(0, 0, 0, 0.1);.mm_p-list_item_more_action{display:block!important;}}"}),listItemContent:C({name:"14rdf5a",styles:"display:flex;justify-content:space-between;align-items:center;width:100%;a{cursor:default!important;}"}),moreAction:C({name:"eivff4",styles:"display:none"})},Xt=({visible:t,module:e,onClose:r})=>{const a=bt(e).with(z.Page,()=>"\u9875\u9762").with(z.Entity,()=>"\u6570\u636E\u6A21\u578B").otherwise(()=>"");p.exports.useEffect(()=>{l("")},[e]);const[o,l]=p.exports.useState(""),d=p.exports.useRef(null),[c,n]=p.exports.useState(!1);return p.exports.useEffect(()=>{t&&n(!0)},[t]),s("div",{className:ie.drawerWrapper,children:s(ct,{zIndex:8,title:x("div",{children:[x("div",{className:ie.drawerTitleWrapper,children:[s("span",{children:a}),s("span",{ref:d})]}),s(mt,{onChange:g=>l(g.target.value),value:o,allowClear:!0,placeholder:"\u641C\u7D22"})]}),headerStyle:{padding:"16px"},bodyStyle:{padding:"16px"},className:ie.drawer,placement:"left",width:288,maskClosable:!0,closable:!1,getContainer:!1,onClose:r,open:t,children:c&&x(de,{children:[e===z.Page&&s(Vt,{itemAddRef:d.current,searchVal:o}),e===z.Entity&&s(Gt,{itemAddRef:d.current,searchVal:o})]})})})},ie={drawerWrapper:C({name:"1i3648n",styles:"position:absolute;top:0;right:0;bottom:0;left:0"}),drawerTitleWrapper:C({name:"1rfcp9j",styles:"display:flex;justify-content:space-between;align-items:center;padding-bottom:16px"}),drawer:C({name:"a4hmbt",styles:"position:absolute"})},Kt=()=>x(j.Header,{className:ae.header,children:[s("div",{className:ae.headerLogoWrapper,children:s("img",{src:"/modou.svg",alt:""})}),x("div",{className:ae.headerRight,children:[s(Ie,{type:"link",href:"https://runtime.modou.ink",target:"_blank",children:"\u9884\u89C8"}),s(Mt,{src:"https://joeschmoe.io/api/v1/random"})]})]}),ae={header:C({name:"wqgz8v",styles:"height:48px!important;line-height:48px!important;padding:0!important;z-index:10!important;background-color:white!important;box-shadow:rgba(0, 0, 0, 0) 0 0 0 0,rgba(0, 0, 0, 0) 0 0 0 0,rgba(0, 0, 0, 0.1) 0 4px 6px -1px,rgba(0, 0, 0, 0.1) 0px 2px 4px -2px;display:flex;justify-content:space-between;align-items:center"}),headerLogoWrapper:C({name:"fbvhi9",styles:"width:60px;display:flex;align-items:center;justify-content:center;img{height:32px;}"}),headerRight:C({name:"1syo44g",styles:"padding-right:16px;display:flex;justify-content:flex-end;align-items:center"})},qt=()=>{const t=re(),e=se(),r=ze(J.appAtom),a=_.exports.isEmpty(r),o=_.exports.isEmpty(r.pages);return p.exports.useEffect(()=>{var l,d;a||(o?_.exports.isEmpty(r.entities)||e(K(L.Entity,{...t,entityId:(d=_.exports.head(r.entities))==null?void 0:d.id}),{replace:!0}):e(K(L.PAGE,{...t,pageId:(l=_.exports.head(r.pages))==null?void 0:l.id}),{replace:!0}))},[r.entities,r.pages,a,o,e,t]),s("div",{className:Jt.wrapper,children:s(we,{size:"large"})})},Jt={wrapper:C({name:"1ichkjj",styles:"height:100%;display:flex;justify-content:center;align-items:center"})},Ut=[{title:"\u9875\u9762",icon:s(pt,{}),key:z.Page},{title:"\u6570\u636E\u6A21\u578B",icon:s(_t,{}),key:z.Entity}],ai=()=>{var v;const t=re(),[e,r]=p.exports.useState(""),a=se(),{pathname:o}=tt(),l=$(L.PAGE,o),d=(v=$(L.Entity,o))!=null?v:$(L.Entities,o),c=p.exports.useCallback(()=>{r(l?z.Page:d?z.Entity:"")},[d,l]);gt(c);const[n,g]=p.exports.useState(!1),f=({key:u})=>{switch(u){case z.Page:u===e?g(P=>!P):(r(u),g(!0));break;case z.Entity:g(!1),r(u),a(K(L.Entities,{appId:t.appId}));break}};return $(L.APP,o)?s(qt,{}):x(j,{className:X.layout,children:[s(Kt,{}),x(j,{children:[s(j.Sider,{className:X.sider,theme:"light",collapsedWidth:60,width:60,collapsible:!0,collapsed:!n,children:s(ut,{className:X.menu,style:{width:"60px"},mode:"inline",selectedKeys:[e],onClick:f,items:Ut})}),x(j.Content,{className:X.layoutContent,children:[s(Xt,{onClose:()=>{g(!1),c()},module:e,visible:n}),s(it,{})]})]})]})},X={layout:C({name:"13udsys",styles:"height:100%"}),menu:C({name:"13udsys",styles:"height:100%"}),layoutContent:C({name:"bjn8wh",styles:"position:relative"}),sider:C({name:"1fa3ne3",styles:"z-index:9!important;position:relative!important;padding:0!important;font-size:16px!important;.ant-layout-sider-trigger{display:none;}.ant-menu-item{padding-left:16px!important;padding-inline:16px;border:1px solid transparent!important;&::after{display:none!important;}}.ant-menu-item-icon{font-size:16px!important;}"})};export{ai as App};
