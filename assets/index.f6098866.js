import{a as re,u as ne,R as D,b as et,m as tt,O as it}from"./main.961bd946.js";import{g as X}from"./router.9f4201c8.js";import{r as p,K as se,v as oe,a as x,j as s,x as i,Z as at,I as rt,J as nt,O as j,V as st,A as ot,B as k,s as Se,S as Ce,F as le,_ as K,n as Pe,o as Ie,aj as lt,m as b}from"./client.35724ad0.js";import{K as dt}from"./index.modern.f7f7ec74.js";import{P as ct,d as mt,p as we,F as pt,M as gt,a as ut,B as ze,b as ft,T as $,D as ht,c as xt,I as vt,l as T,C as yt,e as St}from"./AppFactoryContext.edf9c98e.js";import{M as q}from"./index.052dfeac.js";import{C as bt,O as Ct,aB as be,R as Pt,A as Me,au as It,at as wt}from"./SettingOutlined.e1c14717.js";import{L as _}from"./index.85f1f51a.js";var Ee=globalThis&&globalThis.__rest||function(t,e){var n={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(n[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,a=Object.getOwnPropertySymbols(t);l<a.length;l++)e.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(t,a[l])&&(n[a[l]]=t[a[l]]);return n},zt=function(e){var n=e.prefixCls,a=e.className,l=e.avatar,o=e.title,d=e.description,c=Ee(e,["prefixCls","className","avatar","title","description"]),r=p.exports.useContext(se),f=r.getPrefixCls,g=f("list",n),m=oe(g+"-item-meta",a),C=x("div",{className:g+"-item-meta-content",children:[o&&s("h4",{className:g+"-item-meta-title",children:o}),d&&s("div",{className:g+"-item-meta-description",children:d})]});return x("div",{...c,className:m,children:[l&&s("div",{className:g+"-item-meta-avatar",children:l}),(o||d)&&C]})},Mt=function(e,n){var a=e.prefixCls,l=e.children,o=e.actions,d=e.extra,c=e.className,r=e.colStyle,f=Ee(e,["prefixCls","children","actions","extra","className","colStyle"]),g=p.exports.useContext(de),m=g.grid,C=g.itemLayout,h=p.exports.useContext(se),w=h.getPrefixCls,E=function(){var I;return p.exports.Children.forEach(l,function(A){typeof A=="string"&&(I=!0)}),I&&p.exports.Children.count(l)>1},R=function(){return C==="vertical"?!!d:!E()},P=w("list",a),N=o&&o.length>0&&s("ul",{className:P+"-item-action",children:o.map(function(y,I){return x("li",{children:[y,I!==o.length-1&&s("em",{className:P+"-item-action-split"})]},P+"-item-action-"+I)})},"actions"),L=m?"div":"li",O=s(L,{...f,...m?{}:{ref:n},className:oe(P+"-item",i({},P+"-item-no-flex",!R()),c),children:C==="vertical"&&d?[x("div",{className:P+"-item-main",children:[l,N]},"content"),s("div",{className:P+"-item-extra",children:d},"extra")]:[l,N,at(d,{key:"extra"})]});return m?s(bt,{ref:n,flex:1,style:r,children:O}):O},Ne=p.exports.forwardRef(Mt);Ne.Meta=zt;const Et=Ne;var Nt=function(e){var n,a,l=e.listBorderedCls,o=e.componentCls,d=e.paddingLG,c=e.margin,r=e.padding,f=e.listItemPaddingSM,g=e.marginLG,m=e.borderRadiusLG;return a={},i(a,""+l,(n={border:e.lineWidth+"px "+e.lineType+" "+e.colorBorder,borderRadius:m},i(n,o+"-header,"+o+"-footer,"+o+"-item",{paddingInline:d}),i(n,o+"-pagination",{margin:c+"px "+g+"px"}),n)),i(a,""+l+o+"-sm",i({},o+"-item,"+o+"-header,"+o+"-footer",{padding:f})),i(a,""+l+o+"-lg",i({},o+"-item,"+o+"-header,"+o+"-footer",{padding:r+"px "+d+"px"})),a},Lt=function(e){var n,a,l,o,d=e.componentCls,c=e.screenSM,r=e.screenMD,f=e.marginLG,g=e.marginSM,m=e.margin;return o={},i(o,"@media screen and (max-width:"+r+")",(n={},i(n,""+d,i({},d+"-item",i({},d+"-item-action",{marginInlineStart:f}))),i(n,d+"-vertical",i({},d+"-item",i({},d+"-item-extra",{marginInlineStart:f}))),n)),i(o,"@media screen and (max-width: "+c+")",(l={},i(l,""+d,i({},d+"-item",i({flexWrap:"wrap"},d+"-action",{marginInlineStart:g}))),i(l,d+"-vertical",i({},d+"-item",(a={flexWrap:"wrap-reverse"},i(a,d+"-item-main",{minWidth:e.contentWidth}),i(a,d+"-item-extra",{margin:"auto auto "+m+"px"}),a))),l)),o},Ot=function(e){var n,a,l,o,d,c,r=e.componentCls,f=e.antCls,g=e.controlHeight,m=e.minHeight,C=e.paddingSM,h=e.marginLG,w=e.padding,E=e.listItemPadding,R=e.colorPrimary,P=e.listItemPaddingSM,N=e.listItemPaddingLG,L=e.paddingXS,O=e.margin,y=e.colorText,I=e.colorTextDescription,A=e.motionDurationSlow,J=e.lineWidth;return c={},i(c,""+r,j(j({},st(e)),(o={position:"relative","*":{outline:"none"}},i(o,r+"-header, "+r+"-footer",{background:"transparent",paddingBlock:C}),i(o,r+"-pagination",i({marginBlockStart:h,textAlign:"end"},f+"-pagination-options",{textAlign:"start"})),i(o,r+"-spin",{minHeight:m,textAlign:"center"}),i(o,r+"-items",{margin:0,padding:0,listStyle:"none"}),i(o,r+"-item",(l={display:"flex",alignItems:"center",justifyContent:"space-between",padding:E,color:y},i(l,r+"-item-meta",(n={display:"flex",flex:1,alignItems:"flex-start",maxWidth:"100%"},i(n,r+"-item-meta-avatar",{marginInlineEnd:w}),i(n,r+"-item-meta-content",{flex:"1 0",width:0,color:y}),i(n,r+"-item-meta-title",{marginBottom:e.marginXXS,color:y,fontSize:e.fontSize,lineHeight:e.lineHeight,"> a":i({color:y,transition:"all "+A},"&:hover",{color:R})}),i(n,r+"-item-meta-description",{color:I,fontSize:e.fontSize,lineHeight:e.lineHeight}),n)),i(l,r+"-item-action",(a={flex:"0 0 auto",marginInlineStart:e.marginXXL,padding:0,fontSize:0,listStyle:"none"},i(a,"& > li",i({position:"relative",display:"inline-block",padding:"0 "+L+"px",color:I,fontSize:e.fontSize,lineHeight:e.lineHeight,textAlign:"center"},"&:first-child",{paddingInlineStart:0})),i(a,r+"-item-action-split",{position:"absolute",insetBlockStart:"50%",insetInlineEnd:0,width:J,height:Math.ceil(e.fontSize*e.lineHeight)-e.marginXXS*2,transform:"translateY(-50%)",backgroundColor:e.colorSplit}),a)),l)),i(o,r+"-empty",{padding:w+"px 0",color:I,fontSize:e.fontSizeSM,textAlign:"center"}),i(o,r+"-empty-text",{padding:w,color:e.colorTextDisabled,fontSize:e.fontSize,textAlign:"center"}),i(o,r+"-item-no-flex",{display:"block"}),o))),i(c,r+"-grid "+f+"-col > "+r+"-item",{display:"block",maxWidth:"100%",marginBlockEnd:O,paddingBlock:0,borderBlockEnd:"none"}),i(c,r+"-vertical "+r+"-item",(d={alignItems:"initial"},i(d,r+"-item-main",{display:"block",flex:1}),i(d,r+"-item-extra",{marginInlineStart:h}),i(d,r+"-item-meta",i({marginBlockEnd:w},r+"-item-meta-title",{marginBlockEnd:C,color:y,fontSize:e.fontSizeLG,lineHeight:e.lineHeightLG})),i(d,r+"-item-action",{marginBlockStart:w,marginInlineStart:"auto","> li":i({padding:"0 "+w+"px"},"&:first-child",{paddingInlineStart:0})}),d)),i(c,r+"-split "+r+"-item",i({borderBlockEnd:e.lineWidth+"px "+e.lineType+" "+e.colorSplit},"&:last-child",{borderBlockEnd:"none"})),i(c,r+"-split "+r+"-header",{borderBlockEnd:e.lineWidth+"px "+e.lineType+" "+e.colorSplit}),i(c,r+"-split"+r+"-empty "+r+"-footer",{borderTop:e.lineWidth+"px "+e.lineType+" "+e.colorSplit}),i(c,r+"-loading "+r+"-spin-nested-loading",{minHeight:g}),i(c,r+"-split"+r+"-something-after-last-item "+f+"-spin-container > "+r+"-items > "+r+"-item:last-child",{borderBlockEnd:e.lineWidth+"px "+e.lineType+" "+e.colorSplit}),i(c,r+"-lg "+r+"-item",{padding:N}),i(c,r+"-sm "+r+"-item",{padding:P}),i(c,r+":not("+r+"-vertical)",i({},r+"-item-no-flex",i({},r+"-item-action",{float:"right"}))),c};const At=rt("List",function(t){var e=nt(t,{listBorderedCls:t.componentCls+"-bordered",minHeight:t.controlHeightLG,listItemPadding:t.paddingContentVertical+"px "+t.paddingContentHorizontalLG+"px",listItemPaddingSM:t.paddingContentVerticalSM+"px "+t.paddingContentHorizontal+"px",listItemPaddingLG:t.paddingContentVerticalLG+"px "+t.paddingContentHorizontalLG+"px"});return[Ot(e),Nt(e),Lt(e)]},{contentWidth:220});var Bt=globalThis&&globalThis.__rest||function(t,e){var n={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(n[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,a=Object.getOwnPropertySymbols(t);l<a.length;l++)e.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(t,a[l])&&(n[a[l]]=t[a[l]]);return n},de=p.exports.createContext({});de.Consumer;function ae(t){var e,n=t.pagination,a=n===void 0?!1:n,l=t.prefixCls,o=t.bordered,d=o===void 0?!1:o,c=t.split,r=c===void 0?!0:c,f=t.className,g=t.children,m=t.itemLayout,C=t.loadMore,h=t.grid,w=t.dataSource,E=w===void 0?[]:w,R=t.size,P=t.header,N=t.footer,L=t.loading,O=L===void 0?!1:L,y=t.rowKey,I=t.renderItem,A=t.locale,J=Bt(t,["pagination","prefixCls","bordered","split","className","children","itemLayout","loadMore","grid","dataSource","size","header","footer","loading","rowKey","renderItem","locale"]),ce=a&&ot(a)==="object"?a:{},Ae=p.exports.useState(ce.defaultCurrent||1),me=k(Ae,2),Be=me[0],He=me[1],Re=p.exports.useState(ce.defaultPageSize||10),pe=k(Re,2),Te=pe[0],_e=pe[1],U=p.exports.useContext(se),je=U.getPrefixCls,De=U.renderEmpty,Fe=U.direction,We={current:1,total:0},ge=function(S){return function(H,ye){He(H),_e(ye),a&&a[S]&&a[S](H,ye)}},Ge=ge("onChange"),$e=ge("onShowSizeChange"),Ve=function(S,H){return I?(typeof y=="function"?y(S):y?S[y]:S.key,s(le,{children:I(S,H)})):null},Xe=function(){return!!(C||a||N)},Ke=function(S,H){return s("div",{className:S+"-empty-text",children:A&&A.emptyText||H("List")})},v=je("list",l),qe=At(v),ue=k(qe,2),Je=ue[0],Ue=ue[1],B=O;typeof B=="boolean"&&(B={spinning:B});var Y=B&&B.spinning,F="";switch(R){case"large":F="lg";break;case"small":F="sm";break}var Ye=oe(v,(e={},i(e,v+"-vertical",m==="vertical"),i(e,v+"-"+F,F),i(e,v+"-split",r),i(e,v+"-bordered",d),i(e,v+"-loading",Y),i(e,v+"-grid",!!h),i(e,v+"-something-after-last-item",Xe()),i(e,v+"-rtl",Fe==="rtl"),e),f,Ue),z=j(j(j({},We),{total:E.length,current:Be,pageSize:Te}),a||{}),fe=Math.ceil(z.total/z.pageSize);z.current>fe&&(z.current=fe);var he=a?s("div",{className:v+"-pagination",children:s(ct,{...z,onChange:Ge,onShowSizeChange:$e})}):null,Z=Se(E);a&&E.length>(z.current-1)*z.pageSize&&(Z=Se(E).splice((z.current-1)*z.pageSize,z.pageSize));var Ze=Object.keys(h||{}).some(function(u){return["xs","sm","md","lg","xl","xxl"].includes(u)}),xe=Ct(Ze),W=p.exports.useMemo(function(){for(var u=0;u<be.length;u+=1){var S=be[u];if(xe[S])return S}},[xe]),Qe=p.exports.useMemo(function(){if(!!h){var u=W&&h[W]?h[W]:h.column;if(u)return{width:100/u+"%",maxWidth:100/u+"%"}}},[h==null?void 0:h.column,W]),Q=Y&&s("div",{style:{minHeight:53}});if(Z.length>0){var ve=Z.map(function(u,S){return Ve(u,S)});Q=h?s(Pt,{gutter:h.gutter,children:p.exports.Children.map(ve,function(u){return s("div",{style:Qe,children:u},u==null?void 0:u.key)})}):s("ul",{className:v+"-items",children:ve})}else!g&&!Y&&(Q=Ke(v,De||mt));var G=z.position||"bottom",ke=p.exports.useMemo(function(){return{grid:h,itemLayout:m}},[JSON.stringify(h),m]);return Je(s(de.Provider,{value:ke,children:x("div",{className:Ye,...J,children:[(G==="top"||G==="both")&&he,P&&s("div",{className:v+"-header",children:P}),x(Ce,{...B,children:[Q,g]}),N&&s("div",{className:v+"-footer",children:N}),C||(G==="bottom"||G==="both")&&he]})}))}ae.Item=Et;var Ht={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"};const Rt=Ht;var Le=function(e,n){return s(Me,{...K(K({},e),{},{ref:n,icon:Rt})})};Le.displayName="DatabaseOutlined";const Tt=p.exports.forwardRef(Le);var _t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"};const jt=_t;var Oe=function(e,n){return s(Me,{...K(K({},e),{},{ref:n,icon:jt})})};Oe.displayName="MoreOutlined";const Dt=p.exports.forwardRef(Oe);var M=(t=>(t.Page="Page",t.Entity="Entity",t))(M||{});const Ft=()=>s("div",{children:"ModuleManagerEntity"}),Wt=()=>{const t=Pe(q.pagesSelector);return{addPage:p.exports.useCallback(n=>{t(we(a=>{a.push(n)}))},[t])}},Gt=()=>{const t=Pe(q.pageByIdSelector);return{removePage:p.exports.useCallback(n=>{t(we(a=>{Reflect.deleteProperty(a,n)}))},[t])}},$t=({searchVal:t,itemAddRef:e})=>{const{appId:n,pageId:a}=re(),l=ne(),d=Ie(q.pagesSelector).filter(m=>m.name.includes(t)),[c]=pt.useForm(),{addPage:r}=Wt(),{removePage:f}=Gt(),g=m=>s(ae.Item,{className:ee.listItem,onClick:()=>{l(X(D.PAGE,{appId:n,pageId:m.id}))},children:x("div",{className:ee.listItemContent,children:[m.id===a?s($.Link,{children:m.name}):s($.Text,{children:m.name}),s(ht,{trigger:["hover"],menu:{onClick:({key:C})=>{switch(C){case"Delete":f(m.id);break}},items:[{label:s($.Text,{children:"\u590D\u5236"}),key:"Copy"},{label:s($.Text,{type:"danger",children:"\u5220\u9664"}),key:"Delete"}]},children:s(Dt,{className:`${ee.moreAction} mm_p-list_item_more_action`})},m.id)]})});return x(le,{children:[e&&lt.exports.createPortal(s(gt,{form:c,layout:"horizontal",title:"\u521B\u5EFA\u9875\u9762",modalProps:{mask:!1},onFinish:async m=>(await c.validateFields(),console.log(m),r(ut.generateDefaultPage(m.name)),c.resetFields(),!0),trigger:s(ze,{type:"text",shape:"circle",size:"small",children:s(It,{})}),children:s(ft,{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9875\u9762\u540D\u79F0"}],name:"name",label:"\u9875\u9762\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u9875\u9762\u540D\u79F0"})}),e),s(ae,{dataSource:d,size:"small",rowKey:"id",renderItem:g})]})},ee={listItem:b({name:"19u7x2f",styles:"margin-left:-16px;margin-right:-16px;padding-left:16px;padding-right:16px;border:none!important;cursor:default;&:hover{background-color:rgba(0, 0, 0, 0.1);.mm_p-list_item_more_action{display:block!important;}}"}),listItemContent:b({name:"14rdf5a",styles:"display:flex;justify-content:space-between;align-items:center;width:100%;a{cursor:default!important;}"}),moreAction:b({name:"eivff4",styles:"display:none"})},Vt=({visible:t,module:e,onClose:n})=>{const a=dt(e).with(M.Page,()=>"\u9875\u9762").with(M.Entity,()=>"\u6570\u636E\u6A21\u578B").otherwise(()=>"");p.exports.useEffect(()=>{o("")},[e]);const[l,o]=p.exports.useState(""),d=p.exports.useRef(null),[c,r]=p.exports.useState(!1);return p.exports.useEffect(()=>{t&&r(!0)},[t]),s("div",{className:te.drawerWrapper,children:s(xt,{zIndex:8,title:x("div",{children:[x("div",{className:te.drawerTitleWrapper,children:[s("span",{children:a}),s("span",{ref:d})]}),s(vt,{onChange:f=>o(f.target.value),value:l,allowClear:!0,placeholder:"\u641C\u7D22"})]}),headerStyle:{padding:"16px"},bodyStyle:{padding:"16px"},className:te.drawer,placement:"left",width:288,maskClosable:!0,closable:!1,getContainer:!1,onClose:n,open:t,children:c&&x(le,{children:[e===M.Page&&s($t,{itemAddRef:d.current,searchVal:l}),e===M.Entity&&s(Ft,{itemAddRef:d.current,searchVal:l})]})})})},te={drawerWrapper:b({name:"1i3648n",styles:"position:absolute;top:0;right:0;bottom:0;left:0"}),drawerTitleWrapper:b({name:"1rfcp9j",styles:"display:flex;justify-content:space-between;align-items:center;padding-bottom:16px"}),drawer:b({name:"a4hmbt",styles:"position:absolute"})},Xt=()=>x(_.Header,{className:ie.header,children:[s("div",{className:ie.headerLogoWrapper,children:s("img",{src:"/modou.svg",alt:""})}),x("div",{className:ie.headerRight,children:[s(ze,{type:"link",href:"https://runtime.modou.ink",target:"_blank",children:"\u9884\u89C8"}),s(wt,{src:"https://joeschmoe.io/api/v1/random"})]})]}),ie={header:b({name:"wqgz8v",styles:"height:48px!important;line-height:48px!important;padding:0!important;z-index:10!important;background-color:white!important;box-shadow:rgba(0, 0, 0, 0) 0 0 0 0,rgba(0, 0, 0, 0) 0 0 0 0,rgba(0, 0, 0, 0.1) 0 4px 6px -1px,rgba(0, 0, 0, 0.1) 0px 2px 4px -2px;display:flex;justify-content:space-between;align-items:center"}),headerLogoWrapper:b({name:"fbvhi9",styles:"width:60px;display:flex;align-items:center;justify-content:center;img{height:32px;}"}),headerRight:b({name:"1syo44g",styles:"padding-right:16px;display:flex;justify-content:flex-end;align-items:center"})},Kt=()=>{const t=re(),e=ne(),n=Ie(q.appAtom),a=T.exports.isEmpty(n),l=T.exports.isEmpty(n.pages);return p.exports.useEffect(()=>{var o,d;a||(l?T.exports.isEmpty(n.entities)||e(X(D.Entity,{...t,entityId:(d=T.exports.head(n.entities))==null?void 0:d.id}),{replace:!0}):e(X(D.PAGE,{...t,pageId:(o=T.exports.head(n.pages))==null?void 0:o.id}),{replace:!0}))},[n.entities,n.pages,a,l,e,t]),s("div",{className:qt.wrapper,children:s(Ce,{size:"large"})})},qt={wrapper:b({name:"1ichkjj",styles:"height:100%;display:flex;justify-content:center;align-items:center"})},Jt=[{title:"\u9875\u9762",icon:s(yt,{}),key:M.Page},{title:"\u6570\u636E\u6A21\u578B",icon:s(Tt,{}),key:M.Entity}],ai=()=>{const t=re(),[e,n]=p.exports.useState(""),a=ne(),{pathname:l}=et(),o=p.exports.useCallback(()=>{t.pageId?n(M.Page):t.entityId?n(M.Entity):n("")},[t]);p.exports.useEffect(()=>{o()},[o]);const[d,c]=p.exports.useState(!1),r=({key:g})=>{switch(g){case M.Page:g===e?c(m=>!m):(n(g),c(!0));break;case M.Entity:c(!1),a(X(D.Entities,{appId:t.appId}));break}};return tt(D.APP,l)?s(Kt,{}):x(_,{className:V.layout,children:[s(Xt,{}),x(_,{children:[s(_.Sider,{className:V.sider,theme:"light",collapsedWidth:60,width:60,collapsible:!0,collapsed:!d,children:s(St,{className:V.menu,style:{width:"60px"},mode:"inline",selectedKeys:[e],onClick:r,items:Jt})}),x(_.Content,{className:V.layoutContent,children:[s(Vt,{onClose:()=>{c(!1),o()},module:e,visible:d}),s(it,{})]})]})]})},V={layout:b({name:"13udsys",styles:"height:100%"}),menu:b({name:"13udsys",styles:"height:100%"}),layoutContent:b({name:"bjn8wh",styles:"position:relative"}),sider:b({name:"1fa3ne3",styles:"z-index:9!important;position:relative!important;padding:0!important;font-size:16px!important;.ant-layout-sider-trigger{display:none;}.ant-menu-item{padding-left:16px!important;padding-inline:16px;border:1px solid transparent!important;&::after{display:none!important;}}.ant-menu-item-icon{font-size:16px!important;}"})};export{ai as App};
