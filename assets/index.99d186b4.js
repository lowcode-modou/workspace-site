import{t as Ni,I as Ci,u as Mi,a as wo,R as Ai}from"./main.93d08f0f.js";import{r as E,n as vo,aI as Ti,j as v,a as L,F as re,m as ae,u as bo,b3 as Ue,o as hn,b2 as ki,aj as $i}from"./client.35724ad0.js";import{F as Je,p as _o,b as Ii,K as So,L as wt,N as Ot,T as Ne,B as Ce,l as St,O as Di,Q as Ct,R as Eo,U as zi,I as Ht,H as Fi,u as Ri,V as Bi,c as Mn,e as Pi}from"./AppFactoryContext.0477c70a.js";import{M as Ke,g as Oi}from"./router.120ec539.js";import{R as Hi,C as Cr}from"./SettingOutlined.e1c14717.js";import{C as No}from"./index.6d54bdec.js";var Li=globalThis&&globalThis.__read||function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),o,i=[],s;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return i};function Vi(e,t){e===void 0&&(e=!1);var n=Li(E.exports.useState(e),2),r=n[0],o=n[1],i=E.exports.useMemo(function(){var s=t===void 0?!e:t,a=function(){return o(function(d){return d===e?s:e})},l=function(d){return o(d)},c=function(){return o(e)},u=function(){return o(s)};return{toggle:a,set:l,setLeft:c,setRight:u}},[]);return[r,i]}var Yi=globalThis&&globalThis.__read||function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),o,i=[],s;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return i};function Ui(e){e===void 0&&(e=!1);var t=Yi(Vi(e),2),n=t[0],r=t[1],o=r.toggle,i=r.set,s=E.exports.useMemo(function(){var a=function(){return i(!0)},l=function(){return i(!1)};return{toggle:o,set:function(u){return i(!!u)},setTrue:a,setFalse:l}},[]);return[n,s]}const Co=()=>{const e=vo(Ke.entityByIdSelector),[t,{setFalse:n,setTrue:r}]=Ui(!1),[o]=Je.useForm();return{setTrue:r,setFalse:n,onSubmitEntity:s=>{e(_o(a=>{if(Reflect.has(a,s.id))a[s.id]={...a[s.id],...s};else{const l=Ii.generateDefaultEntity(s),c=Math.max(...Object.values(a).map(u=>u.position.x));a[l.id]={...l,position:{x:c+400,y:100}}}})),n()},form:o,open:t}};var Xi=function(t){return typeof t=="function"},Wi=!1;const Ki=Wi;function Zi(e){Ki&&(Xi(e)||console.error("useMemoizedFn expected parameter is a function, got "+typeof e));var t=E.exports.useRef(e);t.current=E.exports.useMemo(function(){return e},[e]);var n=E.exports.useRef();return n.current||(n.current=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t.current.apply(this,r)}),n.current}var qi=globalThis&&globalThis.__read||function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),o,i=[],s;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return i},Gi=function(){var t=qi(E.exports.useState({}),2),n=t[1];return E.exports.useCallback(function(){return n({})},[])};const ji=Gi;var jt={},Qi=e=>encodeURIComponent(e).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),Mo="%[a-f0-9]{2}",Mr=new RegExp(Mo,"gi"),Ar=new RegExp("("+Mo+")+","gi");function Hn(e,t){try{return decodeURIComponent(e.join(""))}catch{}if(e.length===1)return e;t=t||1;var n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],Hn(n),Hn(r))}function Ji(e){try{return decodeURIComponent(e)}catch{for(var t=e.match(Mr),n=1;n<t.length;n++)e=Hn(t,n).join(""),t=e.match(Mr);return e}}function ea(e){for(var t={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},n=Ar.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch{var r=Ji(n[0]);r!==n[0]&&(t[n[0]]=r)}n=Ar.exec(e)}t["%C2"]="\uFFFD";for(var o=Object.keys(t),i=0;i<o.length;i++){var s=o[i];e=e.replace(new RegExp(s,"g"),t[s])}return e}var ta=function(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch{return ea(e)}},na=(e,t)=>{if(!(typeof e=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[e];const n=e.indexOf(t);return n===-1?[e]:[e.slice(0,n),e.slice(n+t.length)]},ra=function(e,t){for(var n={},r=Object.keys(e),o=Array.isArray(t),i=0;i<r.length;i++){var s=r[i],a=e[s];(o?t.indexOf(s)!==-1:t(s,a,e))&&(n[s]=a)}return n};(function(e){const t=Qi,n=ta,r=na,o=ra,i=f=>f==null;function s(f){switch(f.arrayFormat){case"index":return x=>(w,p)=>{const _=w.length;return p===void 0||f.skipNull&&p===null||f.skipEmptyString&&p===""?w:p===null?[...w,[c(x,f),"[",_,"]"].join("")]:[...w,[c(x,f),"[",c(_,f),"]=",c(p,f)].join("")]};case"bracket":return x=>(w,p)=>p===void 0||f.skipNull&&p===null||f.skipEmptyString&&p===""?w:p===null?[...w,[c(x,f),"[]"].join("")]:[...w,[c(x,f),"[]=",c(p,f)].join("")];case"comma":case"separator":return x=>(w,p)=>p==null||p.length===0?w:w.length===0?[[c(x,f),"=",c(p,f)].join("")]:[[w,c(p,f)].join(f.arrayFormatSeparator)];default:return x=>(w,p)=>p===void 0||f.skipNull&&p===null||f.skipEmptyString&&p===""?w:p===null?[...w,c(x,f)]:[...w,[c(x,f),"=",c(p,f)].join("")]}}function a(f){let x;switch(f.arrayFormat){case"index":return(w,p,_)=>{if(x=/\[(\d*)\]$/.exec(w),w=w.replace(/\[\d*\]$/,""),!x){_[w]=p;return}_[w]===void 0&&(_[w]={}),_[w][x[1]]=p};case"bracket":return(w,p,_)=>{if(x=/(\[\])$/.exec(w),w=w.replace(/\[\]$/,""),!x){_[w]=p;return}if(_[w]===void 0){_[w]=[p];return}_[w]=[].concat(_[w],p)};case"comma":case"separator":return(w,p,_)=>{const S=typeof p=="string"&&p.includes(f.arrayFormatSeparator),M=typeof p=="string"&&!S&&u(p,f).includes(f.arrayFormatSeparator);p=M?u(p,f):p;const $=S||M?p.split(f.arrayFormatSeparator).map(D=>u(D,f)):p===null?p:u(p,f);_[w]=$};default:return(w,p,_)=>{if(_[w]===void 0){_[w]=p;return}_[w]=[].concat(_[w],p)}}}function l(f){if(typeof f!="string"||f.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function c(f,x){return x.encode?x.strict?t(f):encodeURIComponent(f):f}function u(f,x){return x.decode?n(f):f}function h(f){return Array.isArray(f)?f.sort():typeof f=="object"?h(Object.keys(f)).sort((x,w)=>Number(x)-Number(w)).map(x=>f[x]):f}function d(f){const x=f.indexOf("#");return x!==-1&&(f=f.slice(0,x)),f}function y(f){let x="";const w=f.indexOf("#");return w!==-1&&(x=f.slice(w)),x}function C(f){f=d(f);const x=f.indexOf("?");return x===-1?"":f.slice(x+1)}function g(f,x){return x.parseNumbers&&!Number.isNaN(Number(f))&&typeof f=="string"&&f.trim()!==""?f=Number(f):x.parseBooleans&&f!==null&&(f.toLowerCase()==="true"||f.toLowerCase()==="false")&&(f=f.toLowerCase()==="true"),f}function b(f,x){x=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},x),l(x.arrayFormatSeparator);const w=a(x),p=Object.create(null);if(typeof f!="string"||(f=f.trim().replace(/^[?#&]/,""),!f))return p;for(const _ of f.split("&")){if(_==="")continue;let[S,M]=r(x.decode?_.replace(/\+/g," "):_,"=");M=M===void 0?null:["comma","separator"].includes(x.arrayFormat)?M:u(M,x),w(u(S,x),M,p)}for(const _ of Object.keys(p)){const S=p[_];if(typeof S=="object"&&S!==null)for(const M of Object.keys(S))S[M]=g(S[M],x);else p[_]=g(S,x)}return x.sort===!1?p:(x.sort===!0?Object.keys(p).sort():Object.keys(p).sort(x.sort)).reduce((_,S)=>{const M=p[S];return Boolean(M)&&typeof M=="object"&&!Array.isArray(M)?_[S]=h(M):_[S]=M,_},Object.create(null))}e.extract=C,e.parse=b,e.stringify=(f,x)=>{if(!f)return"";x=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},x),l(x.arrayFormatSeparator);const w=M=>x.skipNull&&i(f[M])||x.skipEmptyString&&f[M]==="",p=s(x),_={};for(const M of Object.keys(f))w(M)||(_[M]=f[M]);const S=Object.keys(_);return x.sort!==!1&&S.sort(x.sort),S.map(M=>{const $=f[M];return $===void 0?"":$===null?c(M,x):Array.isArray($)?$.reduce(p(M),[]).join("&"):c(M,x)+"="+c($,x)}).filter(M=>M.length>0).join("&")},e.parseUrl=(f,x)=>{x=Object.assign({decode:!0},x);const[w,p]=r(f,"#");return Object.assign({url:w.split("?")[0]||"",query:b(C(f),x)},x&&x.parseFragmentIdentifier&&p?{fragmentIdentifier:u(p,x)}:{})},e.stringifyUrl=(f,x)=>{x=Object.assign({encode:!0,strict:!0},x);const w=d(f.url).split("?")[0]||"",p=e.extract(f.url),_=e.parse(p,{sort:!1}),S=Object.assign(_,f.query);let M=e.stringify(S,x);M&&(M=`?${M}`);let $=y(f.url);return f.fragmentIdentifier&&($=`#${c(f.fragmentIdentifier,x)}`),`${w}${M}${$}`},e.pick=(f,x,w)=>{w=Object.assign({parseFragmentIdentifier:!0},w);const{url:p,query:_,fragmentIdentifier:S}=e.parseUrl(f,w);return e.stringifyUrl({url:p,query:o(_,x),fragmentIdentifier:S},w)},e.exclude=(f,x,w)=>{const p=Array.isArray(x)?_=>!x.includes(_):(_,S)=>!x(_,S);return e.pick(f,p,w)}})(jt);var me=globalThis&&globalThis.__assign||function(){return me=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},me.apply(this,arguments)},ht=Ni,oa={parseNumbers:!1,parseBooleans:!1},sa={skipNull:!1,skipEmptyString:!1},Ao=function(t,n){var r,o,i=n||{},s=i.navigateMode,a=s===void 0?"push":s,l=i.parseOptions,c=i.stringifyOptions,u=me(me({},oa),l),h=me(me({},sa),c),d=ht.useLocation(),y=(r=ht.useHistory)===null||r===void 0?void 0:r.call(ht),C=(o=ht.useNavigate)===null||o===void 0?void 0:o.call(ht),g=ji(),b=E.exports.useRef(typeof t=="function"?t():t||{}),f=E.exports.useMemo(function(){return jt.parse(d.search,u)},[d.search]),x=E.exports.useMemo(function(){return me(me({},b.current),f)},[f]),w=function(_){var S=typeof _=="function"?_(x):_;g(),y&&y[a]({hash:d.hash,search:jt.stringify(me(me({},f),S),h)||"?"}),C&&C({hash:d.hash,search:jt.stringify(me(me({},f),S),h)||"?"},{replace:a==="replace"})};return[x,Zi(w)]};function ia(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(o){o(n)}),(r=e.get("*"))&&r.slice().map(function(o){o(t,n)})}}}const et=ia();function se(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=se(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}const Tr=e=>{let t;const n=new Set,r=(l,c)=>{const u=typeof l=="function"?l(t):l;if(u!==t){const h=t;t=(c!=null?c:typeof u!="object")?u:Object.assign({},t,u),n.forEach(d=>d(t,h))}},o=()=>t,a={setState:r,getState:o,subscribe:l=>(n.add(l),()=>n.delete(l)),destroy:()=>n.clear()};return t=e(r,o,a),a},aa=e=>e?Tr(e):Tr;var To={exports:{}},ko={},$o={exports:{}},Io={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var it=E.exports;function ca(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var la=typeof Object.is=="function"?Object.is:ca,ua=it.useState,fa=it.useEffect,da=it.useLayoutEffect,ha=it.useDebugValue;function pa(e,t){var n=t(),r=ua({inst:{value:n,getSnapshot:t}}),o=r[0].inst,i=r[1];return da(function(){o.value=n,o.getSnapshot=t,An(o)&&i({inst:o})},[e,n,t]),fa(function(){return An(o)&&i({inst:o}),e(function(){An(o)&&i({inst:o})})},[e]),ha(n),n}function An(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!la(e,n)}catch{return!0}}function ga(e,t){return t()}var ma=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ga:pa;Io.useSyncExternalStore=it.useSyncExternalStore!==void 0?it.useSyncExternalStore:ma;(function(e){e.exports=Io})($o);/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pn=E.exports,ya=$o.exports;function xa(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var wa=typeof Object.is=="function"?Object.is:xa,va=ya.useSyncExternalStore,ba=pn.useRef,_a=pn.useEffect,Sa=pn.useMemo,Ea=pn.useDebugValue;ko.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var i=ba(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=Sa(function(){function l(y){if(!c){if(c=!0,u=y,y=r(y),o!==void 0&&s.hasValue){var C=s.value;if(o(C,y))return h=C}return h=y}if(C=h,wa(u,y))return C;var g=r(y);return o!==void 0&&o(C,g)?C:(u=y,h=g)}var c=!1,u,h,d=n===void 0?null:n;return[function(){return l(t())},d===null?void 0:function(){return l(d())}]},[t,n,r,o]);var a=va(e,i[0],i[1]);return _a(function(){s.hasValue=!0,s.value=a},[a]),Ea(a),a};(function(e){e.exports=ko})(To);const Na=Ti(To.exports),{useSyncExternalStoreWithSelector:Ca}=Na;function Ma(e,t=e.getState,n){const r=Ca(e.subscribe,e.getState,e.getServerState||e.getState,t,n);return E.exports.useDebugValue(r),r}function le(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}var Aa={value:()=>{}};function gn(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Qt(n)}function Qt(e){this._=e}function Ta(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Qt.prototype=gn.prototype={constructor:Qt,on:function(e,t){var n=this._,r=Ta(e+"",n),o,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((o=(e=r[i]).type)&&(o=ka(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(o=(e=r[i]).type)n[o]=kr(n[o],e.name,t);else if(t==null)for(o in n)n[o]=kr(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Qt(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,i;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};function ka(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function kr(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=Aa,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Ln="http://www.w3.org/1999/xhtml";const $r={svg:"http://www.w3.org/2000/svg",xhtml:Ln,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function mn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),$r.hasOwnProperty(t)?{space:$r[t],local:e}:e}function $a(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Ln&&t.documentElement.namespaceURI===Ln?t.createElement(e):t.createElementNS(n,e)}}function Ia(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Do(e){var t=mn(e);return(t.local?Ia:$a)(t)}function Da(){}function or(e){return e==null?Da:function(){return this.querySelector(e)}}function za(e){typeof e!="function"&&(e=or(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=new Array(s),l,c,u=0;u<s;++u)(l=i[u])&&(c=e.call(l,l.__data__,u,i))&&("__data__"in l&&(c.__data__=l.__data__),a[u]=c);return new pe(r,this._parents)}function Fa(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Ra(){return[]}function zo(e){return e==null?Ra:function(){return this.querySelectorAll(e)}}function Ba(e){return function(){return Fa(e.apply(this,arguments))}}function Pa(e){typeof e=="function"?e=Ba(e):e=zo(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var s=t[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&(r.push(e.call(l,l.__data__,c,s)),o.push(l));return new pe(r,o)}function Fo(e){return function(){return this.matches(e)}}function Ro(e){return function(t){return t.matches(e)}}var Oa=Array.prototype.find;function Ha(e){return function(){return Oa.call(this.children,e)}}function La(){return this.firstElementChild}function Va(e){return this.select(e==null?La:Ha(typeof e=="function"?e:Ro(e)))}var Ya=Array.prototype.filter;function Ua(){return Array.from(this.children)}function Xa(e){return function(){return Ya.call(this.children,e)}}function Wa(e){return this.selectAll(e==null?Ua:Xa(typeof e=="function"?e:Ro(e)))}function Ka(e){typeof e!="function"&&(e=Fo(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],l,c=0;c<s;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&a.push(l);return new pe(r,this._parents)}function Bo(e){return new Array(e.length)}function Za(){return new pe(this._enter||this._groups.map(Bo),this._parents)}function nn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}nn.prototype={constructor:nn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function qa(e){return function(){return e}}function Ga(e,t,n,r,o,i){for(var s=0,a,l=t.length,c=i.length;s<c;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new nn(e,i[s]);for(;s<l;++s)(a=t[s])&&(o[s]=a)}function ja(e,t,n,r,o,i,s){var a,l,c=new Map,u=t.length,h=i.length,d=new Array(u),y;for(a=0;a<u;++a)(l=t[a])&&(d[a]=y=s.call(l,l.__data__,a,t)+"",c.has(y)?o[a]=l:c.set(y,l));for(a=0;a<h;++a)y=s.call(e,i[a],a,i)+"",(l=c.get(y))?(r[a]=l,l.__data__=i[a],c.delete(y)):n[a]=new nn(e,i[a]);for(a=0;a<u;++a)(l=t[a])&&c.get(d[a])===l&&(o[a]=l)}function Qa(e){return e.__data__}function Ja(e,t){if(!arguments.length)return Array.from(this,Qa);var n=t?ja:Ga,r=this._parents,o=this._groups;typeof e!="function"&&(e=qa(e));for(var i=o.length,s=new Array(i),a=new Array(i),l=new Array(i),c=0;c<i;++c){var u=r[c],h=o[c],d=h.length,y=ec(e.call(u,u&&u.__data__,c,r)),C=y.length,g=a[c]=new Array(C),b=s[c]=new Array(C),f=l[c]=new Array(d);n(u,h,g,b,f,y,t);for(var x=0,w=0,p,_;x<C;++x)if(p=g[x]){for(x>=w&&(w=x+1);!(_=b[w])&&++w<C;);p._next=_||null}}return s=new pe(s,r),s._enter=a,s._exit=l,s}function ec(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function tc(){return new pe(this._exit||this._groups.map(Bo),this._parents)}function nc(e,t,n){var r=this.enter(),o=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function rc(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),l=0;l<s;++l)for(var c=n[l],u=r[l],h=c.length,d=a[l]=new Array(h),y,C=0;C<h;++C)(y=c[C]||u[C])&&(d[C]=y);for(;l<o;++l)a[l]=n[l];return new pe(a,this._parents)}function oc(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function sc(e){e||(e=ic);function t(h,d){return h&&d?e(h.__data__,d.__data__):!h-!d}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s=n[i],a=s.length,l=o[i]=new Array(a),c,u=0;u<a;++u)(c=s[u])&&(l[u]=c);l.sort(t)}return new pe(o,this._parents).order()}function ic(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ac(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function cc(){return Array.from(this)}function lc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function uc(){let e=0;for(const t of this)++e;return e}function fc(){return!this.node()}function dc(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],i=0,s=o.length,a;i<s;++i)(a=o[i])&&e.call(a,a.__data__,i,o);return this}function hc(e){return function(){this.removeAttribute(e)}}function pc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function gc(e,t){return function(){this.setAttribute(e,t)}}function mc(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function yc(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function xc(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function wc(e,t){var n=mn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?pc:hc:typeof t=="function"?n.local?xc:yc:n.local?mc:gc)(n,t))}function Po(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function vc(e){return function(){this.style.removeProperty(e)}}function bc(e,t,n){return function(){this.style.setProperty(e,t,n)}}function _c(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Sc(e,t,n){return arguments.length>1?this.each((t==null?vc:typeof t=="function"?_c:bc)(e,t,n==null?"":n)):at(this.node(),e)}function at(e,t){return e.style.getPropertyValue(t)||Po(e).getComputedStyle(e,null).getPropertyValue(t)}function Ec(e){return function(){delete this[e]}}function Nc(e,t){return function(){this[e]=t}}function Cc(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Mc(e,t){return arguments.length>1?this.each((t==null?Ec:typeof t=="function"?Cc:Nc)(e,t)):this.node()[e]}function Oo(e){return e.trim().split(/^|\s+/)}function sr(e){return e.classList||new Ho(e)}function Ho(e){this._node=e,this._names=Oo(e.getAttribute("class")||"")}Ho.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Lo(e,t){for(var n=sr(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function Vo(e,t){for(var n=sr(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Ac(e){return function(){Lo(this,e)}}function Tc(e){return function(){Vo(this,e)}}function kc(e,t){return function(){(t.apply(this,arguments)?Lo:Vo)(this,e)}}function $c(e,t){var n=Oo(e+"");if(arguments.length<2){for(var r=sr(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?kc:t?Ac:Tc)(n,t))}function Ic(){this.textContent=""}function Dc(e){return function(){this.textContent=e}}function zc(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function Fc(e){return arguments.length?this.each(e==null?Ic:(typeof e=="function"?zc:Dc)(e)):this.node().textContent}function Rc(){this.innerHTML=""}function Bc(e){return function(){this.innerHTML=e}}function Pc(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function Oc(e){return arguments.length?this.each(e==null?Rc:(typeof e=="function"?Pc:Bc)(e)):this.node().innerHTML}function Hc(){this.nextSibling&&this.parentNode.appendChild(this)}function Lc(){return this.each(Hc)}function Vc(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Yc(){return this.each(Vc)}function Uc(e){var t=typeof e=="function"?e:Do(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Xc(){return null}function Wc(e,t){var n=typeof e=="function"?e:Do(e),r=t==null?Xc:typeof t=="function"?t:or(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Kc(){var e=this.parentNode;e&&e.removeChild(this)}function Zc(){return this.each(Kc)}function qc(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Gc(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function jc(e){return this.select(e?Gc:qc)}function Qc(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Jc(e){return function(t){e.call(this,t,this.__data__)}}function el(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function tl(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function nl(e,t,n){return function(){var r=this.__on,o,i=Jc(t);if(r){for(var s=0,a=r.length;s<a;++s)if((o=r[s]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function rl(e,t,n){var r=el(e+""),o,i=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,u;l<c;++l)for(o=0,u=a[l];o<i;++o)if((s=r[o]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?nl:tl,o=0;o<i;++o)this.each(a(r[o],t,n));return this}function Yo(e,t,n){var r=Po(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function ol(e,t){return function(){return Yo(this,e,t)}}function sl(e,t){return function(){return Yo(this,e,t.apply(this,arguments))}}function il(e,t){return this.each((typeof t=="function"?sl:ol)(e,t))}function*al(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var Uo=[null];function pe(e,t){this._groups=e,this._parents=t}function Dt(){return new pe([[document.documentElement]],Uo)}function cl(){return this}pe.prototype=Dt.prototype={constructor:pe,select:za,selectAll:Pa,selectChild:Va,selectChildren:Wa,filter:Ka,data:Ja,enter:Za,exit:tc,join:nc,merge:rc,selection:cl,order:oc,sort:sc,call:ac,nodes:cc,node:lc,size:uc,empty:fc,each:dc,attr:wc,style:Sc,property:Mc,classed:$c,text:Fc,html:Oc,raise:Lc,lower:Yc,append:Uc,insert:Wc,remove:Zc,clone:jc,datum:Qc,on:rl,dispatch:il,[Symbol.iterator]:al};function ye(e){return typeof e=="string"?new pe([[document.querySelector(e)]],[document.documentElement]):new pe([[e]],Uo)}function ll(e){let t;for(;t=e.sourceEvent;)e=t;return e}function be(e,t){if(e=ll(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const ul={passive:!1},Mt={capture:!0,passive:!1};function Tn(e){e.stopImmediatePropagation()}function nt(e){e.preventDefault(),e.stopImmediatePropagation()}function Xo(e){var t=e.document.documentElement,n=ye(e).on("dragstart.drag",nt,Mt);"onselectstart"in t?n.on("selectstart.drag",nt,Mt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Wo(e,t){var n=e.document.documentElement,r=ye(e).on("dragstart.drag",null);t&&(r.on("click.drag",nt,Mt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Lt=e=>()=>e;function Vn(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:s,y:a,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}Vn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function fl(e){return!e.ctrlKey&&!e.button}function dl(){return this.parentNode}function hl(e,t){return t==null?{x:e.x,y:e.y}:t}function pl(){return navigator.maxTouchPoints||"ontouchstart"in this}function gl(){var e=fl,t=dl,n=hl,r=pl,o={},i=gn("start","drag","end"),s=0,a,l,c,u,h=0;function d(p){p.on("mousedown.drag",y).filter(r).on("touchstart.drag",b).on("touchmove.drag",f,ul).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(p,_){if(!(u||!e.call(this,p,_))){var S=w(this,t.call(this,p,_),p,_,"mouse");!S||(ye(p.view).on("mousemove.drag",C,Mt).on("mouseup.drag",g,Mt),Xo(p.view),Tn(p),c=!1,a=p.clientX,l=p.clientY,S("start",p))}}function C(p){if(nt(p),!c){var _=p.clientX-a,S=p.clientY-l;c=_*_+S*S>h}o.mouse("drag",p)}function g(p){ye(p.view).on("mousemove.drag mouseup.drag",null),Wo(p.view,c),nt(p),o.mouse("end",p)}function b(p,_){if(!!e.call(this,p,_)){var S=p.changedTouches,M=t.call(this,p,_),$=S.length,D,T;for(D=0;D<$;++D)(T=w(this,M,p,_,S[D].identifier,S[D]))&&(Tn(p),T("start",p,S[D]))}}function f(p){var _=p.changedTouches,S=_.length,M,$;for(M=0;M<S;++M)($=o[_[M].identifier])&&(nt(p),$("drag",p,_[M]))}function x(p){var _=p.changedTouches,S=_.length,M,$;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),M=0;M<S;++M)($=o[_[M].identifier])&&(Tn(p),$("end",p,_[M]))}function w(p,_,S,M,$,D){var T=i.copy(),P=be(D||S,_),Y,V,m;if((m=n.call(p,new Vn("beforestart",{sourceEvent:S,target:d,identifier:$,active:s,x:P[0],y:P[1],dx:0,dy:0,dispatch:T}),M))!=null)return Y=m.x-P[0]||0,V=m.y-P[1]||0,function A(N,k,I){var F=P,z;switch(N){case"start":o[$]=A,z=s++;break;case"end":delete o[$],--s;case"drag":P=be(I||k,_),z=s;break}T.call(N,p,new Vn(N,{sourceEvent:k,subject:m,target:d,identifier:$,active:z,x:P[0]+Y,y:P[1]+V,dx:P[0]-F[0],dy:P[1]-F[1],dispatch:T}),M)}}return d.filter=function(p){return arguments.length?(e=typeof p=="function"?p:Lt(!!p),d):e},d.container=function(p){return arguments.length?(t=typeof p=="function"?p:Lt(p),d):t},d.subject=function(p){return arguments.length?(n=typeof p=="function"?p:Lt(p),d):n},d.touchable=function(p){return arguments.length?(r=typeof p=="function"?p:Lt(!!p),d):r},d.on=function(){var p=i.on.apply(i,arguments);return p===i?d:p},d.clickDistance=function(p){return arguments.length?(h=(p=+p)*p,d):Math.sqrt(h)},d}function ir(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ko(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function zt(){}var At=.7,rn=1/At,rt="\\s*([+-]?\\d+)\\s*",Tt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Me="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ml=/^#([0-9a-f]{3,8})$/,yl=new RegExp(`^rgb\\(${rt},${rt},${rt}\\)$`),xl=new RegExp(`^rgb\\(${Me},${Me},${Me}\\)$`),wl=new RegExp(`^rgba\\(${rt},${rt},${rt},${Tt}\\)$`),vl=new RegExp(`^rgba\\(${Me},${Me},${Me},${Tt}\\)$`),bl=new RegExp(`^hsl\\(${Tt},${Me},${Me}\\)$`),_l=new RegExp(`^hsla\\(${Tt},${Me},${Me},${Tt}\\)$`),Ir={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ir(zt,kt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Dr,formatHex:Dr,formatHex8:Sl,formatHsl:El,formatRgb:zr,toString:zr});function Dr(){return this.rgb().formatHex()}function Sl(){return this.rgb().formatHex8()}function El(){return Zo(this).formatHsl()}function zr(){return this.rgb().formatRgb()}function kt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ml.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Fr(t):n===3?new ce(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Vt(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Vt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=yl.exec(e))?new ce(t[1],t[2],t[3],1):(t=xl.exec(e))?new ce(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=wl.exec(e))?Vt(t[1],t[2],t[3],t[4]):(t=vl.exec(e))?Vt(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=bl.exec(e))?Pr(t[1],t[2]/100,t[3]/100,1):(t=_l.exec(e))?Pr(t[1],t[2]/100,t[3]/100,t[4]):Ir.hasOwnProperty(e)?Fr(Ir[e]):e==="transparent"?new ce(NaN,NaN,NaN,0):null}function Fr(e){return new ce(e>>16&255,e>>8&255,e&255,1)}function Vt(e,t,n,r){return r<=0&&(e=t=n=NaN),new ce(e,t,n,r)}function Nl(e){return e instanceof zt||(e=kt(e)),e?(e=e.rgb(),new ce(e.r,e.g,e.b,e.opacity)):new ce}function Yn(e,t,n,r){return arguments.length===1?Nl(e):new ce(e,t,n,r==null?1:r)}function ce(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}ir(ce,Yn,Ko(zt,{brighter(e){return e=e==null?rn:Math.pow(rn,e),new ce(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?At:Math.pow(At,e),new ce(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ce(We(this.r),We(this.g),We(this.b),on(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Rr,formatHex:Rr,formatHex8:Cl,formatRgb:Br,toString:Br}));function Rr(){return`#${Xe(this.r)}${Xe(this.g)}${Xe(this.b)}`}function Cl(){return`#${Xe(this.r)}${Xe(this.g)}${Xe(this.b)}${Xe((isNaN(this.opacity)?1:this.opacity)*255)}`}function Br(){const e=on(this.opacity);return`${e===1?"rgb(":"rgba("}${We(this.r)}, ${We(this.g)}, ${We(this.b)}${e===1?")":`, ${e})`}`}function on(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function We(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Xe(e){return e=We(e),(e<16?"0":"")+e.toString(16)}function Pr(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new _e(e,t,n,r)}function Zo(e){if(e instanceof _e)return new _e(e.h,e.s,e.l,e.opacity);if(e instanceof zt||(e=kt(e)),!e)return new _e;if(e instanceof _e)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),s=NaN,a=i-o,l=(i+o)/2;return a?(t===i?s=(n-r)/a+(n<r)*6:n===i?s=(r-t)/a+2:s=(t-n)/a+4,a/=l<.5?i+o:2-i-o,s*=60):a=l>0&&l<1?0:s,new _e(s,a,l,e.opacity)}function Ml(e,t,n,r){return arguments.length===1?Zo(e):new _e(e,t,n,r==null?1:r)}function _e(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ir(_e,Ml,Ko(zt,{brighter(e){return e=e==null?rn:Math.pow(rn,e),new _e(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?At:Math.pow(At,e),new _e(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new ce(kn(e>=240?e-240:e+120,o,r),kn(e,o,r),kn(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new _e(Or(this.h),Yt(this.s),Yt(this.l),on(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=on(this.opacity);return`${e===1?"hsl(":"hsla("}${Or(this.h)}, ${Yt(this.s)*100}%, ${Yt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Or(e){return e=(e||0)%360,e<0?e+360:e}function Yt(e){return Math.max(0,Math.min(1,e||0))}function kn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const qo=e=>()=>e;function Al(e,t){return function(n){return e+n*t}}function Tl(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function kl(e){return(e=+e)==1?Go:function(t,n){return n-t?Tl(t,n,e):qo(isNaN(t)?n:t)}}function Go(e,t){var n=t-e;return n?Al(e,n):qo(isNaN(e)?t:e)}const Hr=function e(t){var n=kl(t);function r(o,i){var s=n((o=Yn(o)).r,(i=Yn(i)).r),a=n(o.g,i.g),l=n(o.b,i.b),c=Go(o.opacity,i.opacity);return function(u){return o.r=s(u),o.g=a(u),o.b=l(u),o.opacity=c(u),o+""}}return r.gamma=e,r}(1);function ze(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Un=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$n=new RegExp(Un.source,"g");function $l(e){return function(){return e}}function Il(e){return function(t){return e(t)+""}}function Dl(e,t){var n=Un.lastIndex=$n.lastIndex=0,r,o,i,s=-1,a=[],l=[];for(e=e+"",t=t+"";(r=Un.exec(e))&&(o=$n.exec(t));)(i=o.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,l.push({i:s,x:ze(r,o)})),n=$n.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?Il(l[0].x):$l(t):(t=l.length,function(c){for(var u=0,h;u<t;++u)a[(h=l[u]).i]=h.x(c);return a.join("")})}var Lr=180/Math.PI,Xn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function jo(e,t,n,r,o,i){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*Lr,skewX:Math.atan(l)*Lr,scaleX:s,scaleY:a}}var Ut;function zl(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Xn:jo(t.a,t.b,t.c,t.d,t.e,t.f)}function Fl(e){return e==null||(Ut||(Ut=document.createElementNS("http://www.w3.org/2000/svg","g")),Ut.setAttribute("transform",e),!(e=Ut.transform.baseVal.consolidate()))?Xn:(e=e.matrix,jo(e.a,e.b,e.c,e.d,e.e,e.f))}function Qo(e,t,n,r){function o(c){return c.length?c.pop()+" ":""}function i(c,u,h,d,y,C){if(c!==h||u!==d){var g=y.push("translate(",null,t,null,n);C.push({i:g-4,x:ze(c,h)},{i:g-2,x:ze(u,d)})}else(h||d)&&y.push("translate("+h+t+d+n)}function s(c,u,h,d){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),d.push({i:h.push(o(h)+"rotate(",null,r)-2,x:ze(c,u)})):u&&h.push(o(h)+"rotate("+u+r)}function a(c,u,h,d){c!==u?d.push({i:h.push(o(h)+"skewX(",null,r)-2,x:ze(c,u)}):u&&h.push(o(h)+"skewX("+u+r)}function l(c,u,h,d,y,C){if(c!==h||u!==d){var g=y.push(o(y)+"scale(",null,",",null,")");C.push({i:g-4,x:ze(c,h)},{i:g-2,x:ze(u,d)})}else(h!==1||d!==1)&&y.push(o(y)+"scale("+h+","+d+")")}return function(c,u){var h=[],d=[];return c=e(c),u=e(u),i(c.translateX,c.translateY,u.translateX,u.translateY,h,d),s(c.rotate,u.rotate,h,d),a(c.skewX,u.skewX,h,d),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,h,d),c=u=null,function(y){for(var C=-1,g=d.length,b;++C<g;)h[(b=d[C]).i]=b.x(y);return h.join("")}}}var Rl=Qo(zl,"px, ","px)","deg)"),Bl=Qo(Fl,", ",")",")"),Pl=1e-12;function Vr(e){return((e=Math.exp(e))+1/e)/2}function Ol(e){return((e=Math.exp(e))-1/e)/2}function Hl(e){return((e=Math.exp(2*e))-1)/(e+1)}const Ll=function e(t,n,r){function o(i,s){var a=i[0],l=i[1],c=i[2],u=s[0],h=s[1],d=s[2],y=u-a,C=h-l,g=y*y+C*C,b,f;if(g<Pl)f=Math.log(d/c)/t,b=function(M){return[a+M*y,l+M*C,c*Math.exp(t*M*f)]};else{var x=Math.sqrt(g),w=(d*d-c*c+r*g)/(2*c*n*x),p=(d*d-c*c-r*g)/(2*d*n*x),_=Math.log(Math.sqrt(w*w+1)-w),S=Math.log(Math.sqrt(p*p+1)-p);f=(S-_)/t,b=function(M){var $=M*f,D=Vr(_),T=c/(n*x)*(D*Hl(t*$+_)-Ol(_));return[a+T*y,l+T*C,c*D/Vr(t*$+_)]}}return b.duration=f*1e3*t/Math.SQRT2,b}return o.rho=function(i){var s=Math.max(.001,+i),a=s*s,l=a*a;return e(s,a,l)},o}(Math.SQRT2,2,4);var ct=0,vt=0,pt=0,Jo=1e3,sn,bt,an=0,Ze=0,yn=0,$t=typeof performance=="object"&&performance.now?performance:Date,es=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ar(){return Ze||(es(Vl),Ze=$t.now()+yn)}function Vl(){Ze=0}function cn(){this._call=this._time=this._next=null}cn.prototype=ts.prototype={constructor:cn,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?ar():+n)+(t==null?0:+t),!this._next&&bt!==this&&(bt?bt._next=this:sn=this,bt=this),this._call=e,this._time=n,Wn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Wn())}};function ts(e,t,n){var r=new cn;return r.restart(e,t,n),r}function Yl(){ar(),++ct;for(var e=sn,t;e;)(t=Ze-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ct}function Yr(){Ze=(an=$t.now())+yn,ct=vt=0;try{Yl()}finally{ct=0,Xl(),Ze=0}}function Ul(){var e=$t.now(),t=e-an;t>Jo&&(yn-=t,an=e)}function Xl(){for(var e,t=sn,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:sn=n);bt=e,Wn(r)}function Wn(e){if(!ct){vt&&(vt=clearTimeout(vt));var t=e-Ze;t>24?(e<1/0&&(vt=setTimeout(Yr,e-$t.now()-yn)),pt&&(pt=clearInterval(pt))):(pt||(an=$t.now(),pt=setInterval(Ul,Jo)),ct=1,es(Yr))}}function Ur(e,t,n){var r=new cn;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var Wl=gn("start","end","cancel","interrupt"),Kl=[],ns=0,Xr=1,Kn=2,Jt=3,Wr=4,Zn=5,en=6;function xn(e,t,n,r,o,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;Zl(e,n,{name:t,index:r,group:o,on:Wl,tween:Kl,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:ns})}function cr(e,t){var n=Ee(e,t);if(n.state>ns)throw new Error("too late; already scheduled");return n}function Ae(e,t){var n=Ee(e,t);if(n.state>Jt)throw new Error("too late; already running");return n}function Ee(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Zl(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=ts(i,0,n.time);function i(c){n.state=Xr,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var u,h,d,y;if(n.state!==Xr)return l();for(u in r)if(y=r[u],y.name===n.name){if(y.state===Jt)return Ur(s);y.state===Wr?(y.state=en,y.timer.stop(),y.on.call("interrupt",e,e.__data__,y.index,y.group),delete r[u]):+u<t&&(y.state=en,y.timer.stop(),y.on.call("cancel",e,e.__data__,y.index,y.group),delete r[u])}if(Ur(function(){n.state===Jt&&(n.state=Wr,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=Kn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Kn){for(n.state=Jt,o=new Array(d=n.tween.length),u=0,h=-1;u<d;++u)(y=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(o[++h]=y);o.length=h+1}}function a(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=Zn,1),h=-1,d=o.length;++h<d;)o[h].call(e,u);n.state===Zn&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=en,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function tn(e,t){var n=e.__transition,r,o,i=!0,s;if(!!n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){i=!1;continue}o=r.state>Kn&&r.state<Zn,r.state=en,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}i&&delete e.__transition}}function ql(e){return this.each(function(){tn(this,e)})}function Gl(e,t){var n,r;return function(){var o=Ae(this,e),i=o.tween;if(i!==n){r=n=i;for(var s=0,a=r.length;s<a;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}o.tween=r}}function jl(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var i=Ae(this,e),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:t,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===t){o[l]=a;break}l===c&&o.push(a)}i.tween=o}}function Ql(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Ee(this.node(),n).tween,o=0,i=r.length,s;o<i;++o)if((s=r[o]).name===e)return s.value;return null}return this.each((t==null?Gl:jl)(n,e,t))}function lr(e,t,n){var r=e._id;return e.each(function(){var o=Ae(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return Ee(o,r).value[t]}}function rs(e,t){var n;return(typeof t=="number"?ze:t instanceof kt?Hr:(n=kt(t))?(t=n,Hr):Dl)(e,t)}function Jl(e){return function(){this.removeAttribute(e)}}function eu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function tu(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function nu(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function ru(e,t,n){var r,o,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),l=a+"",s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a)))}}function ou(e,t,n){var r,o,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),l=a+"",s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a)))}}function su(e,t){var n=mn(e),r=n==="transform"?Bl:rs;return this.attrTween(e,typeof t=="function"?(n.local?ou:ru)(n,r,lr(this,"attr."+e,t)):t==null?(n.local?eu:Jl)(n):(n.local?nu:tu)(n,r,t))}function iu(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function au(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function cu(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&au(e,i)),n}return o._value=t,o}function lu(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&iu(e,i)),n}return o._value=t,o}function uu(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=mn(e);return this.tween(n,(r.local?cu:lu)(r,t))}function fu(e,t){return function(){cr(this,e).delay=+t.apply(this,arguments)}}function du(e,t){return t=+t,function(){cr(this,e).delay=t}}function hu(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?fu:du)(t,e)):Ee(this.node(),t).delay}function pu(e,t){return function(){Ae(this,e).duration=+t.apply(this,arguments)}}function gu(e,t){return t=+t,function(){Ae(this,e).duration=t}}function mu(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?pu:gu)(t,e)):Ee(this.node(),t).duration}function yu(e,t){if(typeof t!="function")throw new Error;return function(){Ae(this,e).ease=t}}function xu(e){var t=this._id;return arguments.length?this.each(yu(t,e)):Ee(this.node(),t).ease}function wu(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ae(this,e).ease=n}}function vu(e){if(typeof e!="function")throw new Error;return this.each(wu(this._id,e))}function bu(e){typeof e!="function"&&(e=Fo(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],l,c=0;c<s;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&a.push(l);return new De(r,this._parents,this._name,this._id)}function _u(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var l=t[a],c=n[a],u=l.length,h=s[a]=new Array(u),d,y=0;y<u;++y)(d=l[y]||c[y])&&(h[y]=d);for(;a<r;++a)s[a]=t[a];return new De(s,this._parents,this._name,this._id)}function Su(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Eu(e,t,n){var r,o,i=Su(t)?cr:Ae;return function(){var s=i(this,e),a=s.on;a!==r&&(o=(r=a).copy()).on(t,n),s.on=o}}function Nu(e,t){var n=this._id;return arguments.length<2?Ee(this.node(),n).on.on(e):this.each(Eu(n,e,t))}function Cu(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Mu(){return this.on("end.remove",Cu(this._id))}function Au(e){var t=this._name,n=this._id;typeof e!="function"&&(e=or(e));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a=r[s],l=a.length,c=i[s]=new Array(l),u,h,d=0;d<l;++d)(u=a[d])&&(h=e.call(u,u.__data__,d,a))&&("__data__"in u&&(h.__data__=u.__data__),c[d]=h,xn(c[d],t,n,d,c,Ee(u,n)));return new De(i,this._parents,t,n)}function Tu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=zo(e));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var l=r[a],c=l.length,u,h=0;h<c;++h)if(u=l[h]){for(var d=e.call(u,u.__data__,h,l),y,C=Ee(u,n),g=0,b=d.length;g<b;++g)(y=d[g])&&xn(y,t,n,g,d,C);i.push(d),s.push(u)}return new De(i,s,t,n)}var ku=Dt.prototype.constructor;function $u(){return new ku(this._groups,this._parents)}function Iu(e,t){var n,r,o;return function(){var i=at(this,e),s=(this.style.removeProperty(e),at(this,e));return i===s?null:i===n&&s===r?o:o=t(n=i,r=s)}}function os(e){return function(){this.style.removeProperty(e)}}function Du(e,t,n){var r,o=n+"",i;return function(){var s=at(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}function zu(e,t,n){var r,o,i;return function(){var s=at(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),at(this,e))),s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a))}}function Fu(e,t){var n,r,o,i="style."+t,s="end."+i,a;return function(){var l=Ae(this,e),c=l.on,u=l.value[i]==null?a||(a=os(t)):void 0;(c!==n||o!==u)&&(r=(n=c).copy()).on(s,o=u),l.on=r}}function Ru(e,t,n){var r=(e+="")=="transform"?Rl:rs;return t==null?this.styleTween(e,Iu(e,r)).on("end.style."+e,os(e)):typeof t=="function"?this.styleTween(e,zu(e,r,lr(this,"style."+e,t))).each(Fu(this._id,e)):this.styleTween(e,Du(e,r,t),n).on("end.style."+e,null)}function Bu(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Pu(e,t,n){var r,o;function i(){var s=t.apply(this,arguments);return s!==o&&(r=(o=s)&&Bu(e,s,n)),r}return i._value=t,i}function Ou(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Pu(e,t,n==null?"":n))}function Hu(e){return function(){this.textContent=e}}function Lu(e){return function(){var t=e(this);this.textContent=t==null?"":t}}function Vu(e){return this.tween("text",typeof e=="function"?Lu(lr(this,"text",e)):Hu(e==null?"":e+""))}function Yu(e){return function(t){this.textContent=e.call(this,t)}}function Uu(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&Yu(o)),t}return r._value=e,r}function Xu(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Uu(e))}function Wu(){for(var e=this._name,t=this._id,n=ss(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,l,c=0;c<a;++c)if(l=s[c]){var u=Ee(l,t);xn(l,e,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new De(r,this._parents,e,n)}function Ku(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,s){var a={value:s},l={value:function(){--o===0&&i()}};n.each(function(){var c=Ae(this,r),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),c.on=t}),o===0&&i()})}var Zu=0;function De(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function ss(){return++Zu}var $e=Dt.prototype;De.prototype={constructor:De,select:Au,selectAll:Tu,selectChild:$e.selectChild,selectChildren:$e.selectChildren,filter:bu,merge:_u,selection:$u,transition:Wu,call:$e.call,nodes:$e.nodes,node:$e.node,size:$e.size,empty:$e.empty,each:$e.each,on:Nu,attr:su,attrTween:uu,style:Ru,styleTween:Ou,text:Vu,textTween:Xu,remove:Mu,tween:Ql,delay:hu,duration:mu,ease:xu,easeVarying:vu,end:Ku,[Symbol.iterator]:$e[Symbol.iterator]};function qu(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Gu={time:null,delay:0,duration:250,ease:qu};function ju(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Qu(e){var t,n;e instanceof De?(t=e._id,e=e._name):(t=ss(),(n=Gu).time=ar(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&xn(l,e,t,c,s,n||ju(l,t));return new De(r,this._parents,e,t)}Dt.prototype.interrupt=ql;Dt.prototype.transition=Qu;const Xt=e=>()=>e;function Ju(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Ie(e,t,n){this.k=e,this.x=t,this.y=n}Ie.prototype={constructor:Ie,scale:function(e){return e===1?this:new Ie(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ie(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Be=new Ie(1,0,0);Ie.prototype;function In(e){e.stopImmediatePropagation()}function gt(e){e.preventDefault(),e.stopImmediatePropagation()}function ef(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function tf(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Kr(){return this.__zoom||Be}function nf(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function rf(){return navigator.maxTouchPoints||"ontouchstart"in this}function of(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function is(){var e=ef,t=tf,n=of,r=nf,o=rf,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,l=Ll,c=gn("start","zoom","end"),u,h,d,y=500,C=150,g=0,b=10;function f(m){m.property("__zoom",Kr).on("wheel.zoom",$,{passive:!1}).on("mousedown.zoom",D).on("dblclick.zoom",T).filter(o).on("touchstart.zoom",P).on("touchmove.zoom",Y).on("touchend.zoom touchcancel.zoom",V).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}f.transform=function(m,A,N,k){var I=m.selection?m.selection():m;I.property("__zoom",Kr),m!==I?_(m,A,N,k):I.interrupt().each(function(){S(this,arguments).event(k).start().zoom(null,typeof A=="function"?A.apply(this,arguments):A).end()})},f.scaleBy=function(m,A,N,k){f.scaleTo(m,function(){var I=this.__zoom.k,F=typeof A=="function"?A.apply(this,arguments):A;return I*F},N,k)},f.scaleTo=function(m,A,N,k){f.transform(m,function(){var I=t.apply(this,arguments),F=this.__zoom,z=N==null?p(I):typeof N=="function"?N.apply(this,arguments):N,B=F.invert(z),U=typeof A=="function"?A.apply(this,arguments):A;return n(w(x(F,U),z,B),I,s)},N,k)},f.translateBy=function(m,A,N,k){f.transform(m,function(){return n(this.__zoom.translate(typeof A=="function"?A.apply(this,arguments):A,typeof N=="function"?N.apply(this,arguments):N),t.apply(this,arguments),s)},null,k)},f.translateTo=function(m,A,N,k,I){f.transform(m,function(){var F=t.apply(this,arguments),z=this.__zoom,B=k==null?p(F):typeof k=="function"?k.apply(this,arguments):k;return n(Be.translate(B[0],B[1]).scale(z.k).translate(typeof A=="function"?-A.apply(this,arguments):-A,typeof N=="function"?-N.apply(this,arguments):-N),F,s)},k,I)};function x(m,A){return A=Math.max(i[0],Math.min(i[1],A)),A===m.k?m:new Ie(A,m.x,m.y)}function w(m,A,N){var k=A[0]-N[0]*m.k,I=A[1]-N[1]*m.k;return k===m.x&&I===m.y?m:new Ie(m.k,k,I)}function p(m){return[(+m[0][0]+ +m[1][0])/2,(+m[0][1]+ +m[1][1])/2]}function _(m,A,N,k){m.on("start.zoom",function(){S(this,arguments).event(k).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(k).end()}).tween("zoom",function(){var I=this,F=arguments,z=S(I,F).event(k),B=t.apply(I,F),U=N==null?p(B):typeof N=="function"?N.apply(I,F):N,Z=Math.max(B[1][0]-B[0][0],B[1][1]-B[0][1]),X=I.__zoom,H=typeof A=="function"?A.apply(I,F):A,K=l(X.invert(U).concat(Z/X.k),H.invert(U).concat(Z/H.k));return function(q){if(q===1)q=H;else{var G=K(q),j=Z/G[2];q=new Ie(j,U[0]-G[0]*j,U[1]-G[1]*j)}z.zoom(null,q)}})}function S(m,A,N){return!N&&m.__zooming||new M(m,A)}function M(m,A){this.that=m,this.args=A,this.active=0,this.sourceEvent=null,this.extent=t.apply(m,A),this.taps=0}M.prototype={event:function(m){return m&&(this.sourceEvent=m),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(m,A){return this.mouse&&m!=="mouse"&&(this.mouse[1]=A.invert(this.mouse[0])),this.touch0&&m!=="touch"&&(this.touch0[1]=A.invert(this.touch0[0])),this.touch1&&m!=="touch"&&(this.touch1[1]=A.invert(this.touch1[0])),this.that.__zoom=A,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(m){var A=ye(this.that).datum();c.call(m,this.that,new Ju(m,{sourceEvent:this.sourceEvent,target:f,type:m,transform:this.that.__zoom,dispatch:c}),A)}};function $(m,...A){if(!e.apply(this,arguments))return;var N=S(this,A).event(m),k=this.__zoom,I=Math.max(i[0],Math.min(i[1],k.k*Math.pow(2,r.apply(this,arguments)))),F=be(m);if(N.wheel)(N.mouse[0][0]!==F[0]||N.mouse[0][1]!==F[1])&&(N.mouse[1]=k.invert(N.mouse[0]=F)),clearTimeout(N.wheel);else{if(k.k===I)return;N.mouse=[F,k.invert(F)],tn(this),N.start()}gt(m),N.wheel=setTimeout(z,C),N.zoom("mouse",n(w(x(k,I),N.mouse[0],N.mouse[1]),N.extent,s));function z(){N.wheel=null,N.end()}}function D(m,...A){if(d||!e.apply(this,arguments))return;var N=m.currentTarget,k=S(this,A,!0).event(m),I=ye(m.view).on("mousemove.zoom",U,!0).on("mouseup.zoom",Z,!0),F=be(m,N),z=m.clientX,B=m.clientY;Xo(m.view),In(m),k.mouse=[F,this.__zoom.invert(F)],tn(this),k.start();function U(X){if(gt(X),!k.moved){var H=X.clientX-z,K=X.clientY-B;k.moved=H*H+K*K>g}k.event(X).zoom("mouse",n(w(k.that.__zoom,k.mouse[0]=be(X,N),k.mouse[1]),k.extent,s))}function Z(X){I.on("mousemove.zoom mouseup.zoom",null),Wo(X.view,k.moved),gt(X),k.event(X).end()}}function T(m,...A){if(!!e.apply(this,arguments)){var N=this.__zoom,k=be(m.changedTouches?m.changedTouches[0]:m,this),I=N.invert(k),F=N.k*(m.shiftKey?.5:2),z=n(w(x(N,F),k,I),t.apply(this,A),s);gt(m),a>0?ye(this).transition().duration(a).call(_,z,k,m):ye(this).call(f.transform,z,k,m)}}function P(m,...A){if(!!e.apply(this,arguments)){var N=m.touches,k=N.length,I=S(this,A,m.changedTouches.length===k).event(m),F,z,B,U;for(In(m),z=0;z<k;++z)B=N[z],U=be(B,this),U=[U,this.__zoom.invert(U),B.identifier],I.touch0?!I.touch1&&I.touch0[2]!==U[2]&&(I.touch1=U,I.taps=0):(I.touch0=U,F=!0,I.taps=1+!!u);u&&(u=clearTimeout(u)),F&&(I.taps<2&&(h=U[0],u=setTimeout(function(){u=null},y)),tn(this),I.start())}}function Y(m,...A){if(!!this.__zooming){var N=S(this,A).event(m),k=m.changedTouches,I=k.length,F,z,B,U;for(gt(m),F=0;F<I;++F)z=k[F],B=be(z,this),N.touch0&&N.touch0[2]===z.identifier?N.touch0[0]=B:N.touch1&&N.touch1[2]===z.identifier&&(N.touch1[0]=B);if(z=N.that.__zoom,N.touch1){var Z=N.touch0[0],X=N.touch0[1],H=N.touch1[0],K=N.touch1[1],q=(q=H[0]-Z[0])*q+(q=H[1]-Z[1])*q,G=(G=K[0]-X[0])*G+(G=K[1]-X[1])*G;z=x(z,Math.sqrt(q/G)),B=[(Z[0]+H[0])/2,(Z[1]+H[1])/2],U=[(X[0]+K[0])/2,(X[1]+K[1])/2]}else if(N.touch0)B=N.touch0[0],U=N.touch0[1];else return;N.zoom("touch",n(w(z,B,U),N.extent,s))}}function V(m,...A){if(!!this.__zooming){var N=S(this,A).event(m),k=m.changedTouches,I=k.length,F,z;for(In(m),d&&clearTimeout(d),d=setTimeout(function(){d=null},y),F=0;F<I;++F)z=k[F],N.touch0&&N.touch0[2]===z.identifier?delete N.touch0:N.touch1&&N.touch1[2]===z.identifier&&delete N.touch1;if(N.touch1&&!N.touch0&&(N.touch0=N.touch1,delete N.touch1),N.touch0)N.touch0[1]=this.__zoom.invert(N.touch0[0]);else if(N.end(),N.taps===2&&(z=be(z,this),Math.hypot(h[0]-z[0],h[1]-z[1])<b)){var B=ye(this).on("dblclick.zoom");B&&B.apply(this,arguments)}}}return f.wheelDelta=function(m){return arguments.length?(r=typeof m=="function"?m:Xt(+m),f):r},f.filter=function(m){return arguments.length?(e=typeof m=="function"?m:Xt(!!m),f):e},f.touchable=function(m){return arguments.length?(o=typeof m=="function"?m:Xt(!!m),f):o},f.extent=function(m){return arguments.length?(t=typeof m=="function"?m:Xt([[+m[0][0],+m[0][1]],[+m[1][0],+m[1][1]]]),f):t},f.scaleExtent=function(m){return arguments.length?(i[0]=+m[0],i[1]=+m[1],f):[i[0],i[1]]},f.translateExtent=function(m){return arguments.length?(s[0][0]=+m[0][0],s[1][0]=+m[1][0],s[0][1]=+m[0][1],s[1][1]=+m[1][1],f):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},f.constrain=function(m){return arguments.length?(n=m,f):n},f.duration=function(m){return arguments.length?(a=+m,f):a},f.interpolate=function(m){return arguments.length?(l=m,f):l},f.on=function(){var m=c.on.apply(c,arguments);return m===c?f:m},f.clickDistance=function(m){return arguments.length?(g=(m=+m)*m,f):Math.sqrt(g)},f.tapDistance=function(m){return arguments.length?(b=+m,f):b},f}const ur=E.exports.createContext(null),sf=ur.Provider,as="[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#100";function J(e,t){const n=E.exports.useContext(ur);if(n===null)throw new Error(as);return Ma(n,e,t)}const te=()=>{const e=E.exports.useContext(ur);if(e===null)throw new Error(as);return E.exports.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},af=e=>e.userSelectionActive?"none":"all";function fr({position:e,children:t,className:n,style:r,...o}){const i=J(af),s=`${e}`.split("-");return v("div",{className:se(["react-flow__panel",n,...s]),style:{...r,pointerEvents:i},...o,children:t})}function cf({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:v(fr,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:v("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const lf=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:o=!0,labelBgStyle:i={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...u})=>{const h=E.exports.useRef(null),[d,y]=E.exports.useState({x:0,y:0,width:0,height:0}),C=se(["react-flow__edge-textwrapper",c]);return E.exports.useEffect(()=>{if(h.current){const g=h.current.getBBox();y({x:g.x,y:g.y,width:g.width,height:g.height})}},[n]),typeof n>"u"||!n?null:L("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:C,visibility:d.width?"visible":"hidden",...u,children:[o&&v("rect",{width:d.width+2*s[0],x:-s[0],y:-s[1],height:d.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),v("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:h,style:r,children:n}),l]})};var uf=E.exports.memo(lf);const Ft=({path:e,labelX:t,labelY:n,label:r,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:l,style:c,markerEnd:u,markerStart:h,interactionWidth:d=20})=>L(re,{children:[v("path",{style:c,d:e,fill:"none",className:"react-flow__edge-path",markerEnd:u,markerStart:h}),d&&v("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:d,className:"react-flow__edge-interaction"}),r?v(uf,{x:t,y:n,label:r,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:l}):null]});Ft.displayName="BaseEdge";function mt(e,t,n){return n===void 0?n:r=>{const o=t().edges.find(i=>i.id===e);o&&n(r,{...o})}}function cs({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,s=Math.abs(r-t)/2,a=r<t?r+s:r-s;return[i,a,o,s]}function ls({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:s,targetControlY:a}){const l=e*.125+o*.375+s*.375+n*.125,c=t*.125+i*.375+a*.375+r*.125,u=Math.abs(l-e),h=Math.abs(c-t);return[l,c,u,h]}var lt;(function(e){e.Strict="strict",e.Loose="loose"})(lt||(lt={}));var ot;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(ot||(ot={}));const dr=e=>({width:e.offsetWidth,height:e.offsetHeight}),st=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),hr=(e={x:0,y:0},t)=>({x:st(e.x,t[0][0],t[1][0]),y:st(e.y,t[0][1],t[1][1])}),us=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},fs=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),ln=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),ds=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Zr=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),ff=(e,t)=>ds(fs(ln(e),ln(t))),qn=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},df=e=>!!e.width&&!!e.height&&!!e.x&&!!e.y,hs=e=>!isNaN(e)&&isFinite(e),ne=Symbol.for("internals"),ps=["Enter"," ","Escape"],hf=e=>{};var Re;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Re||(Re={}));var un;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(un||(un={}));var R;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(R||(R={}));function qr({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===R.Left||e===R.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function gs({sourceX:e,sourceY:t,sourcePosition:n=R.Bottom,targetX:r,targetY:o,targetPosition:i=R.Top}){const[s,a]=qr({pos:n,x1:e,y1:t,x2:r,y2:o}),[l,c]=qr({pos:i,x1:r,y1:o,x2:e,y2:t}),[u,h,d,y]=ls({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${e},${t} C${s},${a} ${l},${c} ${r},${o}`,u,h,d,y]}const pr=E.exports.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=R.Bottom,targetPosition:i=R.Top,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:h,style:d,markerEnd:y,markerStart:C,interactionWidth:g})=>{const[b,f,x]=gs({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:i});return v(Ft,{path:b,labelX:f,labelY:x,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:h,style:d,markerEnd:y,markerStart:C,interactionWidth:g})});pr.displayName="SimpleBezierEdge";const Gr={[R.Left]:{x:-1,y:0},[R.Right]:{x:1,y:0},[R.Top]:{x:0,y:-1},[R.Bottom]:{x:0,y:1}},pf=({source:e,sourcePosition:t=R.Bottom,target:n})=>t===R.Left||t===R.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},jr=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function gf({source:e,sourcePosition:t=R.Bottom,target:n,targetPosition:r=R.Top,center:o,offset:i}){const s=Gr[t],a=Gr[r],l={x:e.x+s.x*i,y:e.y+s.y*i},c={x:n.x+a.x*i,y:n.y+a.y*i},u=pf({source:l,sourcePosition:t,target:c}),h=u.x!==0?"x":"y",d=u[h];let y=[],C,g;const[b,f,x,w]=cs({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[h]*a[h]===-1){C=o.x||b,g=o.y||f;const _=[{x:C,y:l.y},{x:C,y:c.y}],S=[{x:l.x,y:g},{x:c.x,y:g}];s[h]===d?y=h==="x"?_:S:y=h==="x"?S:_}else{const _=[{x:l.x,y:c.y}],S=[{x:c.x,y:l.y}];if(h==="x"?y=s.x===d?S:_:y=s.y===d?_:S,t!==r){const M=h==="x"?"y":"x",$=s[h]===a[M],D=l[M]>c[M],T=l[M]<c[M];(s[h]===1&&(!$&&D||$&&T)||s[h]!==1&&(!$&&T||$&&D))&&(y=h==="x"?_:S)}C=y[0].x,g=y[0].y}return[[e,l,...y,c,n],C,g,x,w]}function mf(e,t,n,r){const o=Math.min(jr(e,t)/2,jr(t,n)/2,r),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const c=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${i+o*c},${s}Q ${i},${s} ${i},${s+o*u}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${s+o*l}Q ${i},${s} ${i+o*a},${s}`}function Gn({sourceX:e,sourceY:t,sourcePosition:n=R.Bottom,targetX:r,targetY:o,targetPosition:i=R.Top,borderRadius:s=5,centerX:a,centerY:l,offset:c=20}){const[u,h,d,y,C]=gf({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:a,y:l},offset:c});return[u.reduce((b,f,x)=>{let w="";return x>0&&x<u.length-1?w=mf(u[x-1],f,u[x+1],s):w=`${x===0?"M":"L"}${f.x} ${f.y}`,b+=w,b},""),h,d,y,C]}const wn=E.exports.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:u,sourcePosition:h=R.Bottom,targetPosition:d=R.Top,markerEnd:y,markerStart:C,pathOptions:g,interactionWidth:b})=>{const[f,x,w]=Gn({sourceX:e,sourceY:t,sourcePosition:h,targetX:n,targetY:r,targetPosition:d,borderRadius:g==null?void 0:g.borderRadius,offset:g==null?void 0:g.offset});return v(Ft,{path:f,labelX:x,labelY:w,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:u,markerEnd:y,markerStart:C,interactionWidth:b})});wn.displayName="SmoothStepEdge";const gr=E.exports.memo(e=>{var t;return v(wn,{...e,pathOptions:E.exports.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});gr.displayName="StepEdge";function yf({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,i,s,a]=cs({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,s,a]}const mr=E.exports.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:u,markerEnd:h,markerStart:d,interactionWidth:y})=>{const[C,g,b]=yf({sourceX:e,sourceY:t,targetX:n,targetY:r});return v(Ft,{path:C,labelX:g,labelY:b,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:u,markerEnd:h,markerStart:d,interactionWidth:y})});mr.displayName="StraightEdge";function Wt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Qr({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case R.Left:return[t-Wt(t-r,i),n];case R.Right:return[t+Wt(r-t,i),n];case R.Top:return[t,n-Wt(n-o,i)];case R.Bottom:return[t,n+Wt(o-n,i)]}}function ms({sourceX:e,sourceY:t,sourcePosition:n=R.Bottom,targetX:r,targetY:o,targetPosition:i=R.Top,curvature:s=.25}){const[a,l]=Qr({pos:n,x1:e,y1:t,x2:r,y2:o,c:s}),[c,u]=Qr({pos:i,x1:r,y1:o,x2:e,y2:t,c:s}),[h,d,y,C]=ls({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:u});return[`M${e},${t} C${a},${l} ${c},${u} ${r},${o}`,h,d,y,C]}const fn=E.exports.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=R.Bottom,targetPosition:i=R.Top,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:h,style:d,markerEnd:y,markerStart:C,pathOptions:g,interactionWidth:b})=>{const[f,x,w]=ms({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:i,curvature:g==null?void 0:g.curvature});return v(Ft,{path:f,labelX:x,labelY:w,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:h,style:d,markerEnd:y,markerStart:C,interactionWidth:b})});fn.displayName="BezierEdge";const yr=E.exports.createContext(null),xf=yr.Provider;yr.Consumer;function jn(e,t,n,r,o,i,s){const a=s.elementFromPoint(e.clientX,e.clientY),l=(a==null?void 0:a.classList.contains("target"))||!1,c=(a==null?void 0:a.classList.contains("source"))||!1,u={elementBelow:a,isValid:!1,connection:{source:null,target:null,sourceHandle:null,targetHandle:null},isHoveringHandle:!1};if(a&&(l||c)){u.isHoveringHandle=!0;const h=a.getAttribute("data-nodeid"),d=a.getAttribute("data-handleid"),y=n?{source:h,sourceHandle:d,target:r,targetHandle:o}:{source:r,sourceHandle:o,target:h,targetHandle:d};u.connection=y,(t===lt.Strict?n&&c||!n&&l:!0)&&(u.isValid=i(y))}return u}function Dn(e){e==null||e.classList.remove("react-flow__handle-valid"),e==null||e.classList.remove("react-flow__handle-connecting")}function ys({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:o,getState:i,setState:s,isValidConnection:a,elementEdgeUpdaterType:l,onEdgeUpdateEnd:c}){const u=e.target.closest(".react-flow"),h=us(e.target);if(!h)return;const d=h.elementFromPoint(e.clientX,e.clientY),y=d==null?void 0:d.classList.contains("target"),C=d==null?void 0:d.classList.contains("source");if(!u||!y&&!C&&!l)return;const{onConnectStart:g,connectionMode:b}=i(),f=l||(y?"target":"source"),x=u.getBoundingClientRect();let w;s({connectionPosition:{x:e.clientX-x.left,y:e.clientY-x.top},connectionNodeId:n,connectionHandleId:t,connectionHandleType:f}),g==null||g(e,{nodeId:n,handleId:t,handleType:f});function p(S){s({connectionPosition:{x:S.clientX-x.left,y:S.clientY-x.top}});const{connection:M,elementBelow:$,isValid:D,isHoveringHandle:T}=jn(S,b,o,n,t,a,h);if(!T)return Dn(w);M.source!==M.target&&$&&(Dn(w),w=$,$.classList.add("react-flow__handle-connecting"),$.classList.toggle("react-flow__handle-valid",D))}function _(S){var D,T;const{connection:M,isValid:$}=jn(S,b,o,n,t,a,h);$&&(r==null||r(M)),(T=(D=i()).onConnectEnd)==null||T.call(D,S),l&&c&&c(S),Dn(w),s({connectionNodeId:null,connectionHandleId:null,connectionHandleType:null}),h.removeEventListener("mousemove",p),h.removeEventListener("mouseup",_)}h.addEventListener("mousemove",p),h.addEventListener("mouseup",_)}const wf=e=>"id"in e&&"source"in e&&"target"in e,vf=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,Qn=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,bf=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),xs=(e,t)=>{if(!e.source||!e.target)return t;let n;return wf(e)?n={...e}:n={...e,id:vf(e)},bf(n,t)?t:t.concat(n)},_f=({x:e,y:t},[n,r,o],i,[s,a])=>{const l={x:(e-n)/o,y:(t-r)/o};return i?{x:s*Math.round(l.x/s),y:a*Math.round(l.y/a)}:l},vn=e=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const t=e.reduce((n,{positionAbsolute:r,position:o,width:i,height:s})=>fs(n,ln({x:r?r.x:o.x,y:r?r.y:o.y,width:i||0,height:s||0})),{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return ds(t)},ws=(e,t,[n,r,o]=[0,0,1],i=!1,s=!1)=>{const a={x:(t.x-n)/o,y:(t.y-r)/o,width:t.width/o,height:t.height/o},l=[];return e.forEach(c=>{const{positionAbsolute:u={x:0,y:0},width:h,height:d,selectable:y=!0}=c;if(s&&!y)return!1;const C={...u,width:h||0,height:d||0},g=qn(a,C),b=typeof h>"u"||typeof d>"u"||h===null||d===null,f=i&&g>0,x=(h||0)*(d||0);(b||f||g>=x||c.dragging)&&l.push(c)}),l},vs=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},bs=(e,t,n,r,o,i=.1)=>{const s=t/(e.width*(1+i)),a=n/(e.height*(1+i)),l=Math.min(s,a),c=st(l,r,o),u=e.x+e.width/2,h=e.y+e.height/2,d=t/2-u*c,y=n/2-h*c;return[d,y,c]},Ye=(e,t=0)=>e.transition().duration(t),Sf=()=>!0,Ef=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),_s=E.exports.forwardRef(({type:e="source",position:t=R.Top,isValidConnection:n=Sf,isConnectable:r=!0,id:o,onConnect:i,children:s,className:a,onMouseDown:l,...c},u)=>{const h=te(),d=E.exports.useContext(yr),{connectionStartHandle:y,connectOnClick:C,noPanClassName:g}=J(Ef,le),b=o||null,f=e==="target",x=_=>{const{defaultEdgeOptions:S,onConnect:M,hasDefaultEdges:$}=h.getState(),D={...S,..._};if($){const{edges:T}=h.getState();h.setState({edges:xs(D,T)})}M==null||M(D),i==null||i(D)},w=_=>{_.button===0&&ys({event:_,handleId:b,nodeId:d,onConnect:x,isTarget:f,getState:h.getState,setState:h.setState,isValidConnection:n}),l==null||l(_)},p=_=>{const{onClickConnectStart:S,onClickConnectEnd:M,connectionMode:$}=h.getState();if(!y){S==null||S(_,{nodeId:d,handleId:b,handleType:e}),h.setState({connectionStartHandle:{nodeId:d,type:e,handleId:b}});return}const D=us(_.target),{connection:T,isValid:P}=jn(_,$,y.type==="target",y.nodeId,y.handleId||null,n,D);P&&x(T),M==null||M(_),h.setState({connectionStartHandle:null})};return v("div",{"data-handleid":b,"data-nodeid":d,"data-handlepos":t,className:se(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",g,a,{source:!f,target:f,connectable:r,connecting:(y==null?void 0:y.nodeId)===d&&(y==null?void 0:y.handleId)===b&&(y==null?void 0:y.type)===e}]),onMouseDown:w,onClick:C?p:void 0,ref:u,...c,children:s})});_s.displayName="Handle";var It=E.exports.memo(_s);const Ss=({data:e,isConnectable:t,targetPosition:n=R.Top,sourcePosition:r=R.Bottom})=>L(re,{children:[v(It,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,v(It,{type:"source",position:r,isConnectable:t})]});Ss.displayName="DefaultNode";var Jn=E.exports.memo(Ss);const Es=({data:e,isConnectable:t,sourcePosition:n=R.Bottom})=>L(re,{children:[e==null?void 0:e.label,v(It,{type:"source",position:n,isConnectable:t})]});Es.displayName="InputNode";var Ns=E.exports.memo(Es);const Cs=({data:e,isConnectable:t,targetPosition:n=R.Top})=>L(re,{children:[v(It,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]});Cs.displayName="OutputNode";var Ms=E.exports.memo(Cs);const xr=()=>null;xr.displayName="GroupNode";const Nf=e=>({selectedNodes:Array.from(e.nodeInternals.values()).filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected)}),Kt=e=>e.id;function Cf(e,t){return le(e.selectedNodes.map(Kt),t.selectedNodes.map(Kt))&&le(e.selectedEdges.map(Kt),t.selectedEdges.map(Kt))}const As=E.exports.memo(({onSelectionChange:e})=>{const t=te(),{selectedNodes:n,selectedEdges:r}=J(Nf,Cf);return E.exports.useEffect(()=>{var i,s;const o={nodes:n,edges:r};e==null||e(o),(s=(i=t.getState()).onSelectionChange)==null||s.call(i,o)},[n,r,e]),null});As.displayName="SelectionListener";const Mf=e=>!!e.onSelectionChange;function Af({onSelectionChange:e}){const t=J(Mf);return e||t?v(As,{onSelectionChange:e}):null}const Tf=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function je(e,t){E.exports.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function W(e,t,n){E.exports.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const kf=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:o,onConnectStart:i,onConnectEnd:s,onClickConnectStart:a,onClickConnectEnd:l,nodesDraggable:c,nodesConnectable:u,nodesFocusable:h,edgesFocusable:d,minZoom:y,maxZoom:C,nodeExtent:g,onNodesChange:b,onEdgesChange:f,elementsSelectable:x,connectionMode:w,snapGrid:p,snapToGrid:_,translateExtent:S,connectOnClick:M,defaultEdgeOptions:$,fitView:D,fitViewOptions:T,onNodesDelete:P,onEdgesDelete:Y,onNodeDrag:V,onNodeDragStart:m,onNodeDragStop:A,onSelectionDrag:N,onSelectionDragStart:k,onSelectionDragStop:I,noPanClassName:F,nodeOrigin:z,rfId:B})=>{const{setNodes:U,setEdges:Z,setDefaultNodesAndEdges:X,setMinZoom:H,setMaxZoom:K,setTranslateExtent:q,setNodeExtent:G,reset:j}=J(Tf,le),O=te();return E.exports.useEffect(()=>{const ie=r==null?void 0:r.map(oe=>({...oe,...$}));return X(n,ie),()=>{j()}},[]),W("defaultEdgeOptions",$,O.setState),W("connectionMode",w,O.setState),W("onConnect",o,O.setState),W("onConnectStart",i,O.setState),W("onConnectEnd",s,O.setState),W("onClickConnectStart",a,O.setState),W("onClickConnectEnd",l,O.setState),W("nodesDraggable",c,O.setState),W("nodesConnectable",u,O.setState),W("nodesFocusable",h,O.setState),W("edgesFocusable",d,O.setState),W("elementsSelectable",x,O.setState),W("snapToGrid",_,O.setState),W("snapGrid",p,O.setState),W("onNodesChange",b,O.setState),W("onEdgesChange",f,O.setState),W("connectOnClick",M,O.setState),W("fitViewOnInit",D,O.setState),W("fitViewOnInitOptions",T,O.setState),W("onNodesDelete",P,O.setState),W("onEdgesDelete",Y,O.setState),W("onNodeDrag",V,O.setState),W("onNodeDragStart",m,O.setState),W("onNodeDragStop",A,O.setState),W("onSelectionDrag",N,O.setState),W("onSelectionDragStart",k,O.setState),W("onSelectionDragStop",I,O.setState),W("noPanClassName",F,O.setState),W("nodeOrigin",z,O.setState),W("rfId",B,O.setState),je(e,U),je(t,Z),je(y,H),je(C,K),je(S,q),je(g,G),null},Jr={display:"none"},$f={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Ts="react-flow__node-desc",ks="react-flow__edge-desc",If="react-flow__aria-live",Df=e=>e.ariaLiveMessage;function zf({rfId:e}){const t=J(Df);return v("div",{id:`${If}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:$f,children:t})}function Ff({rfId:e,disableKeyboardA11y:t}){return L(re,{children:[L("div",{id:`${Ts}-${e}`,style:Jr,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),v("div",{id:`${ks}-${e}`,style:Jr,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&v(zf,{rfId:e})]})}const Rf=(e,t,n)=>n===R.Left?e-t:n===R.Right?e+t:e,Bf=(e,t,n)=>n===R.Top?e-t:n===R.Bottom?e+t:e,eo="react-flow__edgeupdater",to=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:i,onMouseOut:s,type:a})=>v("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:s,className:se([eo,`${eo}-${a}`]),cx:Rf(t,r,e),cy:Bf(n,r,e),r,stroke:"transparent",fill:"transparent"});var Qe=e=>{const t=({id:n,className:r,type:o,data:i,onClick:s,onEdgeDoubleClick:a,selected:l,animated:c,label:u,labelStyle:h,labelShowBg:d,labelBgStyle:y,labelBgPadding:C,labelBgBorderRadius:g,style:b,source:f,target:x,sourceX:w,sourceY:p,targetX:_,targetY:S,sourcePosition:M,targetPosition:$,elementsSelectable:D,hidden:T,sourceHandleId:P,targetHandleId:Y,onContextMenu:V,onMouseEnter:m,onMouseMove:A,onMouseLeave:N,edgeUpdaterRadius:k,onEdgeUpdate:I,onEdgeUpdateStart:F,onEdgeUpdateEnd:z,markerEnd:B,markerStart:U,rfId:Z,ariaLabel:X,isFocusable:H,pathOptions:K,interactionWidth:q})=>{const G=E.exports.useRef(null),[j,O]=E.exports.useState(!1),[ie,oe]=E.exports.useState(!1),Q=te(),ge=E.exports.useMemo(()=>`url(#${Qn(U,Z)})`,[U,Z]),ee=E.exports.useMemo(()=>`url(#${Qn(B,Z)})`,[B,Z]);if(T)return null;const ue=he=>{const{edges:ve,addSelectedEdges:Oe}=Q.getState();if(D&&(Q.setState({nodesSelectionActive:!1}),Oe([n])),s){const He=ve.find(ke=>ke.id===n);s(he,He)}},fe=mt(n,Q.getState,a),Te=mt(n,Q.getState,V),de=mt(n,Q.getState,m),Pe=mt(n,Q.getState,A),we=mt(n,Q.getState,N),qe=(he,ve)=>{const Oe=ve?x:f,He=(ve?Y:P)||null,ke=ve?"target":"source",Pt=()=>!0,ft=ve,dt=Q.getState().edges.find(Le=>Le.id===n);oe(!0),F==null||F(he,dt,ke);const Nn=Le=>{oe(!1),z==null||z(Le,dt,ke)};ys({event:he,handleId:He,nodeId:Oe,onConnect:Le=>I==null?void 0:I(dt,Le),isTarget:ft,getState:Q.getState,setState:Q.setState,isValidConnection:Pt,elementEdgeUpdaterType:ke,onEdgeUpdateEnd:Nn})},ut=he=>qe(he,!0),Ge=he=>qe(he,!1),Rt=()=>O(!0),Bt=()=>O(!1),_n=!D&&!s,Sn=typeof I<"u",En=he=>{var ve;if(ps.includes(he.key)&&D){const{unselectNodesAndEdges:Oe,addSelectedEdges:He,edges:ke}=Q.getState();he.key==="Escape"?((ve=G.current)==null||ve.blur(),Oe({edges:[ke.find(ft=>ft.id===n)]})):He([n])}};return L("g",{className:se(["react-flow__edge",`react-flow__edge-${o}`,r,{selected:l,animated:c,inactive:_n,updating:j}]),onClick:ue,onDoubleClick:fe,onContextMenu:Te,onMouseEnter:de,onMouseMove:Pe,onMouseLeave:we,onKeyDown:H?En:void 0,tabIndex:H?0:void 0,role:H?"button":void 0,"data-testid":`rf__edge-${n}`,"aria-label":X===null?void 0:X||`Edge from ${f} to ${x}`,"aria-describedby":H?`${ks}-${Z}`:void 0,ref:G,children:[!ie&&v(e,{id:n,source:f,target:x,selected:l,animated:c,label:u,labelStyle:h,labelShowBg:d,labelBgStyle:y,labelBgPadding:C,labelBgBorderRadius:g,data:i,style:b,sourceX:w,sourceY:p,targetX:_,targetY:S,sourcePosition:M,targetPosition:$,sourceHandleId:P,targetHandleId:Y,markerStart:ge,markerEnd:ee,pathOptions:K,interactionWidth:q}),Sn&&L(re,{children:[v(to,{position:M,centerX:w,centerY:p,radius:k,onMouseDown:ut,onMouseEnter:Rt,onMouseOut:Bt,type:"source"}),v(to,{position:$,centerX:_,centerY:S,radius:k,onMouseDown:Ge,onMouseEnter:Rt,onMouseOut:Bt,type:"target"})]})]})};return t.displayName="EdgeWrapper",E.exports.memo(t)};function Pf(e){const t={default:Qe(e.default||fn),straight:Qe(e.bezier||mr),step:Qe(e.step||gr),smoothstep:Qe(e.step||wn),simplebezier:Qe(e.simplebezier||pr)},n={},r=Object.keys(e).filter(o=>!["default","bezier"].includes(o)).reduce((o,i)=>(o[i]=Qe(e[i]||fn),o),n);return{...t,...r}}function no(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,o=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,s=(n==null?void 0:n.height)||t.height;switch(e){case R.Top:return{x:r+i/2,y:o};case R.Right:return{x:r+i,y:o+s/2};case R.Bottom:return{x:r+i/2,y:o+s};case R.Left:return{x:r,y:o+s/2}}}function ro(e,t){if(!e)return null;let n=null;return e.length===1||!t?n=e[0]:t&&(n=e.find(r=>r.id===t)),typeof n>"u"?null:n}const Of=(e,t,n,r,o,i)=>{const s=no(n,e,t),a=no(i,r,o);return{sourceX:s.x,sourceY:s.y,targetX:a.x,targetY:a.y}};function Hf({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:o,targetHeight:i,width:s,height:a,transform:l}){const c={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+o),y2:Math.max(e.y+r,t.y+i)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);const u=ln({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:s/l[2],height:a/l[2]}),h=Math.max(0,Math.min(u.x2,c.x2)-Math.max(u.x,c.x)),d=Math.max(0,Math.min(u.y2,c.y2)-Math.max(u.y,c.y));return Math.ceil(h*d)>0}function oo(e){var r,o,i,s,a;const t=((r=e==null?void 0:e[ne])==null?void 0:r.handleBounds)||null,n=!e||!t||!e.width||!e.height||typeof((o=e.positionAbsolute)==null?void 0:o.x)>"u"||typeof((i=e.positionAbsolute)==null?void 0:i.y)>"u";return[{x:((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!n]}function $s(e,t){if(!e.parentNode)return!1;const n=t.get(e.parentNode);return n?n.selected?!0:$s(n,t):!1}function so(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function Lf(e,t,n){return Array.from(e.values()).filter(r=>(r.selected||r.id===n)&&(!r.parentNode||!$s(r,e))).map(r=>{var o,i,s,a;return{id:r.id,position:r.position||{x:0,y:0},positionAbsolute:r.positionAbsolute||{x:0,y:0},distance:{x:t.x-((i=(o=r.positionAbsolute)==null?void 0:o.x)!=null?i:0),y:t.y-((a=(s=r.positionAbsolute)==null?void 0:s.y)!=null?a:0)},delta:{x:0,y:0},extent:r.extent,parentNode:r.parentNode,width:r.width,height:r.height}})}function Is(e,t,n,r){var a,l,c,u,h,d,y,C;let o=e.extent||r;if(e.extent==="parent")if(e.parentNode&&e.width&&e.height){const g=n.get(e.parentNode);o=(g==null?void 0:g.positionAbsolute)&&(g==null?void 0:g.width)&&(g==null?void 0:g.height)?[[g.positionAbsolute.x,g.positionAbsolute.y],[g.positionAbsolute.x+g.width-e.width,g.positionAbsolute.y+g.height-e.height]]:o}else o=r;else if(e.extent&&e.parentNode){const g=n.get(e.parentNode),b=(l=(a=g==null?void 0:g.positionAbsolute)==null?void 0:a.x)!=null?l:0,f=(u=(c=g==null?void 0:g.positionAbsolute)==null?void 0:c.y)!=null?u:0;o=[[e.extent[0][0]+b,e.extent[0][1]+f],[e.extent[1][0]+b,e.extent[1][1]+f]]}let i={x:0,y:0};if(e.parentNode){const g=n.get(e.parentNode);i={x:(d=(h=g==null?void 0:g.positionAbsolute)==null?void 0:h.x)!=null?d:0,y:(C=(y=g==null?void 0:g.positionAbsolute)==null?void 0:y.y)!=null?C:0}}const s=o?hr(t,o):t;return{position:{x:s.x-i.x,y:s.y-i.y},positionAbsolute:s}}function zn({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(o=>({...n.get(o.id),position:o.position,positionAbsolute:o.positionAbsolute}));return[e?r.find(o=>o.id===e):r[0],r]}const io=(e,t,n,r)=>{const o=t.querySelectorAll(e);if(!o||!o.length)return null;const i=Array.from(o),s=t.getBoundingClientRect(),a={x:s.width*r[0],y:s.height*r[1]};return i.map(l=>{const c=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(c.left-s.left-a.x)/n,y:(c.top-s.top-a.y)/n,...dr(l)}})};function yt(e,t,n){return n===void 0?n:r=>{const o=t().nodeInternals.get(e);n(r,{...o})}}function er({id:e,store:t,unselect:n=!1}){const{addSelectedNodes:r,unselectNodesAndEdges:o,multiSelectionActive:i,nodeInternals:s}=t.getState(),a=s.get(e);t.setState({nodesSelectionActive:!1}),a.selected?(n||a.selected&&i)&&o({nodes:[a]}):r([e])}function Fn(e){return(t,n,r)=>e==null?void 0:e(t,r)}function Ds({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:i,selectNodesOnDrag:s}){const[a,l]=E.exports.useState(!1),c=te(),u=E.exports.useRef(),h=E.exports.useRef({x:null,y:null}),d=E.exports.useCallback(({sourceEvent:y})=>{const{transform:C,snapGrid:g,snapToGrid:b}=c.getState(),f=y.touches?y.touches[0].clientX:y.clientX,x=y.touches?y.touches[0].clientY:y.clientY,w={x:(f-C[0])/C[2],y:(x-C[1])/C[2]};return{xSnapped:b?g[0]*Math.round(w.x/g[0]):w.x,ySnapped:b?g[1]*Math.round(w.y/g[1]):w.y,...w}},[]);return E.exports.useEffect(()=>{if(e!=null&&e.current){const y=ye(e.current);if(t)y.on(".drag",null);else{const C=gl().on("start",g=>{var M;const{nodeInternals:b,multiSelectionActive:f,unselectNodesAndEdges:x,onNodeDragStart:w,onSelectionDragStart:p}=c.getState(),_=o?w:Fn(p);!s&&!f&&o&&((M=b.get(o))!=null&&M.selected||x()),o&&i&&s&&er({id:o,store:c});const S=d(g);if(h.current=S,u.current=Lf(b,S,o),_&&u.current){const[$,D]=zn({nodeId:o,dragItems:u.current,nodeInternals:b});_(g.sourceEvent,$,D)}}).on("drag",g=>{const{updateNodePositions:b,nodeInternals:f,nodeExtent:x,onNodeDrag:w,onSelectionDrag:p,snapGrid:_,snapToGrid:S}=c.getState(),M=d(g);if((h.current.x!==M.xSnapped||h.current.y!==M.ySnapped)&&u.current){h.current={x:M.xSnapped,y:M.ySnapped},u.current=u.current.map(D=>{const T={x:M.x-D.distance.x,y:M.y-D.distance.y};S&&(T.x=_[0]*Math.round(T.x/_[0]),T.y=_[1]*Math.round(T.y/_[1]));const P=Is(D,T,f,x);return D.position=P.position,D.positionAbsolute=P.positionAbsolute,D});const $=o?w:Fn(p);if(b(u.current,!0,!0),l(!0),$){const[D,T]=zn({nodeId:o,dragItems:u.current,nodeInternals:f});$(g.sourceEvent,D,T)}}}).on("end",g=>{if(l(!1),u.current){const{updateNodePositions:b,nodeInternals:f,onNodeDragStop:x,onSelectionDragStop:w}=c.getState(),p=o?x:Fn(w);if(b(u.current,!1,!1),p){const[_,S]=zn({nodeId:o,dragItems:u.current,nodeInternals:f});p(g.sourceEvent,_,S)}}}).filter(g=>{const b=g.target;return!g.button&&(!n||!so(b,`.${n}`,e))&&(!r||so(b,r,e))});return y.call(C),()=>{y.on(".drag",null)}}}},[e,t,n,r,i,c,o,s,d]),a}function zs(){const e=te();return E.exports.useCallback(n=>{const{nodeInternals:r,nodeExtent:o,updateNodePositions:i,snapToGrid:s,snapGrid:a}=e.getState(),c=Array.from(r.values()).filter(u=>u.selected).map(u=>{if(u.positionAbsolute){const h={x:u.positionAbsolute.x+n.x,y:u.positionAbsolute.y+n.y};s&&(h.x=a[0]*Math.round(h.x/a[0]),h.y=a[1]*Math.round(h.y/a[1]));const d=Is(u,h,r,o);u.position=d.position,u.positionAbsolute=d.positionAbsolute}return u});i(c,!0,!0)},[])}const Et={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var xt=e=>{const t=({id:n,type:r,data:o,xPos:i,yPos:s,xPosOrigin:a,yPosOrigin:l,selected:c,onClick:u,onMouseEnter:h,onMouseMove:d,onMouseLeave:y,onContextMenu:C,onDoubleClick:g,style:b,className:f,isDraggable:x,isSelectable:w,isConnectable:p,isFocusable:_,selectNodesOnDrag:S,sourcePosition:M,targetPosition:$,hidden:D,resizeObserver:T,dragHandle:P,zIndex:Y,isParent:V,noDragClassName:m,noPanClassName:A,initialized:N,disableKeyboardA11y:k,ariaLabel:I,rfId:F})=>{const z=te(),B=E.exports.useRef(null),U=E.exports.useRef(M),Z=E.exports.useRef($),X=E.exports.useRef(r),H=w||x||u||h||d||y,K=zs(),q=yt(n,z.getState,h),G=yt(n,z.getState,d),j=yt(n,z.getState,y),O=yt(n,z.getState,C),ie=yt(n,z.getState,g),oe=ee=>{if(w&&(!S||!x)&&er({id:n,store:z}),u){const ue=z.getState().nodeInternals.get(n);u(ee,{...ue})}},Q=ee=>{var Te;const{snapGrid:ue,snapToGrid:fe}=z.getState();if(ps.includes(ee.key)&&w){const de=ee.key==="Escape";de&&((Te=B.current)==null||Te.blur()),er({id:n,store:z,unselect:de})}else if(!k&&x&&c&&Object.prototype.hasOwnProperty.call(Et,ee.key)){z.setState({ariaLiveMessage:`Moved selected node ${ee.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~s}`});const de=fe?ue[0]:5,Pe=fe?ue[1]:5,we=ee.shiftKey?4:1;K({x:Et[ee.key].x*de*we,y:Et[ee.key].y*Pe*we})}};E.exports.useEffect(()=>{if(B.current&&!D){const ee=B.current;return T==null||T.observe(ee),()=>T==null?void 0:T.unobserve(ee)}},[D]),E.exports.useEffect(()=>{const ee=X.current!==r,ue=U.current!==M,fe=Z.current!==$;B.current&&(ee||ue||fe)&&(ee&&(X.current=r),ue&&(U.current=M),fe&&(Z.current=$),z.getState().updateNodeDimensions([{id:n,nodeElement:B.current,forceUpdate:!0}]))},[n,r,M,$]);const ge=Ds({nodeRef:B,disabled:D||!x,noDragClassName:m,handleSelector:P,nodeId:n,isSelectable:w,selectNodesOnDrag:S});return D?null:v("div",{className:se(["react-flow__node",`react-flow__node-${r}`,{[A]:x},f,{selected:c,selectable:w,parent:V,dragging:ge}]),ref:B,style:{zIndex:Y,transform:`translate(${a}px,${l}px)`,pointerEvents:H?"all":"none",visibility:N?"visible":"hidden",...b},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:q,onMouseMove:G,onMouseLeave:j,onContextMenu:O,onClick:oe,onDoubleClick:ie,onKeyDown:_?Q:void 0,tabIndex:_?0:void 0,role:_?"button":void 0,"aria-describedby":k?void 0:`${Ts}-${F}`,"aria-label":I,children:v(xf,{value:n,children:v(e,{id:n,data:o,type:r,xPos:i,yPos:s,selected:c,isConnectable:p,sourcePosition:M,targetPosition:$,dragging:ge,dragHandle:P,zIndex:Y})})})};return t.displayName="NodeWrapper",E.exports.memo(t)};function Vf(e){const t={input:xt(e.input||Ns),default:xt(e.default||Jn),output:xt(e.output||Ms),group:xt(e.group||xr)},n={},r=Object.keys(e).filter(o=>!["input","default","output","group"].includes(o)).reduce((o,i)=>(o[i]=xt(e[i]||Jn),o),n);return{...t,...r}}const Yf=({x:e,y:t,width:n,height:r,origin:o})=>!n||!r?{x:e,y:t}:o[0]<0||o[1]<0||o[0]>1||o[1]>1?{x:e,y:t}:{x:e-n*o[0],y:t-r*o[1]},Uf=typeof document<"u"?document:null;var dn=(e=null,t={target:Uf})=>{const[n,r]=E.exports.useState(!1),o=E.exports.useRef(new Set([])),[i,s]=E.exports.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.split("+")),c=l.reduce((u,h)=>u.concat(...h),[]);return[l,c]}return[[],[]]},[e]);return E.exports.useEffect(()=>{var a,l;if(e!==null){const c=d=>{if(lo(d))return!1;const y=co(d.code,s);o.current.add(d[y]),ao(i,o.current,!1)&&(d.preventDefault(),r(!0))},u=d=>{if(lo(d))return!1;const y=co(d.code,s);ao(i,o.current,!0)?(r(!1),o.current.clear()):o.current.delete(d[y])},h=()=>{o.current.clear(),r(!1)};return(a=t==null?void 0:t.target)==null||a.addEventListener("keydown",c),(l=t==null?void 0:t.target)==null||l.addEventListener("keyup",u),window.addEventListener("blur",h),()=>{var d,y;(d=t==null?void 0:t.target)==null||d.removeEventListener("keydown",c),(y=t==null?void 0:t.target)==null||y.removeEventListener("keyup",u),window.removeEventListener("blur",h)}}},[e,r]),n};function ao(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function co(e,t){return t.includes(e)?"code":"key"}function lo(e){var n;const t=((n=e.composedPath)==null?void 0:n.call(e)[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(t==null?void 0:t.nodeName)||(t==null?void 0:t.hasAttribute("contenteditable"))||!!(t!=null&&t.closest(".nokey"))}function Fs(e,t,n,r){var i,s,a,l,c,u,h,d,y,C,g,b;if(!e.parentNode)return r;const o=t.get(e.parentNode);return Fs(o,t,n,{x:((i=r.x)!=null?i:0)+((a=(s=o.position)==null?void 0:s.x)!=null?a:0),y:((l=r.y)!=null?l:0)+((u=(c=o.position)==null?void 0:c.y)!=null?u:0),z:((d=(h=o[ne])==null?void 0:h.z)!=null?d:0)>((y=r.z)!=null?y:0)?(g=(C=o[ne])==null?void 0:C.z)!=null?g:0:(b=r.z)!=null?b:0})}function Rn(e,t){const n=new Map,r={};return e.forEach(o=>{var l;const i=hs(o.zIndex)?o.zIndex:o.selected?1e3:0,s=t.get(o.id),a={width:s==null?void 0:s.width,height:s==null?void 0:s.height,...o,positionAbsolute:{x:o.position.x,y:o.position.y}};o.parentNode&&(a.parentNode=o.parentNode,r[o.parentNode]=!0),Object.defineProperty(a,ne,{enumerable:!1,value:{handleBounds:(l=s==null?void 0:s[ne])==null?void 0:l.handleBounds,z:i}}),n.set(o.id,a)}),n.forEach(o=>{var i,s;if(o.parentNode&&!n.has(o.parentNode))throw new Error(`Parent node ${o.parentNode} not found`);if(o.parentNode||r[o.id]){const{x:a,y:l,z:c}=Fs(o,n,r,{...o.position,z:(s=(i=o[ne])==null?void 0:i.z)!=null?s:0});o.positionAbsolute={x:a,y:l},o[ne].z=c,r[o.id]&&(o[ne].isParent=!0)}}),n}function Rs(e,t={}){var h,d,y;const{nodeInternals:n,width:r,height:o,minZoom:i,maxZoom:s,d3Zoom:a,d3Selection:l,fitViewOnInitDone:c,fitViewOnInit:u}=e();if((t.initial&&!c&&u||!t.initial)&&a&&l){const C=Array.from(n.values()).filter(b=>t.includeHiddenNodes?b.width&&b.height:!b.hidden),g=C.every(b=>b.width&&b.height);if(C.length>0&&g){const b=vn(C),[f,x,w]=bs(b,r,o,(h=t.minZoom)!=null?h:i,(d=t.maxZoom)!=null?d:s,(y=t.padding)!=null?y:.1),p=Be.translate(f,x).scale(w);return typeof t.duration=="number"&&t.duration>0?a.transform(Ye(l,t.duration),p):a.transform(l,p),!0}}return!1}function Xf(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[ne]:r[ne],selected:n.selected})}),new Map(t)}function Wf(e,t){return t.map(n=>{const r=e.find(o=>o.id===n.id);return r&&(n.selected=r.selected),n})}function Zt({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:o,edges:i,onNodesChange:s,onEdgesChange:a,hasDefaultNodes:l,hasDefaultEdges:c}=n();e!=null&&e.length&&(l&&r({nodeInternals:Xf(e,o)}),s==null||s(e)),t!=null&&t.length&&(c&&r({edges:Wf(t,i)}),a==null||a(t))}const Ve=()=>{},Kf={zoomIn:Ve,zoomOut:Ve,zoomTo:Ve,getZoom:()=>1,setViewport:Ve,getViewport:()=>({x:0,y:0,zoom:1}),fitView:Ve,setCenter:Ve,fitBounds:Ve,project:e=>e,viewportInitialized:!1},Zf=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),qf=()=>{const e=te(),{d3Zoom:t,d3Selection:n}=J(Zf,le);return E.exports.useMemo(()=>n&&t?{zoomIn:o=>t.scaleBy(Ye(n,o==null?void 0:o.duration),1.2),zoomOut:o=>t.scaleBy(Ye(n,o==null?void 0:o.duration),1/1.2),zoomTo:(o,i)=>t.scaleTo(Ye(n,i==null?void 0:i.duration),o),getZoom:()=>e.getState().transform[2],setViewport:(o,i)=>{var u,h,d;const[s,a,l]=e.getState().transform,c=Be.translate((u=o.x)!=null?u:s,(h=o.y)!=null?h:a).scale((d=o.zoom)!=null?d:l);t.transform(Ye(n,i==null?void 0:i.duration),c)},getViewport:()=>{const[o,i,s]=e.getState().transform;return{x:o,y:i,zoom:s}},fitView:o=>Rs(e.getState,o),setCenter:(o,i,s)=>{const{width:a,height:l,maxZoom:c}=e.getState(),u=typeof(s==null?void 0:s.zoom)<"u"?s.zoom:c,h=a/2-o*u,d=l/2-i*u,y=Be.translate(h,d).scale(u);t.transform(Ye(n,s==null?void 0:s.duration),y)},fitBounds:(o,i)=>{var C;const{width:s,height:a,minZoom:l,maxZoom:c}=e.getState(),[u,h,d]=bs(o,s,a,l,c,(C=i==null?void 0:i.padding)!=null?C:.1),y=Be.translate(u,h).scale(d);t.transform(Ye(n,i==null?void 0:i.duration),y)},project:o=>{const{transform:i,snapToGrid:s,snapGrid:a}=e.getState();return _f(o,i,s,a)},viewportInitialized:!0}:Kf,[t,n])};function bn(){const e=qf(),t=te(),n=E.exports.useCallback(()=>{const{nodeInternals:g}=t.getState();return Array.from(g.values()).map(f=>({...f}))},[]),r=E.exports.useCallback(g=>{const{nodeInternals:b}=t.getState();return b.get(g)},[]),o=E.exports.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(b=>({...b}))},[]),i=E.exports.useCallback(g=>{const{edges:b=[]}=t.getState();return b.find(f=>f.id===g)},[]),s=E.exports.useCallback(g=>{const{nodeInternals:b,setNodes:f,hasDefaultNodes:x,onNodesChange:w}=t.getState(),p=Array.from(b.values()),_=typeof g=="function"?g(p):g;if(x)f(_);else if(w){const S=_.length===0?p.map(M=>({type:"remove",id:M.id})):_.map(M=>({item:M,type:"reset"}));w(S)}},[]),a=E.exports.useCallback(g=>{const{edges:b=[],setEdges:f,hasDefaultEdges:x,onEdgesChange:w}=t.getState(),p=typeof g=="function"?g(b):g;if(x)f(p);else if(w){const _=p.length===0?b.map(S=>({type:"remove",id:S.id})):p.map(S=>({item:S,type:"reset"}));w(_)}},[]),l=E.exports.useCallback(g=>{const b=Array.isArray(g)?g:[g],{nodeInternals:f,setNodes:x,hasDefaultNodes:w,onNodesChange:p}=t.getState();if(w){const S=[...Array.from(f.values()),...b];x(S)}else if(p){const _=b.map(S=>({item:S,type:"add"}));p(_)}},[]),c=E.exports.useCallback(g=>{const b=Array.isArray(g)?g:[g],{edges:f=[],setEdges:x,hasDefaultEdges:w,onEdgesChange:p}=t.getState();if(w)x([...f,...b]);else if(p){const _=b.map(S=>({item:S,type:"add"}));p(_)}},[]),u=E.exports.useCallback(()=>{const{nodeInternals:g,edges:b=[],transform:f}=t.getState(),x=Array.from(g.values()),[w,p,_]=f;return{nodes:x.map(S=>({...S})),edges:b.map(S=>({...S})),viewport:{x:w,y:p,zoom:_}}},[]),h=E.exports.useCallback(({nodes:g,edges:b})=>{const{nodeInternals:f,edges:x,hasDefaultNodes:w,hasDefaultEdges:p,onNodesDelete:_,onEdgesDelete:S,onNodesChange:M,onEdgesChange:$}=t.getState(),D=Array.from(f.values()),T=(g||[]).map(A=>A.id),P=(b||[]).map(A=>A.id),Y=D.reduce((A,N)=>{const k=!T.includes(N.id)&&N.parentNode&&A.find(F=>F.id===N.parentNode);return(typeof N.deletable=="boolean"?N.deletable:!0)&&(T.includes(N.id)||k)&&A.push(N),A},[]),V=x.filter(A=>typeof A.deletable=="boolean"?A.deletable:!0),m=V.filter(A=>P.includes(A.id));if(Y||m){const A=vs(Y,V),N=[...m,...A],k=N.reduce((I,F)=>(I.includes(F.id)||I.push(F.id),I),[]);if((p||w)&&(p&&t.setState({edges:x.filter(I=>!k.includes(I.id))}),w&&(Y.forEach(I=>{f.delete(I.id)}),t.setState({nodeInternals:new Map(f)}))),k.length>0&&(S==null||S(N),$&&$(k.map(I=>({id:I,type:"remove"})))),Y.length>0&&(_==null||_(Y),M)){const I=Y.map(F=>({id:F.id,type:"remove"}));M(I)}}},[]),d=E.exports.useCallback(g=>{const b=df(g),f=b?null:t.getState().nodeInternals.get(g.id);return[b?g:Zr(f),f,b]},[]),y=E.exports.useCallback((g,b=!0,f)=>{const[x,w,p]=d(g);return x?(f||Array.from(t.getState().nodeInternals.values())).filter(_=>{if(!p&&(_.id===w.id||!_.positionAbsolute))return!1;const S=Zr(_),M=qn(S,x);return b&&M>0||M>=g.width*g.height}):[]},[]),C=E.exports.useCallback((g,b,f=!0)=>{const[x]=d(g);if(!x)return!1;const w=qn(x,b);return f&&w>0||w>=g.width*g.height},[]);return E.exports.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:o,getEdge:i,setNodes:s,setEdges:a,addNodes:l,addEdges:c,toObject:u,deleteElements:h,getIntersectingNodes:y,isNodeIntersecting:C}),[e,n,r,o,i,s,a,l,c,u,h,y,C])}var Gf=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=te(),{deleteElements:r}=bn(),o=dn(e),i=dn(t);E.exports.useEffect(()=>{if(o){const{nodeInternals:s,edges:a}=n.getState(),c=Array.from(s.values()).filter(h=>h.selected),u=a.filter(h=>h.selected);r({nodes:c,edges:u}),n.setState({nodesSelectionActive:!1})}},[o]),E.exports.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function jf(e){const t=te();E.exports.useEffect(()=>{let n;const r=()=>{if(!e.current)return;const o=dr(e.current);o.height===0||o.width,t.setState({width:o.width||500,height:o.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const wr={position:"absolute",width:"100%",height:"100%",top:0,left:0},Qf=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Bn=e=>({x:e.x,y:e.y,zoom:e.k}),qt=(e,t)=>e.target.closest(`.${t}`),Jf=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler}),ed=({onMove:e,onMoveStart:t,onMoveEnd:n,zoomOnScroll:r=!0,zoomOnPinch:o=!0,panOnScroll:i=!1,panOnScrollSpeed:s=.5,panOnScrollMode:a=ot.Free,zoomOnDoubleClick:l=!0,selectionKeyPressed:c,elementsSelectable:u,panOnDrag:h=!0,defaultViewport:d,translateExtent:y,minZoom:C,maxZoom:g,zoomActivationKeyCode:b,preventScrolling:f=!0,children:x,noWheelClassName:w,noPanClassName:p})=>{const _=E.exports.useRef(),S=te(),M=E.exports.useRef(!1),$=E.exports.useRef(null),D=E.exports.useRef({x:0,y:0,zoom:0}),{d3Zoom:T,d3Selection:P,d3ZoomHandler:Y}=J(Jf,le),V=dn(b);return jf($),E.exports.useEffect(()=>{if($.current){const m=is().scaleExtent([C,g]).translateExtent(y),A=ye($.current).call(m),N=st(d.x,y[0][0],y[1][0]),k=st(d.y,y[0][1],y[1][1]),I=st(d.zoom,C,g),F=Be.translate(N,k).scale(I);m.transform(A,F),S.setState({d3Zoom:m,d3Selection:A,d3ZoomHandler:A.on("wheel.zoom"),transform:[N,k,I],domNode:$.current.closest(".react-flow")})}},[]),E.exports.useEffect(()=>{P&&T&&(i&&!V?P.on("wheel.zoom",m=>{if(qt(m,w))return!1;m.preventDefault(),m.stopImmediatePropagation();const A=P.property("__zoom").k||1;if(m.ctrlKey&&o){const F=be(m),z=-m.deltaY*(m.deltaMode===1?.05:m.deltaMode?1:.002)*10,B=A*Math.pow(2,z);T.scaleTo(P,B,F);return}const N=m.deltaMode===1?20:1,k=a===ot.Vertical?0:m.deltaX*N,I=a===ot.Horizontal?0:m.deltaY*N;T.translateBy(P,-(k/A)*s,-(I/A)*s)}):typeof Y<"u"&&P.on("wheel.zoom",function(m,A){if(!f||qt(m,w))return null;m.preventDefault(),Y.call(this,m,A)}))},[i,a,P,T,Y,V,o,f,w]),E.exports.useEffect(()=>{T&&(c&&!M.current?T.on("zoom",null):c||T.on("zoom",m=>{const{onViewportChange:A}=S.getState();if(S.setState({transform:[m.transform.x,m.transform.y,m.transform.k]}),e||A){const N=Bn(m.transform);A==null||A(N),e==null||e(m.sourceEvent,N)}}))},[c,T,e]),E.exports.useEffect(()=>{T&&T.on("start",m=>{var N;if(!m.sourceEvent)return null;const{onViewportChangeStart:A}=S.getState();if(M.current=!0,((N=m.sourceEvent)==null?void 0:N.type)==="mousedown"&&S.setState({paneDragging:!0}),t||A){const k=Bn(m.transform);D.current=k,A==null||A(k),t==null||t(m.sourceEvent,k)}})},[T,t]),E.exports.useEffect(()=>{T&&T.on("end",m=>{if(!m.sourceEvent)return null;const{onViewportChangeEnd:A}=S.getState();if(M.current=!1,S.setState({paneDragging:!1}),(n||A)&&Qf(D.current,m.transform)){const N=Bn(m.transform);D.current=N,clearTimeout(_.current),_.current=setTimeout(()=>{A==null||A(N),n==null||n(m.sourceEvent,N)},i?150:0)}})},[T,n,i]),E.exports.useEffect(()=>{T&&T.filter(m=>{const A=V||r,N=o&&m.ctrlKey;return m.button===1&&m.type==="mousedown"&&m.target.closest(".react-flow__node")?!0:!h&&!A&&!i&&!l&&!o||c||!l&&m.type==="dblclick"||qt(m,w)&&m.type==="wheel"||qt(m,p)&&m.type!=="wheel"||!o&&m.ctrlKey&&m.type==="wheel"||!A&&!i&&!N&&m.type==="wheel"||!h&&(m.type==="mousedown"||m.type==="touchstart")?!1:(!m.ctrlKey||m.type==="wheel")&&(!m.button||m.button<=1)})},[T,r,o,i,l,h,c,u,V]),v("div",{className:"react-flow__renderer",ref:$,style:wr,children:x})};function uo(e,t){var r,o;const n=e.find(i=>i.id===t.parentNode);if(n){const i=t.position.x+t.width-n.width,s=t.position.y+t.height-n.height;if(i>0||s>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=(r=n.style.width)!=null?r:n.width,n.style.height=(o=n.style.height)!=null?o:n.height,i>0&&(n.style.width+=i),s>0&&(n.style.height+=s),t.position.x<0){const a=Math.abs(t.position.x);n.position.x=n.position.x-a,n.style.width+=a,t.position.x=0}if(t.position.y<0){const a=Math.abs(t.position.y);n.position.y=n.position.y-a,n.style.height+=a,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function Bs(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,o)=>{const i=e.find(s=>s.id===o.id);if(i)switch(i.type){case"select":return r.push({...o,selected:i.selected}),r;case"position":{const s={...o};return typeof i.position<"u"&&(s.position=i.position),typeof i.positionAbsolute<"u"&&(s.positionAbsolute=i.positionAbsolute),typeof i.dragging<"u"&&(s.dragging=i.dragging),s.expandParent&&uo(r,s),r.push(s),r}case"dimensions":{const s={...o};return typeof i.dimensions<"u"&&(s.width=i.dimensions.width,s.height=i.dimensions.height),s.expandParent&&uo(r,s),r.push(s),r}case"remove":return r}return r.push(o),r},n)}function vr(e,t){return Bs(e,t)}function td(e,t){return Bs(e,t)}const Fe=(e,t)=>({id:e,type:"select",selected:t});function tt(e,t){return e.reduce((n,r)=>{const o=t.includes(r.id);return!r.selected&&o?(r.selected=!0,n.push(Fe(r.id,!0))):r.selected&&!o&&(r.selected=!1,n.push(Fe(r.id,!1))),n},[])}function fo(e,t){return{x:e.clientX-t.left,y:e.clientY-t.top}}const nd=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable}),ho={startX:0,startY:0,x:0,y:0,width:0,height:0,draw:!1},Ps=E.exports.memo(({selectionKeyPressed:e})=>{const t=te(),n=E.exports.useRef(0),r=E.exports.useRef(0),o=E.exports.useRef(),[i,s]=E.exports.useState(ho),{userSelectionActive:a,elementsSelectable:l}=J(nd,le);if(!l||!(a||e))return null;const u=()=>{s(ho),t.setState({userSelectionActive:!1}),n.current=0,r.current=0};return v("div",{className:"react-flow__selectionpane react-flow__container",onMouseDown:g=>{const b=g.target.closest(".react-flow");o.current=b.getBoundingClientRect();const f=fo(g,o.current);s({width:0,height:0,startX:f.x,startY:f.y,x:f.x,y:f.y,draw:!0}),t.setState({userSelectionActive:!0,nodesSelectionActive:!1})},onMouseMove:g=>{var V,m;if(!e||!i.draw||!o.current)return;const b=fo(g,o.current),f=(V=i.startX)!=null?V:0,x=(m=i.startY)!=null?m:0,w={...i,x:b.x<f?b.x:f,y:b.y<x?b.y:x,width:Math.abs(b.x-f),height:Math.abs(b.y-x)},{nodeInternals:p,edges:_,transform:S,onNodesChange:M,onEdgesChange:$}=t.getState(),D=Array.from(p.values()),T=ws(p,w,S,!1,!0),P=vs(T,_).map(A=>A.id),Y=T.map(A=>A.id);if(n.current!==Y.length){n.current=Y.length;const A=tt(D,Y);A.length&&(M==null||M(A))}if(r.current!==P.length){r.current=P.length;const A=tt(_,P);A.length&&($==null||$(A))}s(w)},onMouseUp:()=>{t.setState({nodesSelectionActive:n.current>0}),u()},onMouseLeave:()=>{t.setState({nodesSelectionActive:!1}),u()},children:i.draw&&v("div",{className:"react-flow__selection react-flow__container",style:{width:i.width,height:i.height,transform:`translate(${i.x}px, ${i.y}px)`}})})});Ps.displayName="UserSelection";const rd=e=>({transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive,...vn(Array.from(e.nodeInternals.values()).filter(t=>t.selected))}),od=e=>{const t=Array.from(e.nodeInternals.values()).filter(n=>n.selected);return vn(t)};function sd({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=te(),{transformString:o,userSelectionActive:i}=J(rd,le),{width:s,height:a,x:l,y:c}=J(od,le),u=zs(),h=E.exports.useRef(null);if(E.exports.useEffect(()=>{var C;n||(C=h.current)==null||C.focus()},[n]),Ds({nodeRef:h}),i||!s||!a)return null;const d=e?C=>{const g=Array.from(r.getState().nodeInternals.values()).filter(b=>b.selected);e(C,g)}:void 0,y=C=>{Object.prototype.hasOwnProperty.call(Et,C.key)&&u(Et[C.key])};return v("div",{className:se(["react-flow__nodesselection","react-flow__container",t]),style:{transform:o},children:v("div",{ref:h,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:y,style:{width:s,height:a,top:c,left:l}})})}var id=E.exports.memo(sd);const ad=e=>e.paneDragging;function cd({onClick:e,onMouseEnter:t,onMouseMove:n,onMouseLeave:r,onContextMenu:o,onWheel:i}){const s=J(ad);return v("div",{className:se(["react-flow__pane",{dragging:s}]),onClick:e,onMouseEnter:t,onMouseMove:n,onMouseLeave:r,onContextMenu:o,onWheel:i,style:wr})}const ld=e=>e.nodesSelectionActive,Os=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,deleteKeyCode:a,onMove:l,onMoveStart:c,onMoveEnd:u,selectionKeyCode:h,multiSelectionKeyCode:d,zoomActivationKeyCode:y,elementsSelectable:C,zoomOnScroll:g,zoomOnPinch:b,panOnScroll:f,panOnScrollSpeed:x,panOnScrollMode:w,zoomOnDoubleClick:p,panOnDrag:_,defaultViewport:S,translateExtent:M,minZoom:$,maxZoom:D,preventScrolling:T,onSelectionContextMenu:P,noWheelClassName:Y,noPanClassName:V,disableKeyboardA11y:m})=>{const A=te(),N=J(ld),k=dn(h);Gf({deleteKeyCode:a,multiSelectionKeyCode:d});const I=B=>{t==null||t(B),A.getState().resetSelectedElements(),A.setState({nodesSelectionActive:!1})},F=i?B=>i(B):void 0,z=s?B=>s(B):void 0;return L(ed,{onMove:l,onMoveStart:c,onMoveEnd:u,selectionKeyPressed:k,elementsSelectable:C,zoomOnScroll:g,zoomOnPinch:b,panOnScroll:f,panOnScrollSpeed:x,panOnScrollMode:w,zoomOnDoubleClick:p,panOnDrag:_,defaultViewport:S,translateExtent:M,minZoom:$,maxZoom:D,zoomActivationKeyCode:y,preventScrolling:T,noWheelClassName:Y,noPanClassName:V,children:[e,v(Ps,{selectionKeyPressed:k}),N&&v(id,{onSelectionContextMenu:P,noPanClassName:V,disableKeyboardA11y:m}),v(cd,{onClick:I,onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onContextMenu:F,onWheel:z})]})};Os.displayName="FlowRenderer";var ud=E.exports.memo(Os);function fd(e){return J(E.exports.useCallback(n=>e?ws(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):Array.from(n.nodeInternals.values()),[e]))}const dd=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions}),Hs=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,updateNodeDimensions:i}=J(dd,le),s=fd(e.onlyRenderVisibleElements),a=E.exports.useRef(),l=E.exports.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const c=new ResizeObserver(u=>{const h=u.map(d=>({id:d.target.getAttribute("data-id"),nodeElement:d.target,forceUpdate:!0}));i(h)});return a.current=c,c},[]);return E.exports.useEffect(()=>()=>{var c;(c=a==null?void 0:a.current)==null||c.disconnect()},[]),v("div",{className:"react-flow__nodes",style:wr,children:s.map(c=>{var p,_,S,M,$,D,T;let u=c.type||"default";e.nodeTypes[u]||(u="default");const h=e.nodeTypes[u]||e.nodeTypes.default,d=!!(c.draggable||t&&typeof c.draggable>"u"),y=!!(c.selectable||o&&typeof c.selectable>"u"),C=!!(c.connectable||n&&typeof c.connectable>"u"),g=!!(c.focusable||r&&typeof c.focusable>"u"),b=e.nodeExtent?hr(c.positionAbsolute,e.nodeExtent):c.positionAbsolute,f=(p=b==null?void 0:b.x)!=null?p:0,x=(_=b==null?void 0:b.y)!=null?_:0,w=Yf({x:f,y:x,width:(S=c.width)!=null?S:0,height:(M=c.height)!=null?M:0,origin:e.nodeOrigin});return v(h,{id:c.id,className:c.className,style:c.style,type:u,data:c.data,sourcePosition:c.sourcePosition||R.Bottom,targetPosition:c.targetPosition||R.Top,hidden:c.hidden,xPos:f,yPos:x,xPosOrigin:w.x,yPosOrigin:w.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!c.selected,isDraggable:d,isSelectable:y,isConnectable:C,isFocusable:g,resizeObserver:l,dragHandle:c.dragHandle,zIndex:(D=($=c[ne])==null?void 0:$.z)!=null?D:0,isParent:!!((T=c[ne])!=null&&T.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!c.width&&!!c.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:c.ariaLabel},c.id)})})};Hs.displayName="NodeRenderer";var hd=E.exports.memo(Hs);const pd=[{level:0,isMaxLevel:!0,edges:[]}];function gd(e,t,n=!1){let r=-1;const o=e.reduce((s,a)=>{var u,h,d,y;const l=hs(a.zIndex);let c=l?a.zIndex:0;return n&&(c=l?a.zIndex:Math.max(((h=(u=t.get(a.source))==null?void 0:u[ne])==null?void 0:h.z)||0,((y=(d=t.get(a.target))==null?void 0:d[ne])==null?void 0:y.z)||0)),s[c]?s[c].push(a):s[c]=[a],r=c>r?c:r,s},{}),i=Object.entries(o).map(([s,a])=>{const l=+s;return{edges:a,level:l,isMaxLevel:l===r}});return i.length===0?pd:i}function md(e,t,n){const r=J(E.exports.useCallback(o=>e?o.edges.filter(i=>{const s=t.get(i.source),a=t.get(i.target);return(s==null?void 0:s.width)&&(s==null?void 0:s.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&Hf({sourcePos:s.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:s.width,sourceHeight:s.height,targetWidth:a.width,targetHeight:a.height,width:o.width,height:o.height,transform:o.transform})}):o.edges,[e,t]));return gd(r,t,n)}const yd={[R.Left]:R.Right,[R.Right]:R.Left,[R.Top]:R.Bottom,[R.Bottom]:R.Top},Ls=({connectionNodeId:e,connectionHandleType:t,connectionLineStyle:n,connectionLineType:r=Re.Bezier,isConnectable:o,CustomConnectionLineComponent:i})=>{var _,S,M,$,D;const{fromNode:s,handleId:a,toX:l,toY:c}=J(E.exports.useCallback(T=>({fromNode:T.nodeInternals.get(e),handleId:T.connectionHandleId,toX:(T.connectionPosition.x-T.transform[0])/T.transform[2],toY:(T.connectionPosition.y-T.transform[1])/T.transform[2]}),[e]),le),u=(_=s==null?void 0:s[ne])==null?void 0:_.handleBounds;if(!s||!o||!(u!=null&&u[t]))return null;const h=u[t],d=a?h.find(T=>T.id===a):h[0],y=d?d.x+d.width/2:((S=s==null?void 0:s.width)!=null?S:0)/2,C=d?d.y+d.height/2:(M=s==null?void 0:s.height)!=null?M:0,g=((($=s==null?void 0:s.positionAbsolute)==null?void 0:$.x)||0)+y,b=(((D=s==null?void 0:s.positionAbsolute)==null?void 0:D.y)||0)+C,f=d==null?void 0:d.position;if(!f)return null;const x=yd[f];if(i)return v("g",{className:"react-flow__connection",children:v(i,{connectionLineType:r,connectionLineStyle:n,fromNode:s,fromHandle:d,fromX:g,fromY:b,toX:l,toY:c,fromPosition:f,toPosition:x})});let w="";const p={sourceX:g,sourceY:b,sourcePosition:f,targetX:l,targetY:c,targetPosition:x};return r===Re.Bezier?[w]=ms(p):r===Re.Step?[w]=Gn({...p,borderRadius:0}):r===Re.SmoothStep?[w]=Gn(p):r===Re.SimpleBezier?[w]=gs(p):w=`M${g},${b} ${l},${c}`,v("g",{className:"react-flow__connection",children:v("path",{d:w,fill:"none",className:"react-flow__connection-path",style:n})})};Ls.displayName="ConnectionLine";const xd=({color:e="none",strokeWidth:t=1})=>v("polyline",{stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,fill:"none",points:"-5,-4 0,0 -5,4"}),wd=({color:e="none",strokeWidth:t=1})=>v("polyline",{stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,fill:e,points:"-5,-4 0,0 -5,4 -5,-4"}),po={[un.Arrow]:xd,[un.ArrowClosed]:wd};function vd(e){return E.exports.useMemo(()=>Object.prototype.hasOwnProperty.call(po,e)?po[e]:null,[e])}const bd=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const l=vd(t);return l?v("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0",children:v(l,{color:n,strokeWidth:s})}):null},_d=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((o,i)=>([i.markerStart,i.markerEnd].forEach(s=>{if(s&&typeof s=="object"){const a=Qn(s,t);r.includes(a)||(o.push({id:a,color:s.color||e,...s}),r.push(a))}}),o),[]).sort((o,i)=>o.id.localeCompare(i.id))},Vs=({defaultColor:e,rfId:t})=>{const n=J(E.exports.useCallback(_d({defaultColor:e,rfId:t}),[e,t]),(r,o)=>!(r.length!==o.length||r.some((i,s)=>i.id!==o[s].id)));return v("defs",{children:n.map(r=>v(bd,{id:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient},r.id))})};Vs.displayName="MarkerDefinitions";var Sd=E.exports.memo(Vs);const Ed=e=>({connectionNodeId:e.connectionNodeId,connectionHandleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals}),Ys=e=>{const{connectionNodeId:t,connectionHandleType:n,nodesConnectable:r,edgesFocusable:o,elementsSelectable:i,width:s,height:a,connectionMode:l,nodeInternals:c}=J(Ed,le),u=md(e.onlyRenderVisibleElements,c,e.elevateEdgesOnSelect);if(!s)return null;const{connectionLineType:h,defaultMarkerColor:d,connectionLineStyle:y,connectionLineComponent:C,connectionLineContainerStyle:g}=e,b=t&&n;return L(re,{children:[u.map(({level:f,edges:x,isMaxLevel:w})=>L("svg",{style:{zIndex:f},width:s,height:a,className:"react-flow__edges react-flow__container",children:[w&&v(Sd,{defaultColor:d,rfId:e.rfId}),v("g",{children:x.map(p=>{const[_,S,M]=oo(c.get(p.source)),[$,D,T]=oo(c.get(p.target));if(!M||!T)return null;let P=p.type||"default";e.edgeTypes[P]||(P="default");const Y=e.edgeTypes[P]||e.edgeTypes.default,V=l===lt.Strict?D.target:D.target||D.source,m=ro(S.source,p.sourceHandle||null),A=ro(V,p.targetHandle||null),N=(m==null?void 0:m.position)||R.Bottom,k=(A==null?void 0:A.position)||R.Top,I=!!(p.focusable||o&&typeof p.focusable>"u");if(!m||!A)return hf(`Couldn't create edge for ${m?"target":"source"} handle id: ${m?p.targetHandle:p.sourceHandle}; edge id: ${p.id}. Help: https://reactflow.dev/error#800`),null;const{sourceX:F,sourceY:z,targetX:B,targetY:U}=Of(_,m,N,$,A,k);return v(Y,{id:p.id,className:se([p.className,e.noPanClassName]),type:P,data:p.data,selected:!!p.selected,animated:!!p.animated,hidden:!!p.hidden,label:p.label,labelStyle:p.labelStyle,labelShowBg:p.labelShowBg,labelBgStyle:p.labelBgStyle,labelBgPadding:p.labelBgPadding,labelBgBorderRadius:p.labelBgBorderRadius,style:p.style,source:p.source,target:p.target,sourceHandleId:p.sourceHandle,targetHandleId:p.targetHandle,markerEnd:p.markerEnd,markerStart:p.markerStart,sourceX:F,sourceY:z,targetX:B,targetY:U,sourcePosition:N,targetPosition:k,elementsSelectable:i,onEdgeUpdate:e.onEdgeUpdate,onContextMenu:e.onEdgeContextMenu,onMouseEnter:e.onEdgeMouseEnter,onMouseMove:e.onEdgeMouseMove,onMouseLeave:e.onEdgeMouseLeave,onClick:e.onEdgeClick,edgeUpdaterRadius:e.edgeUpdaterRadius,onEdgeDoubleClick:e.onEdgeDoubleClick,onEdgeUpdateStart:e.onEdgeUpdateStart,onEdgeUpdateEnd:e.onEdgeUpdateEnd,rfId:e.rfId,ariaLabel:p.ariaLabel,isFocusable:I,pathOptions:"pathOptions"in p?p.pathOptions:void 0,interactionWidth:p.interactionWidth},p.id)})})]},f)),b&&v("svg",{style:g,width:s,height:a,className:"react-flow__edges react-flow__connectionline react-flow__container",children:v(Ls,{connectionNodeId:t,connectionHandleType:n,connectionLineStyle:y,connectionLineType:h,isConnectable:r,CustomConnectionLineComponent:C})})]})};Ys.displayName="EdgeRenderer";var Nd=E.exports.memo(Ys);const Cd=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Md({children:e}){const t=J(Cd);return v("div",{className:"react-flow__viewport react-flow__container",style:{transform:t},children:e})}function Ad(e){const t=bn(),n=E.exports.useRef(!1);E.exports.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Us=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:o,onInit:i,onNodeClick:s,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:h,onNodeMouseLeave:d,onNodeContextMenu:y,onSelectionContextMenu:C,connectionLineType:g,connectionLineStyle:b,connectionLineComponent:f,connectionLineContainerStyle:x,selectionKeyCode:w,multiSelectionKeyCode:p,zoomActivationKeyCode:_,deleteKeyCode:S,onlyRenderVisibleElements:M,elementsSelectable:$,selectNodesOnDrag:D,defaultViewport:T,translateExtent:P,minZoom:Y,maxZoom:V,preventScrolling:m,defaultMarkerColor:A,zoomOnScroll:N,zoomOnPinch:k,panOnScroll:I,panOnScrollSpeed:F,panOnScrollMode:z,zoomOnDoubleClick:B,panOnDrag:U,onPaneClick:Z,onPaneMouseEnter:X,onPaneMouseMove:H,onPaneMouseLeave:K,onPaneScroll:q,onPaneContextMenu:G,onEdgeUpdate:j,onEdgeContextMenu:O,onEdgeMouseEnter:ie,onEdgeMouseMove:oe,onEdgeMouseLeave:Q,edgeUpdaterRadius:ge,onEdgeUpdateStart:ee,onEdgeUpdateEnd:ue,noDragClassName:fe,noWheelClassName:Te,noPanClassName:de,elevateEdgesOnSelect:Pe,disableKeyboardA11y:we,nodeOrigin:qe,nodeExtent:ut,rfId:Ge})=>(Ad(i),v(ud,{onPaneClick:Z,onPaneMouseEnter:X,onPaneMouseMove:H,onPaneMouseLeave:K,onPaneContextMenu:G,onPaneScroll:q,deleteKeyCode:S,selectionKeyCode:w,multiSelectionKeyCode:p,zoomActivationKeyCode:_,elementsSelectable:$,onMove:n,onMoveStart:r,onMoveEnd:o,zoomOnScroll:N,zoomOnPinch:k,zoomOnDoubleClick:B,panOnScroll:I,panOnScrollSpeed:F,panOnScrollMode:z,panOnDrag:U,defaultViewport:T,translateExtent:P,minZoom:Y,maxZoom:V,onSelectionContextMenu:C,preventScrolling:m,noDragClassName:fe,noWheelClassName:Te,noPanClassName:de,disableKeyboardA11y:we,children:L(Md,{children:[v(Nd,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:c,connectionLineType:g,connectionLineStyle:b,connectionLineComponent:f,connectionLineContainerStyle:x,onEdgeUpdate:j,onlyRenderVisibleElements:M,onEdgeContextMenu:O,onEdgeMouseEnter:ie,onEdgeMouseMove:oe,onEdgeMouseLeave:Q,onEdgeUpdateStart:ee,onEdgeUpdateEnd:ue,edgeUpdaterRadius:ge,defaultMarkerColor:A,noPanClassName:de,elevateEdgesOnSelect:!!Pe,disableKeyboardA11y:we,rfId:Ge}),v("div",{className:"react-flow__edgelabel-renderer",id:"edgelabel-portal"}),v(hd,{nodeTypes:e,onNodeClick:s,onNodeDoubleClick:l,onNodeMouseEnter:u,onNodeMouseMove:h,onNodeMouseLeave:d,onNodeContextMenu:y,selectNodesOnDrag:D,onlyRenderVisibleElements:M,noPanClassName:de,noDragClassName:fe,disableKeyboardA11y:we,nodeOrigin:qe,nodeExtent:ut,rfId:Ge})]})}));Us.displayName="GraphView";var Td=E.exports.memo(Us);const tr=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Gt={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:tr,nodeExtent:tr,nodesSelectionActive:!1,userSelectionActive:!1,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionMode:lt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,elementsSelectable:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,connectionStartHandle:null,connectOnClick:!0,ariaLiveMessage:""},kd=()=>aa((e,t)=>({...Gt,setNodes:n=>{e({nodeInternals:Rn(n,t().nodeInternals)})},setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(o=>({...r,...o}))})},setDefaultNodesAndEdges:(n,r)=>{const o=typeof n<"u",i=typeof r<"u",s=o?Rn(n,new Map):new Map;e({nodeInternals:s,edges:i?r:[],hasDefaultNodes:o,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:o,fitViewOnInit:i,fitViewOnInitDone:s,fitViewOnInitOptions:a,domNode:l,nodeOrigin:c}=t(),u=l==null?void 0:l.querySelector(".react-flow__viewport");if(!u)return;const h=window.getComputedStyle(u),{m22:d}=new window.DOMMatrixReadOnly(h.transform),y=n.reduce((g,b)=>{const f=o.get(b.id);if(f){const x=dr(b.nodeElement);!!(x.width&&x.height&&(f.width!==x.width||f.height!==x.height||b.forceUpdate))&&(o.set(f.id,{...f,[ne]:{...f[ne],handleBounds:{source:io(".source",b.nodeElement,d,c),target:io(".target",b.nodeElement,d,c)}},...x}),g.push({id:f.id,type:"dimensions",dimensions:x}))}return g},[]),C=s||i&&!s&&Rs(t,{initial:!0,...a});e({nodeInternals:new Map(o),fitViewOnInitDone:C}),(y==null?void 0:y.length)>0&&(r==null||r(y))},updateNodePositions:(n,r=!0,o=!1)=>{const{onNodesChange:i,nodeInternals:s,hasDefaultNodes:a}=t();if(a||i){const l=n.map(c=>{const u={id:c.id,type:"position",dragging:o};return r&&(u.positionAbsolute=c.positionAbsolute,u.position=c.position),u});if(l!=null&&l.length){if(a){const c=vr(l,Array.from(s.values())),u=Rn(c,s);e({nodeInternals:u})}i==null||i(l)}}},addSelectedNodes:n=>{const{multiSelectionActive:r,nodeInternals:o,edges:i}=t();let s,a=null;r?s=n.map(l=>Fe(l,!0)):(s=tt(Array.from(o.values()),n),a=tt(i,[])),Zt({changedNodes:s,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:o,nodeInternals:i}=t();let s,a=null;r?s=n.map(l=>Fe(l,!0)):(s=tt(o,n),a=tt(Array.from(i.values()),[])),Zt({changedNodes:a,changedEdges:s,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{nodeInternals:o,edges:i}=t(),s=n||Array.from(o.values()),a=r||i,l=s.map(u=>(u.selected=!1,Fe(u.id,!1))),c=a.map(u=>Fe(u.id,!1));Zt({changedNodes:l,changedEdges:c,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:o}=t();r==null||r.scaleExtent([n,o]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:o}=t();r==null||r.scaleExtent([o,n]),e({maxZoom:n})},setTranslateExtent:n=>{const{d3Zoom:r}=t();r==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{nodeInternals:n,edges:r}=t(),i=Array.from(n.values()).filter(a=>a.selected).map(a=>Fe(a.id,!1)),s=r.filter(a=>a.selected).map(a=>Fe(a.id,!1));Zt({changedNodes:i,changedEdges:s,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(o=>{o.positionAbsolute=hr(o.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},cancelConnection:()=>e({connectionNodeId:Gt.connectionNodeId,connectionHandleId:Gt.connectionHandleId}),reset:()=>e({...Gt})})),Xs=({children:e})=>{const t=E.exports.useRef(null);return t.current||(t.current=kd()),v(sf,{value:t.current,children:e})};Xs.displayName="ReactFlowProvider";const Ws=({children:e})=>{let t=!0;try{te()}catch{t=!1}return t?v(re,{children:e}):v(Xs,{children:e})};Ws.displayName="ReactFlowWrapper";function go(e,t){return E.exports.useRef(null),E.exports.useMemo(()=>t(e),[e])}const $d={input:Ns,default:Jn,output:Ms,group:xr},Id={default:fn,straight:mr,step:gr,smoothstep:wn,simplebezier:pr},Dd=[0,0],zd=[15,15],Fd={x:0,y:0,zoom:1},Rd={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Ks=E.exports.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:i=$d,edgeTypes:s=Id,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:u,onMoveStart:h,onMoveEnd:d,onConnect:y,onConnectStart:C,onConnectEnd:g,onClickConnectStart:b,onClickConnectEnd:f,onNodeMouseEnter:x,onNodeMouseMove:w,onNodeMouseLeave:p,onNodeContextMenu:_,onNodeDoubleClick:S,onNodeDragStart:M,onNodeDrag:$,onNodeDragStop:D,onNodesDelete:T,onEdgesDelete:P,onSelectionChange:Y,onSelectionDragStart:V,onSelectionDrag:m,onSelectionDragStop:A,onSelectionContextMenu:N,connectionMode:k=lt.Strict,connectionLineType:I=Re.Bezier,connectionLineStyle:F,connectionLineComponent:z,connectionLineContainerStyle:B,deleteKeyCode:U="Backspace",selectionKeyCode:Z="Shift",multiSelectionKeyCode:X="Meta",zoomActivationKeyCode:H="Meta",snapToGrid:K=!1,snapGrid:q=zd,onlyRenderVisibleElements:G=!1,selectNodesOnDrag:j=!0,nodesDraggable:O,nodesConnectable:ie,nodesFocusable:oe,nodeOrigin:Q=Dd,edgesFocusable:ge,elementsSelectable:ee,defaultViewport:ue=Fd,minZoom:fe=.5,maxZoom:Te=2,translateExtent:de=tr,preventScrolling:Pe=!0,nodeExtent:we,defaultMarkerColor:qe="#b1b1b7",zoomOnScroll:ut=!0,zoomOnPinch:Ge=!0,panOnScroll:Rt=!1,panOnScrollSpeed:Bt=.5,panOnScrollMode:_n=ot.Free,zoomOnDoubleClick:Sn=!0,panOnDrag:En=!0,onPaneClick:he,onPaneMouseEnter:ve,onPaneMouseMove:Oe,onPaneMouseLeave:He,onPaneScroll:ke,onPaneContextMenu:Pt,children:ft,onEdgeUpdate:dt,onEdgeContextMenu:Nn,onEdgeDoubleClick:_r,onEdgeMouseEnter:Le,onEdgeMouseMove:oi,onEdgeMouseLeave:si,onEdgeUpdateStart:ii,onEdgeUpdateEnd:ai,edgeUpdaterRadius:ci=10,onNodesChange:li,onEdgesChange:ui,noDragClassName:fi="nodrag",noWheelClassName:di="nowheel",noPanClassName:Sr="nopan",fitView:hi=!1,fitViewOptions:pi,connectOnClick:gi=!0,attributionPosition:mi,proOptions:yi,defaultEdgeOptions:xi,elevateEdgesOnSelect:wi=!1,disableKeyboardA11y:Er=!1,style:vi,id:Nr,...bi},_i)=>{const Si=go(i,Vf),Ei=go(s,Pf),Cn=Nr||"1";return v("div",{...bi,style:{...vi,...Rd},ref:_i,className:se(["react-flow",o]),"data-testid":"rf__wrapper",id:Nr,children:L(Ws,{children:[v(Td,{onInit:c,onMove:u,onMoveStart:h,onMoveEnd:d,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:x,onNodeMouseMove:w,onNodeMouseLeave:p,onNodeContextMenu:_,onNodeDoubleClick:S,nodeTypes:Si,edgeTypes:Ei,connectionLineType:I,connectionLineStyle:F,connectionLineComponent:z,connectionLineContainerStyle:B,selectionKeyCode:Z,deleteKeyCode:U,multiSelectionKeyCode:X,zoomActivationKeyCode:H,onlyRenderVisibleElements:G,selectNodesOnDrag:j,defaultViewport:ue,translateExtent:de,minZoom:fe,maxZoom:Te,preventScrolling:Pe,zoomOnScroll:ut,zoomOnPinch:Ge,zoomOnDoubleClick:Sn,panOnScroll:Rt,panOnScrollSpeed:Bt,panOnScrollMode:_n,panOnDrag:En,onPaneClick:he,onPaneMouseEnter:ve,onPaneMouseMove:Oe,onPaneMouseLeave:He,onPaneScroll:ke,onPaneContextMenu:Pt,onSelectionContextMenu:N,onEdgeUpdate:dt,onEdgeContextMenu:Nn,onEdgeDoubleClick:_r,onEdgeMouseEnter:Le,onEdgeMouseMove:oi,onEdgeMouseLeave:si,onEdgeUpdateStart:ii,onEdgeUpdateEnd:ai,edgeUpdaterRadius:ci,defaultMarkerColor:qe,noDragClassName:fi,noWheelClassName:di,noPanClassName:Sr,elevateEdgesOnSelect:wi,rfId:Cn,disableKeyboardA11y:Er,nodeOrigin:Q,nodeExtent:we}),v(kf,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:y,onConnectStart:C,onConnectEnd:g,onClickConnectStart:b,onClickConnectEnd:f,nodesDraggable:O,nodesConnectable:ie,nodesFocusable:oe,edgesFocusable:ge,elementsSelectable:ee,minZoom:fe,maxZoom:Te,nodeExtent:we,onNodesChange:li,onEdgesChange:ui,snapToGrid:K,snapGrid:q,connectionMode:k,translateExtent:de,connectOnClick:gi,defaultEdgeOptions:xi,fitView:hi,fitViewOptions:pi,onNodesDelete:T,onEdgesDelete:P,onNodeDragStart:M,onNodeDrag:$,onNodeDragStop:D,onSelectionDrag:m,onSelectionDragStart:V,onSelectionDragStop:A,noPanClassName:Sr,nodeOrigin:Q,rfId:Cn}),v(Af,{onSelectionChange:Y}),ft,v(cf,{proOptions:yi,position:mi}),v(Ff,{rfId:Cn,disableKeyboardA11y:Er})]})})});Ks.displayName="ReactFlow";function Bd(){const e=te();return E.exports.useCallback(t=>{const{domNode:n,updateNodeDimensions:r}=e.getState(),o=n==null?void 0:n.querySelector(`.react-flow__node[data-id="${t}"]`);o&&requestAnimationFrame(()=>r([{id:t,nodeElement:o,forceUpdate:!0}]))},[])}function Zs(e){return t=>{const[n,r]=E.exports.useState(t),o=E.exports.useCallback(i=>r(s=>e(i,s)),[]);return[n,r,o]}}const Pd=Zs(vr),Od=Zs(td),qs=({id:e,x:t,y:n,width:r,height:o,style:i,color:s,strokeColor:a,strokeWidth:l,className:c,borderRadius:u,shapeRendering:h,onClick:d})=>{const{background:y,backgroundColor:C}=i||{},g=s||y||C;return v("rect",{className:se(["react-flow__minimap-node",c]),x:t,y:n,rx:u,ry:u,width:r,height:o,fill:g,stroke:a,strokeWidth:l,shapeRendering:h,onClick:d?b=>d(b,e):void 0})};qs.displayName="MiniMapNode";var Hd=E.exports.memo(qs);const Ld=200,Vd=150,Yd=e=>{const t=Array.from(e.nodeInternals.values()),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{nodes:t.filter(r=>!r.hidden&&r.width&&r.height),viewBB:n,boundingRect:t.length>0?ff(vn(t),n):n,rfId:e.rfId}},Pn=e=>e instanceof Function?e:()=>e,Ud="react-flow__minimap-desc";function Gs({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:o="",nodeBorderRadius:i=5,nodeStrokeWidth:s=2,maskColor:a="rgb(240, 240, 240, 0.6)",position:l="bottom-right",onClick:c,onNodeClick:u,pannable:h=!1,zoomable:d=!1}){var Z,X;const y=te(),C=E.exports.useRef(null),{boundingRect:g,viewBB:b,nodes:f,rfId:x}=J(Yd,le),w=(Z=e==null?void 0:e.width)!=null?Z:Ld,p=(X=e==null?void 0:e.height)!=null?X:Vd,_=Pn(r),S=Pn(n),M=Pn(o),$=g.width/w,D=g.height/p,T=Math.max($,D),P=T*w,Y=T*p,V=5*T,m=g.x-(P-g.width)/2-V,A=g.y-(Y-g.height)/2-V,N=P+V*2,k=Y+V*2,I=typeof window>"u"||!!window.chrome?"crispEdges":"geometricPrecision",F=`${Ud}-${x}`,z=E.exports.useRef(0);z.current=T,E.exports.useEffect(()=>{if(C.current){const H=ye(C.current),K=j=>{const{transform:O,d3Selection:ie,d3Zoom:oe}=y.getState();if(j.sourceEvent.type!=="wheel"||!ie||!oe)return;const Q=-j.sourceEvent.deltaY*(j.sourceEvent.deltaMode===1?.05:j.sourceEvent.deltaMode?1:.002)*10,ge=O[2]*Math.pow(2,Q);oe.scaleTo(ie,ge)},q=j=>{const{transform:O,d3Selection:ie,d3Zoom:oe}=y.getState();if(j.sourceEvent.type!=="mousemove"||!ie||!oe)return;const Q={x:O[0]-j.sourceEvent.movementX*z.current*Math.max(1,O[2]),y:O[1]-j.sourceEvent.movementY*z.current*Math.max(1,O[2])},ge=Be.translate(Q.x,Q.y).scale(O[2]);oe.transform(ie,ge)},G=is().on("zoom",h?q:null).on("zoom.wheel",d?K:null);return H.call(G),()=>{H.on("zoom",null)}}},[h,d]);const B=c?H=>{const K=be(H);c(H,{x:K[0],y:K[1]})}:void 0,U=u?(H,K)=>{const q=y.getState().nodeInternals.get(K);u(H,q)}:void 0;return v(fr,{position:l,style:e,className:se(["react-flow__minimap",t]),children:L("svg",{width:w,height:p,viewBox:`${m} ${A} ${N} ${k}`,role:"img","aria-labelledby":F,ref:C,onClick:B,children:[v("title",{id:F,children:"React Flow mini map"}),f.map(H=>{var K,q,G,j;return v(Hd,{x:(q=(K=H.positionAbsolute)==null?void 0:K.x)!=null?q:0,y:(j=(G=H.positionAbsolute)==null?void 0:G.y)!=null?j:0,width:H.width,height:H.height,style:H.style,className:M(H),color:_(H),borderRadius:i,strokeColor:S(H),strokeWidth:s,shapeRendering:I,onClick:U,id:H.id},H.id)}),v("path",{className:"react-flow__minimap-mask",d:`M${m-V},${A-V}h${N+V*2}v${k+V*2}h${-N-V*2}z
        M${b.x},${b.y}h${b.width}v${b.height}h${-b.width}z`,fill:a,fillRule:"evenodd"})]})})}Gs.displayName="MiniMap";var Xd=E.exports.memo(Gs);function Wd(){return v("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:v("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Kd(){return v("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:v("path",{d:"M0 0h32v4.2H0z"})})}function Zd(){return v("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:v("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function qd(){return v("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:v("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Gd(){return v("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:v("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}const _t=({children:e,className:t,...n})=>v("button",{type:"button",className:se(["react-flow__controls-button",t]),...n,children:e});_t.displayName="ControlButton";const jd=e=>e.nodesDraggable&&e.nodesConnectable&&e.elementsSelectable,js=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:l,className:c,children:u,position:h="bottom-left"})=>{const d=te(),[y,C]=E.exports.useState(!1),g=J(jd),{zoomIn:b,zoomOut:f,fitView:x}=bn();if(E.exports.useEffect(()=>{C(!0)},[]),!y)return null;const w=()=>{b(),i==null||i()},p=()=>{f(),s==null||s()},_=()=>{x(o),a==null||a()},S=()=>{d.setState({nodesDraggable:!g,nodesConnectable:!g,elementsSelectable:!g}),l==null||l(!g)};return L(fr,{className:se(["react-flow__controls",c]),position:h,style:e,children:[t&&L(re,{children:[v(_t,{onClick:w,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",children:v(Wd,{})}),v(_t,{onClick:p,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",children:v(Kd,{})})]}),n&&v(_t,{className:"react-flow__controls-fitview",onClick:_,title:"fit view","aria-label":"fit view",children:v(Zd,{})}),r&&v(_t,{className:"react-flow__controls-interactive",onClick:S,title:"toggle interactivity","aria-label":"toggle interactivity",children:g?v(Gd,{}):v(qd,{})}),u]})};js.displayName="Controls";var Qd=E.exports.memo(js),xe;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(xe||(xe={}));function Jd({color:e,dimensions:t,lineWidth:n}){return v("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function eh({color:e,radius:t}){return v("circle",{cx:t,cy:t,r:t,fill:e})}const th={[xe.Dots]:"#91919a",[xe.Lines]:"#eee",[xe.Cross]:"#e2e2e2"},nh={[xe.Dots]:1,[xe.Lines]:1,[xe.Cross]:6},rh=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Qs({variant:e=xe.Dots,gap:t=20,size:n,lineWidth:r=1,color:o,style:i,className:s}){const a=E.exports.useRef(null),{transform:l,patternId:c}=J(rh,le),u=o||th[e],h=n||nh[e],d=e===xe.Dots,y=e===xe.Cross,C=Array.isArray(t)?t:[t,t],g=[C[0]*l[2]||1,C[1]*l[2]||1],b=h*l[2],f=y?[b,b]:g,x=d?[b/2,b/2]:[f[0]/2,f[1]/2];return L("svg",{className:se(["react-flow__background",s]),style:{...i,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:a,children:[v("pattern",{id:c,x:l[0]%g[0],y:l[1]%g[1],width:g[0],height:g[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${x[0]},-${x[1]})`,children:d?v(eh,{color:u,radius:b/2}):v(Jd,{dimensions:f,color:u,lineWidth:r})}),v("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${c})`})]})}Qs.displayName="Background";var oh=E.exports.memo(Qs);const nr=e=>`${e.sourceEntity}_${e.name}`,sh=e=>`${e.targetEntity}_${e.targetName}`,br=e=>`entity_er_node_id_${e.id}`,rr=(e,t)=>`${br(e)}_${t.id}`,Js=e=>e.type===So.Lookup&&e.relationType===wt.ManyToOne,ei=e=>e.type===So.Lookup?"green":"red",ih=22,Nt=18,ah=40,ch=({entity:e,relation:t,passive:n})=>{const r=bn(),o=Bd(),[i,s]=E.exports.useState(Number.MAX_SAFE_INTEGER);return E.exports.useEffect(()=>{var a,l,c,u;if(n&&Js(t))s(ah/2-Nt/2);else{const h=(a=document.getElementById(br(e)))==null?void 0:a.getClientRects()[0],d=(l=document.getElementById(rr(e,t)))==null?void 0:l.getClientRects()[0],y=((c=d==null?void 0:d.top)!=null?c:0)-((u=h==null?void 0:h.top)!=null?u:0);s(y)}setTimeout(()=>o(e.name))},[e,n,r,t,o]),{top:i,left:n?-Nt:"auto",right:n?"auto":-Nt}},lh=({relation:e,passive:t})=>{const[n,r]=E.exports.useState("relation-one-many");return E.exports.useEffect(()=>{if(t)switch(e.relationType){case wt.ManyToMany:r("relation-one-many");break;case wt.ManyToOne:case Ot.ManyToOne:case Ot.OneToOne:r("relation-one-one");break}else switch(e.relationType){case wt.ManyToMany:case wt.ManyToOne:case Ot.ManyToOne:r("relation-one-many");break;case Ot.OneToOne:r("relation-one-one");break}},[t,e.relationType]),{icon:n,color:ei(e)}},mo=({data:{entity:e,entity:{relations:t}},relation:n,passive:r})=>{const o=r?sh(n):nr(n),{top:i,left:s,right:a}=ch({entity:e,relation:n,passive:r}),{icon:l,color:c}=lh({relation:n,passive:r});return v(It,{className:uh.wrapper,id:o,type:r?"target":"source",position:r?R.Left:R.Right,style:{left:s,right:a,top:i+ih/2},onConnect:u=>console.log("handle onConnect",u),isConnectable:!1,children:v("span",{style:{color:c,transform:r?"rotateY(0deg)":"rotateY(180deg)"},children:v(Ci,{type:l})})},n.id)},uh={wrapper:ae("height:",Nt,"px!important;width:",Nt,"px!important;display:flex;justify-content:center;align-items:center;border-radius:0;background-color:transparent!important;","")},fh=e=>{const{data:{entity:{relations:t},passiveEntityRelations:n}}=e;return L(re,{children:[t.map(r=>v(mo,{...e,passive:!1,relation:r},r.id)),n.map(r=>v(mo,{...e,passive:!0,relation:r},r.id))]})},dh=({data:{entity:e}})=>L("div",{className:Ue(Se.section),children:[v(Ne.Title,{className:Ue(Se.sectionTitle),level:5,children:"\u5B57\u6BB5"}),St.exports.isEmpty(e.fields)?v(Di,{description:"\u6682\u65E0\u5B57\u6BB5"}):e.fields.map(t=>L("div",{className:Ue(Se.sectionItem),children:[L(Ct,{size:"small",children:[L(Ne.Text,{children:[t.description,"(",t.name,")"]}),t.required&&v(Ne.Text,{type:"danger",children:"*"})]}),v(Ne.Text,{children:t.type})]},t.name))]}),hh=({data:{entity:e,entity:{relations:t},passiveEntityRelations:n}})=>{const r=n.filter(i=>!Js(i)),o=[...t,...r];return St.exports.isEmpty(o)?null:L("div",{className:Ue(Se.section),children:[v(Ne.Title,{className:Ue(Se.sectionTitle),level:5,children:"\u5173\u7CFB"}),t.map(i=>L("div",{className:Ue(Se.sectionItem),id:rr(e,i),children:[v(Ct,{size:"small",children:L(Ne.Text,{children:[i.description,"(",i.name,")"]})}),v(Ne.Text,{children:i.type})]},i.name)),r.map(i=>L("div",{className:Ue(Se.sectionItem),id:rr(e,i),children:[v(Ct,{size:"small",children:L(Ne.Text,{disabled:!0,children:[i.targetDescription,"(",i.targetName,")"]})}),v(Ne.Text,{disabled:!0,children:i.type})]},i.targetName))]})},ph=e=>{const{data:{entity:t}}=e,n=bo();return L(re,{children:[v(fh,{...e}),L("div",{id:br(t),style:{"--header-bg-color":n.colorPrimary},className:Se.wrapper,children:[v("div",{className:Se.header,children:v(Ne.Title,{level:5,children:t.title})}),L("div",{className:Se.body,children:[v(dh,{...e}),v(hh,{...e})]}),L(Hi,{className:Se.footer,children:[v(Cr,{span:12,children:v(Ce,{block:!0,type:"link",onClick:()=>et.emit("onChange",t),children:"\u7F16\u8F91"})}),v(Cr,{span:12,children:v(Ce,{block:!0,type:"text",danger:!0,onClick:()=>et.emit("onDelete",t.id),children:"\u5220\u9664"})})]})]})]})},Se={wrapper:ae({name:"zo47d5",styles:"width:300px;border-radius:10px;background-color:white;overflow:hidden;border:solid rgba(0,0,0,.1)"}),header:ae({name:"szrp7z",styles:"background-color:var(--header-bg-color);padding:8px 16px;.ant-typography{color:white;margin:0;}"}),body:ae({name:"1jb4mpp",styles:"padding:4px 0"}),section:ae("",""),sectionTitle:ae({name:"1dhy8e2",styles:"color:var(--header-bg-color)!important;padding:0 16px;font-size:14px!important;font-weight:normal!important;margin-bottom:0!important"}),sectionItem:ae({name:"1r7zpal",styles:"padding:0 16px;display:flex;justify-content:space-between;align-items:center;.ant-typography{font-size:12px;}"}),footer:ae({name:"covnv5",styles:"border-top:solid rgba(0,0,0,.1)"})},gh={EntityNode:E.exports.memo(ph)},mh=()=>{const[e,t]=ki(Ke.entitiesSelector),n=hn(Ke.entityRelationsByTargetEntityNameMapSelector),[r,o,i]=Pd(e.map(a=>({id:a.name,type:"EntityNode",data:{entity:a,passiveEntityRelations:n[a.name]||[]},position:a.position}))),s=E.exports.useCallback(a=>{i(a);const l=vr(a,r),c=St.exports.keyBy(a.filter(h=>h.type==="position"),"id"),u=St.exports.keyBy(l,h=>h.id);t(h=>h.map(d=>{var y,C;return Reflect.has(c,d.name)?{...d,position:(C=(y=u[d.name])==null?void 0:y.positionAbsolute)!=null?C:d.position}:d}))},[r,i,t]);return E.exports.useEffect(()=>{o(a=>{const l=St.exports.keyBy(a,c=>c.id);return e.map(c=>l[c.name]?{...l[c.name],data:{entity:c,passiveEntityRelations:n[c.name]||[]},position:c.position}:{id:c.name,type:"EntityNode",data:{entity:c,passiveEntityRelations:n[c.name]||[]},position:c.position})})},[e,n,o]),{nodes:r,onNodesChange:s}},yh=({onChangeEntity:e,onDeleteEntity:t})=>{const n=bo(),r=hn(Ke.entityRelationsSelector),{nodes:o,onNodesChange:i}=mh(),[s,a,l]=Od(r.map(u=>({id:u.id,source:u.sourceEntity,target:u.targetEntity,sourceHandle:nr(u),targetHandle:nr(u),style:{stroke:ei(u),zIndex:999999}}))),c=E.exports.useCallback(u=>a(h=>xs({...u,animated:!0,style:{stroke:"green"}},h)),[a]);return E.exports.useEffect(()=>(et.on("onDelete",t),et.on("onChange",e),()=>{et.off("onDelete",t),et.off("onChange",e)}),[e,t]),v("div",{className:xh.wrapper,children:L(Ks,{nodes:o,edges:s,onNodesChange:i,onEdgesChange:l,onConnect:c,style:{background:"#fff"},nodeTypes:gh,connectionLineStyle:{stroke:n.colorPrimary,zIndex:999999},snapToGrid:!0,snapGrid:[20,20],attributionPosition:"bottom-left",children:[v(oh,{variant:xe.Cross,gap:10,size:2}),v(Qd,{}),v(Xd,{pannable:!0,zoomable:!0})]})})},xh={wrapper:ae({name:"mfs71j",styles:"height:100%;.react-flow__attribution{display:none;}.react-flow__node{border:none;}.react-flow__handle{z-index:9;}.react-flow__edges{z-index:999999!important;}"})},wh=({onChangeEntity:e,onDeleteEntity:t})=>{const n=hn(Ke.entitiesSelector),r=[{title:"\u540D\u79F0",dataIndex:"title",key:"title"},{title:"\u6807\u8BC6",dataIndex:"name",key:"name"},{title:"\u63CF\u8FF0",dataIndex:"description",key:"description"},{title:"\u64CD\u4F5C",dataIndex:"operation",key:"operation",width:100,align:"center",fixed:"right",render:(o,i)=>L(Ct,{size:"small",children:[v(Ce,{size:"small",type:"link",onClick:()=>e(i),children:"\u7F16\u8F91"}),v(Ce,{size:"small",danger:!0,type:"text",onClick:()=>t(i.id),children:"\u5220\u9664"})]})}];return v("div",{className:vh.wrapper,children:v(Eo,{rowKey:"id",size:"small",columns:r,dataSource:n})})},vh={wrapper:ae("","")},ti=({onOk:e,onCancel:t,open:n,mode:r,form:o})=>v(re,{children:v(zi,{title:r==="create"?"\u521B\u5EFA\u6570\u636E\u6A21\u578B":"\u7F16\u8F91\u6570\u636E\u6A21\u578B",onCancel:()=>{t(),o.resetFields()},onOk:async()=>{await o.validateFields(),e(o.getFieldsValue()),o.resetFields()},open:n,destroyOnClose:!0,children:L(Je,{form:o,labelCol:{style:{width:"50px"}},children:[v(Je.Item,{label:"ID",name:"id",hidden:!0,children:v(Ht,{})}),v(Je.Item,{label:"\u540D\u79F0",name:"title",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u636E\u6A21\u578B\u540D\u79F0"}],children:v(Ht,{})}),v(Je.Item,{label:"\u6807\u8BC6",name:"name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u636E\u6A21\u578B\u6807\u8BC6"},{pattern:/^[a-zA-Z]\w+$/,message:"\u53EA\u80FD\u7531\u82F1\u6587\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\u7EC4\u6210\uFF0C\u4E14\u5FC5\u987B\u82F1\u6587\u5F00\u5934"}],children:v(Ht,{disabled:r==="edit"})}),v(Je.Item,{label:"\u63CF\u8FF0",name:"description",children:v(Ht,{})})]})})}),ni=Fi(),ri=({children:e})=>{const[t,n]=E.exports.useState(null);return Ri(()=>{setTimeout(()=>{n(document.getElementById(ni))})}),t?$i.exports.createPortal(e,t):null},bh=()=>v("span",{id:ni}),_h=({entity:e,onEditEntity:t})=>L(re,{children:[v(ri,{children:v(Ce,{type:"link",onClick:()=>t(e),children:"\u7F16\u8F91"})}),v("div",{className:Sh.wrapper,children:L(Bi,{readonly:!0,layout:"horizontal",grid:!0,colProps:{span:12},submitter:!1,children:[v(Mn,{label:"\u540D\u79F0",fieldProps:{value:e.title}}),v(Mn,{label:"\u6807\u8BC6",fieldProps:{value:e.name}}),v(Mn,{label:"\u63CF\u8FF0",fieldProps:{value:e.description}})]})})]}),Sh={wrapper:ae({name:"10rtstj",styles:"padding:16px"})},On=({entity:e})=>{const t=[{title:"\u540D\u79F0",dataIndex:"title",key:"title"},{title:"\u6807\u8BC6",dataIndex:"name",key:"name"},{title:"\u63CF\u8FF0",dataIndex:"description",key:"description"},{title:"\u64CD\u4F5C",dataIndex:"operation",key:"operation",width:100,align:"center",fixed:"right",render:(n,r)=>L(Ct,{size:"small",children:[v(Ce,{size:"small",type:"link",children:"\u7F16\u8F91"}),v(Ce,{size:"small",type:"link",children:"\u8BE6\u60C5"}),v(Ce,{size:"small",danger:!0,type:"text",children:"\u5220\u9664"})]})}];return L(re,{children:[v(ri,{children:v(Ce,{type:"link",children:"\u6DFB\u52A0\u5B57\u6BB5"})}),v("div",{children:v(Eo,{size:"small",dataSource:e.fields,rowKey:"id",columns:t,pagination:!1})})]})},Eh=()=>v(Pi,{title:"\u65B0\u5EFA\u5B57\u6BB5",open:!0,children:"123"}),Nh=[{key:"List",tab:"\u5217\u8868"},{key:"ER",tab:"ER\u56FE"}],Dh=()=>{const[e,t]=Ao({activeTabKey:"List"}),n=vo(Ke.entityByIdSelector),[r,o]=E.exports.useState("edit"),i=g=>{n(_o(b=>{Reflect.deleteProperty(b,g)}))},{open:s,setFalse:a,setTrue:l,onSubmitEntity:c,form:u}=Co(),h=Mi(),d=wo(),y=g=>{h(Oi(Ai.Entity,{entityId:g.id,appId:d.appId}))},C=()=>{o("create"),l()};return L(re,{children:[v(ti,{onOk:c,onCancel:a,open:s,mode:r,form:u}),v("div",{className:yo.wrapper,children:v(No,{size:"small",tabProps:{size:"small"},className:yo.card,title:v("span",{children:"\u6570\u636E\u6A21\u578B"}),tabList:Nh,tabBarExtraContent:v(Ce,{type:"link",onClick:C,children:"\u6DFB\u52A0\u6A21\u578B"}),activeTabKey:e.activeTabKey,onTabChange:g=>t({activeTabKey:g}),children:e.activeTabKey==="List"?v(wh,{onDeleteEntity:i,onChangeEntity:y}):v(yh,{onDeleteEntity:i,onChangeEntity:y})})})]})},yo={wrapper:ae({name:"13udsys",styles:"height:100%"}),card:ae({name:"tpenv9",styles:"height:100%;display:flex;flex-direction:column;.ant-card-body{flex:1;padding:0;}"})},Ch=[{key:"Base",tab:"\u57FA\u7840\u4FE1\u606F"},{key:"Field",tab:"\u5B57\u6BB5\u548C\u5173\u7CFB"},{key:"Method",tab:"\u65B9\u6CD5"},{key:"View",tab:"\u89C6\u56FE"}],zh=()=>{const[e,t]=Ao({activeTabKey:"Base"}),{entityId:n}=wo(),r=hn(Ke.entitySelector(n)),{open:o,setFalse:i,setTrue:s,onSubmitEntity:a,form:l}=Co(),c=u=>{switch(u){case"Base":return v(_h,{entity:r,onEditEntity:()=>{l.setFieldsValue(r),s()}});case"Field":return v(On,{entity:r});case"Method":return v(On,{entity:r});case"View":return v(On,{entity:r});default:return v("div",{children:"\u672A\u77E5\u6A21\u5757"})}};return L(re,{children:[L(re,{children:[v(ti,{onOk:a,onCancel:i,open:o,mode:"edit",form:l}),v(Eh,{})]}),v("div",{className:xo.wrapper,children:v(No,{size:"small",tabProps:{size:"small"},title:`${r.title}(${r.name})`,tabList:Ch,tabBarExtraContent:v(bh,{}),className:xo.card,activeTabKey:e.activeTabKey,onTabChange:u=>t({activeTabKey:u}),children:c(e.activeTabKey)})})]})},xo={wrapper:ae({name:"13udsys",styles:"height:100%"}),card:ae({name:"tpenv9",styles:"height:100%;display:flex;flex-direction:column;.ant-card-body{flex:1;padding:0;}"})};export{Dh as Entities,zh as Entity};
