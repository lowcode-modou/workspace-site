import{a as jsx,r as react,aO as Recoil_index_7,a1 as commonjsGlobal,aW as Recoil_index,B as react$1,aQ as Recoil_index_8,aP as Recoil_index_1,aR as Recoil_index_10,ay as Recoil_index_23,aA as Recoil_index_19,aX as Recoil_index_30,aY as Recoil_index_21,j as jsxs,m as mcss,aa as Spin,F as Fragment,aZ as Recoil_index_4,az as useParams,u as useNavigate,aB as ROUTER_PATH}from"./index.23f917a1.js";import{S as Select,I as Input,K as Switch,H as InputNumber,B as Button,G as Form,Q as produce,X as lodash,a1 as AppFactoryContext,V as K,a2 as SETTER_KEY,M as Divider,a3 as getWidgetGroupLabel,a4 as WidgetGroupEnum,Y as WidgetMetadata,_ as generateId,O as FullscreenOutlined,T as Tree,D as DownOutlined,R as AppFactory,Z as buttonWidgetMetadata,a0 as rowWidgetMetadata,$ as colWidgetMetadata,a5 as inputWidgetMetadata,a6 as SetterTypeEnum,P as Metadata,U as generateRouterPath}from"./router.badd379d.js";import{T as Typography}from"./index.af0b7120.js";import{C as Card}from"./index.7633c1fb.js";import{R as Row,C as Col,T as Tabs}from"./row.e58c8179.js";import{D as isEqual_1}from"./EditOutlined.5d55f56a.js";const SelectSetter=({value:t,onChange:e,options:r})=>jsx(Select,{mode:r==null?void 0:r.mode,value:t,onChange:n=>e(n),children:r==null?void 0:r.options.map(n=>jsx(Select.Option,{value:n.value,children:n.label},n.value))}),StringSetter=({value:t,onChange:e})=>jsx(Input,{value:t,onChange:r=>e(r.target.value)}),BooleanSetter=({value:t,onChange:e})=>jsx(Switch,{checked:t,onChange:e}),NumberSetter=({value:t,onChange:e})=>jsx(InputNumber,{value:t,onChange:r=>e(r)}),ButtonWidget=({block:t,danger:e,disabled:r,ghost:n,loading:o,shape:i,size:s,type:c,title:u,instance:l})=>(react.exports.useEffect(()=>{console.log("\u6211\u662F\u6309\u94AE \u6211\u91CD\u65B0\u6E32\u67D3\u4E86",t)}),jsx(Button,{"data-widget-id":l.widgetId,block:t,danger:e,disabled:r,ghost:n,loading:o,shape:i,size:s,type:c,children:u})),RowWidget=({align:t,justify:e,wrap:r,instance:n,renderSlots:o,renderSlotNames:i})=>(react.exports.useEffect(()=>{console.log("\u6211\u662FRow \u6211\u91CD\u65B0\u6E32\u67D3\u4E86",n.widgetId)}),jsx(Row,{"data-widget-id":n.widgetId,"data-widget-slot-name":i.children,align:t,justify:e,wrap:r,children:o.children})),ColWidget=({span:t,instance:e,renderSlots:r,renderSlotNames:n,widgetName:o})=>(react.exports.useEffect(()=>{console.log("\u6211\u662FCol \u6211\u91CD\u65B0\u6E32\u67D3\u4E86",o)}),jsx(Col,{"data-widget-id":e.widgetId,"data-widget-slot-name":n.children,span:t,children:r.children})),InputWidget=({defaultValue:t,label:e,instance:r})=>(react.exports.useEffect(()=>{console.log("\u6211\u662FInput \u6211\u91CD\u65B0\u6E32\u67D3\u4E86")}),react.exports.useEffect(()=>{var o;const n=document.querySelector(`[data-hack-widget-id=${r.widgetId}]`);(o=n==null?void 0:n.parentElement)==null||o.setAttribute("data-widget-id",r.widgetId)},[r.widgetId]),jsx(Form.Item,{"data-hack-widget-id":r.widgetId,label:e,children:jsx(Input,{defaultValue:t})})),name$1="@modou/canvas-designer",generateRecoilKey$1=t=>`@${name$1}/${t}`,getWidgetIdFromElement=t=>{var e,r;return(r=(e=t==null?void 0:t.dataset)==null?void 0:e.widgetId)!=null?r:""},getWidgetSlotNameFromElement=t=>{var e,r;return(r=(e=t==null?void 0:t.dataset)==null?void 0:e.widgetSlotName)!=null?r:""},getElementFromWidgetId=t=>document.querySelector(`[data-widget-id=${t}]`),getRawElement=(t,e)=>!t||t===e?null:getWidgetIdFromElement(t)?t:getRawElement(t.parentElement,e);var DropIndicatorPositionEnum=(t=>(t[t.Top=0]="Top",t[t.Right=1]="Right",t[t.Bottom=2]="Bottom",t[t.Left=3]="Left",t))(DropIndicatorPositionEnum||{}),DropIndicatorInsertPositionEnum=(t=>(t[t.Before=0]="Before",t[t.After=1]="After",t[t.Inner=2]="Inner",t))(DropIndicatorInsertPositionEnum||{});const dropIndicatorAtom=Recoil_index_7({key:generateRecoilKey$1("dropIndicatorAtom"),default:{position:3,insertPosition:2,show:!1}});var transit={exports:{}},COMPILED=!0,goog=goog||{};goog.global=commonjsGlobal||self;goog.exportPath_=function(t,e,r,n){t=t.split("."),n=n||goog.global,t[0]in n||typeof n.execScript>"u"||n.execScript("var "+t[0]);for(var o;t.length&&(o=t.shift());)if(t.length||e===void 0)n=n[o]&&n[o]!==Object.prototype[o]?n[o]:n[o]={};else if(!r&&goog.isObject(e)&&goog.isObject(n[o]))for(var i in e)e.hasOwnProperty(i)&&(n[o][i]=e[i]);else n[o]=e};goog.define=function(t,e){return e};goog.FEATURESET_YEAR=2012;goog.DEBUG=!0;goog.LOCALE="en";goog.TRUSTED_SITE=!0;goog.DISALLOW_TEST_ONLY_CODE=!goog.DEBUG;goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1;goog.provide=function(t){if(goog.isInModuleLoader_())throw Error("goog.provide cannot be used within a module.");goog.constructNamespace_(t)};goog.constructNamespace_=function(t,e,r){goog.exportPath_(t,e,r)};goog.getScriptNonce=function(t){return t&&t!=goog.global?goog.getScriptNonce_(t.document):(goog.cspNonce_===null&&(goog.cspNonce_=goog.getScriptNonce_(goog.global.document)),goog.cspNonce_)};goog.NONCE_PATTERN_=/^[\w+/_-]+[=]{0,2}$/;goog.cspNonce_=null;goog.getScriptNonce_=function(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&goog.NONCE_PATTERN_.test(t)?t:""};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;goog.module=function(t){if(typeof t!="string"||!t||t.search(goog.VALID_MODULE_RE_)==-1)throw Error("Invalid module identifier");if(!goog.isInGoogModuleLoader_())throw Error("Module "+t+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");goog.moduleLoaderState_.moduleName=t};goog.module.get=function(t){return goog.module.getInternal_(t)};goog.module.getInternal_=function(t){return null};goog.ModuleType={ES6:"es6",GOOG:"goog"};goog.moduleLoaderState_=null;goog.isInModuleLoader_=function(){return goog.isInGoogModuleLoader_()||goog.isInEs6ModuleLoader_()};goog.isInGoogModuleLoader_=function(){return!!goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.GOOG};goog.isInEs6ModuleLoader_=function(){if(goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.ES6)return!0;var t=goog.global.$jscomp;return t?typeof t.getCurrentModulePath!="function"?!1:!!t.getCurrentModulePath():!1};goog.module.declareLegacyNamespace=function(){goog.moduleLoaderState_.declareLegacyNamespace=!0};goog.declareModuleId=function(t){if(goog.moduleLoaderState_)goog.moduleLoaderState_.moduleName=t;else{var e=goog.global.$jscomp;if(!e||typeof e.getCurrentModulePath!="function")throw Error('Module with namespace "'+t+'" has been loaded incorrectly.');e=e.require(e.getCurrentModulePath()),goog.loadedModules_[t]={exports:e,type:goog.ModuleType.ES6,moduleId:t}}};goog.setTestOnly=function(t){if(goog.DISALLOW_TEST_ONLY_CODE)throw t=t||"",Error("Importing test-only code into non-debug environment"+(t?": "+t:"."))};goog.forwardDeclare=function(t){};goog.getObjectByName=function(t,e){t=t.split("."),e=e||goog.global;for(var r=0;r<t.length;r++)if(e=e[t[r]],e==null)return null;return e};goog.addDependency=function(t,e,r,n){};goog.ENABLE_DEBUG_LOADER=!0;goog.logToConsole_=function(t){goog.global.console&&goog.global.console.error(t)};goog.require=function(t){};goog.requireType=function(t){return{}};goog.basePath="";goog.nullFunction=function(){};goog.abstractMethod=function(){throw Error("unimplemented abstract method")};goog.addSingletonGetter=function(t){t.instance_=void 0,t.getInstance=function(){return t.instance_?t.instance_:(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=t),t.instance_=new t)}};goog.instantiatedSingletons_=[];goog.LOAD_MODULE_USING_EVAL=!0;goog.SEAL_MODULE_EXPORTS=goog.DEBUG;goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED;goog.TRANSPILE="detect";goog.ASSUME_ES_MODULES_TRANSPILED=!1;goog.TRANSPILE_TO_LANGUAGE="";goog.TRANSPILER="transpile.js";goog.TRUSTED_TYPES_POLICY_NAME="goog";goog.hasBadLetScoping=null;goog.loadModule=function(t){var e=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:"",declareLegacyNamespace:!1,type:goog.ModuleType.GOOG};var r={},n=r;if(typeof t=="function")n=t.call(void 0,n);else if(typeof t=="string")n=goog.loadModuleFromSource_.call(void 0,n,t);else throw Error("Invalid module definition");var o=goog.moduleLoaderState_.moduleName;if(typeof o=="string"&&o)goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(o,n,r!==n):goog.SEAL_MODULE_EXPORTS&&Object.seal&&typeof n=="object"&&n!=null&&Object.seal(n),goog.loadedModules_[o]={exports:n,type:goog.ModuleType.GOOG,moduleId:goog.moduleLoaderState_.moduleName};else throw Error('Invalid module name "'+o+'"')}finally{goog.moduleLoaderState_=e}};goog.loadModuleFromSource_=function(a,b){return eval(goog.CLOSURE_EVAL_PREFILTER_.createScript(b)),a};goog.normalizePath_=function(t){t=t.split("/");for(var e=0;e<t.length;)t[e]=="."?t.splice(e,1):e&&t[e]==".."&&t[e-1]&&t[e-1]!=".."?t.splice(--e,2):e++;return t.join("/")};goog.loadFileSync_=function(t){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(t);try{var e=new goog.global.XMLHttpRequest;return e.open("get",t,!1),e.send(),e.status==0||e.status==200?e.responseText:null}catch{return null}};goog.transpile_=function(t,e,r){var n=goog.global.$jscomp;n||(goog.global.$jscomp=n={});var o=n.transpile;if(!o){var i=goog.basePath+goog.TRANSPILER,s=goog.loadFileSync_(i);if(s){if(function(){(0,eval)(s+`
//# sourceURL=`+i)}.call(goog.global),goog.global.$gwtExport&&goog.global.$gwtExport.$jscomp&&!goog.global.$gwtExport.$jscomp.transpile)throw Error('The transpiler did not properly export the "transpile" method. $gwtExport: '+JSON.stringify(goog.global.$gwtExport));goog.global.$jscomp.transpile=goog.global.$gwtExport.$jscomp.transpile,n=goog.global.$jscomp,o=n.transpile}}return o||(o=n.transpile=function(c,u){return goog.logToConsole_(u+" requires transpilation but no transpiler was found."),c}),o(t,e,r)};goog.typeOf=function(t){var e=typeof t;return e!="object"?e:t?Array.isArray(t)?"array":e:"null"};goog.isArrayLike=function(t){var e=goog.typeOf(t);return e=="array"||e=="object"&&typeof t.length=="number"};goog.isDateLike=function(t){return goog.isObject(t)&&typeof t.getFullYear=="function"};goog.isObject=function(t){var e=typeof t;return e=="object"&&t!=null||e=="function"};goog.getUid=function(t){return Object.prototype.hasOwnProperty.call(t,goog.UID_PROPERTY_)&&t[goog.UID_PROPERTY_]||(t[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(t){return!!t[goog.UID_PROPERTY_]};goog.removeUid=function(t){t!==null&&"removeAttribute"in t&&t.removeAttribute(goog.UID_PROPERTY_);try{delete t[goog.UID_PROPERTY_]}catch{}};goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0);goog.uidCounter_=0;goog.cloneObject=function(t){var e=goog.typeOf(t);if(e=="object"||e=="array"){if(typeof t.clone=="function")return t.clone();e=e=="array"?[]:{};for(var r in t)e[r]=goog.cloneObject(t[r]);return e}return t};goog.bindNative_=function(t,e,r){return t.call.apply(t.bind,arguments)};goog.bindJs_=function(t,e,r){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var o=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(o,n),t.apply(e,o)}}return function(){return t.apply(e,arguments)}};goog.bind=function(t,e,r){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_,goog.bind.apply(null,arguments)};goog.partial=function(t,e){var r=Array.prototype.slice.call(arguments,1);return function(){var n=r.slice();return n.push.apply(n,arguments),t.apply(this,n)}};goog.mixin=function(t,e){for(var r in e)t[r]=e[r]};goog.now=function(){return Date.now()};goog.globalEval=function(t){(0,eval)(t)};goog.getCssName=function(t,e){if(String(t).charAt(0)==".")throw Error('className passed in goog.getCssName must not start with ".". You passed: '+t);var r=function(o){return goog.cssNameMapping_[o]||o},n=function(o){o=o.split("-");for(var i=[],s=0;s<o.length;s++)i.push(r(o[s]));return i.join("-")};return n=goog.cssNameMapping_?goog.cssNameMappingStyle_=="BY_WHOLE"?r:n:function(o){return o},t=e?t+"-"+n(e):n(t),goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(t):t};goog.setCssNameMapping=function(t,e){goog.cssNameMapping_=t,goog.cssNameMappingStyle_=e};goog.getMsg=function(t,e,r){return r&&r.html&&(t=t.replace(/</g,"&lt;")),r&&r.unescapeHtmlEntities&&(t=t.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&amp;/g,"&")),e&&(t=t.replace(/\{\$([^}]+)}/g,function(n,o){return e!=null&&o in e?e[o]:n})),t};goog.getMsgWithFallback=function(t,e){return t};goog.exportSymbol=function(t,e,r){goog.exportPath_(t,e,!0,r)};goog.exportProperty=function(t,e,r){t[e]=r};goog.inherits=function(t,e){function r(){}r.prototype=e.prototype,t.superClass_=e.prototype,t.prototype=new r,t.prototype.constructor=t,t.base=function(n,o,i){for(var s=Array(arguments.length-2),c=2;c<arguments.length;c++)s[c-2]=arguments[c];return e.prototype[o].apply(n,s)}};goog.scope=function(t){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a module.");t.call(goog.global)};goog.defineClass=function(t,e){var r=e.constructor,n=e.statics;return r&&r!=Object.prototype.constructor||(r=function(){throw Error("cannot instantiate an interface (no constructor defined).")}),r=goog.defineClass.createSealingConstructor_(r,t),t&&goog.inherits(r,t),delete e.constructor,delete e.statics,goog.defineClass.applyProperties_(r.prototype,e),n!=null&&(n instanceof Function?n(r):goog.defineClass.applyProperties_(r,n)),r};goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG;goog.defineClass.createSealingConstructor_=function(t,e){return goog.defineClass.SEAL_CLASS_INSTANCES?function(){var r=t.apply(this,arguments)||this;return r[goog.UID_PROPERTY_]=r[goog.UID_PROPERTY_],r}:t};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");goog.defineClass.applyProperties_=function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);for(var n=0;n<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;n++)r=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[n],Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])};goog.identity_=function(t){return t};goog.createTrustedTypesPolicy=function(t){var e=null,r=goog.global.trustedTypes;if(!r||!r.createPolicy)return e;try{e=r.createPolicy(t,{createHTML:goog.identity_,createScript:goog.identity_,createScriptURL:goog.identity_})}catch(n){goog.logToConsole_(n.message)}return e};goog.object={};goog.object.forEach=function(t,e,r){for(const n in t)e.call(r,t[n],n,t)};goog.object.filter=function(t,e,r){const n={};for(const o in t)e.call(r,t[o],o,t)&&(n[o]=t[o]);return n};goog.object.map=function(t,e,r){const n={};for(const o in t)n[o]=e.call(r,t[o],o,t);return n};goog.object.some=function(t,e,r){for(const n in t)if(e.call(r,t[n],n,t))return!0;return!1};goog.object.every=function(t,e,r){for(const n in t)if(!e.call(r,t[n],n,t))return!1;return!0};goog.object.getCount=function(t){let e=0;for(const r in t)e++;return e};goog.object.getAnyKey=function(t){for(const e in t)return e};goog.object.getAnyValue=function(t){for(const e in t)return t[e]};goog.object.contains=function(t,e){return goog.object.containsValue(t,e)};goog.object.getValues=function(t){const e=[];let r=0;for(const n in t)e[r++]=t[n];return e};goog.object.getKeys=function(t){const e=[];let r=0;for(const n in t)e[r++]=n;return e};goog.object.getValueByKeys=function(t,e){var r=goog.isArrayLike(e);const n=r?e:arguments;for(r=r?0:1;r<n.length;r++){if(t==null)return;t=t[n[r]]}return t};goog.object.containsKey=function(t,e){return t!==null&&e in t};goog.object.containsValue=function(t,e){for(const r in t)if(t[r]==e)return!0;return!1};goog.object.findKey=function(t,e,r){for(const n in t)if(e.call(r,t[n],n,t))return n};goog.object.findValue=function(t,e,r){return(e=goog.object.findKey(t,e,r))&&t[e]};goog.object.isEmpty=function(t){for(const e in t)return!1;return!0};goog.object.clear=function(t){for(const e in t)delete t[e]};goog.object.remove=function(t,e){let r;return(r=e in t)&&delete t[e],r};goog.object.add=function(t,e,r){if(t!==null&&e in t)throw Error('The object already contains the key "'+e+'"');goog.object.set(t,e,r)};goog.object.get=function(t,e,r){return t!==null&&e in t?t[e]:r};goog.object.set=function(t,e,r){t[e]=r};goog.object.setIfUndefined=function(t,e,r){return e in t?t[e]:t[e]=r};goog.object.setWithReturnValueIfNotSet=function(t,e,r){return e in t?t[e]:(r=r(),t[e]=r)};goog.object.equals=function(t,e){for(const r in t)if(!(r in e)||t[r]!==e[r])return!1;for(const r in e)if(!(r in t))return!1;return!0};goog.object.clone=function(t){const e={};for(const r in t)e[r]=t[r];return e};goog.object.unsafeClone=function(t){if(!t||typeof t!="object")return t;if(typeof t.clone=="function")return t.clone();const e=Array.isArray(t)?[]:typeof ArrayBuffer!="function"||typeof ArrayBuffer.isView!="function"||!ArrayBuffer.isView(t)||t instanceof DataView?{}:new t.constructor(t.length);for(const r in t)e[r]=goog.object.unsafeClone(t[r]);return e};goog.object.transpose=function(t){const e={};for(const r in t)e[t[r]]=r;return e};goog.object.PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");goog.object.extend=function(t,e){let r,n;for(let o=1;o<arguments.length;o++){n=arguments[o];for(r in n)t[r]=n[r];for(let i=0;i<goog.object.PROTOTYPE_FIELDS_.length;i++)r=goog.object.PROTOTYPE_FIELDS_[i],Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}};goog.object.create=function(t){const e=arguments.length;if(e==1&&Array.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(e%2)throw Error("Uneven number of arguments");const r={};for(let n=0;n<e;n+=2)r[arguments[n]]=arguments[n+1];return r};goog.object.createSet=function(t){const e=arguments.length;if(e==1&&Array.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);const r={};for(let n=0;n<e;n++)r[arguments[n]]=!0;return r};goog.object.createImmutableView=function(t){let e=t;return Object.isFrozen&&!Object.isFrozen(t)&&(e=Object.create(t),Object.freeze(e)),e};goog.object.isImmutableView=function(t){return!!Object.isFrozen&&Object.isFrozen(t)};goog.object.getAllPropertyNames=function(t,e,r){if(!t)return[];if(!Object.getOwnPropertyNames||!Object.getPrototypeOf)return goog.object.getKeys(t);const n={};for(;t&&(t!==Object.prototype||e)&&(t!==Function.prototype||r);){const o=Object.getOwnPropertyNames(t);for(let i=0;i<o.length;i++)n[o[i]]=!0;t=Object.getPrototypeOf(t)}return goog.object.getKeys(n)};goog.object.getSuperClass=function(t){return(t=Object.getPrototypeOf(t.prototype))&&t.constructor};var com={cognitect:{}};com.cognitect.transit={};com.cognitect.transit.util={};com.cognitect.transit.util.objectKeys=typeof Object.keys<"u"?function(t){return Object.keys(t)}:function(t){return goog.object.getKeys(t)};com.cognitect.transit.util.isArray=typeof Array.isArray<"u"?function(t){return Array.isArray(t)}:function(t){return goog.typeOf(t)==="array"};com.cognitect.transit.util.chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";com.cognitect.transit.util.randInt=function(t){return Math.round(Math.random()*t)};com.cognitect.transit.util.randHex=function(){return com.cognitect.transit.util.randInt(15).toString(16)};com.cognitect.transit.util.randomUUID=function(){var t=(8|3&com.cognitect.transit.util.randInt(14)).toString(16);return com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+"-"+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+"-4"+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+"-"+t+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+"-"+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()+com.cognitect.transit.util.randHex()};com.cognitect.transit.util.btoa=function(t){if(typeof btoa<"u")return btoa(t);t=String(t);for(var e,r,n=0,o=com.cognitect.transit.util.chars,i="";t.charAt(n|0)||(o="=",n%1);i+=o.charAt(63&e>>8-n%1*8)){if(r=t.charCodeAt(n+=.75),255<r)throw Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");e=e<<8|r}return i};com.cognitect.transit.util.atob=function(t){if(typeof atob<"u")return atob(t);if(t=String(t).replace(/=+$/,""),t.length%4==1)throw Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var e=0,r,n,o=0,i="";n=t.charAt(o++);~n&&(r=e%4?64*r+n:n,e++%4)?i+=String.fromCharCode(255&r>>(-2*e&6)):0)n=com.cognitect.transit.util.chars.indexOf(n);return i};com.cognitect.transit.util.Uint8ToBase64=function(t){for(var e=0,r=t.length,n="",o;e<r;)o=t.subarray(e,Math.min(e+32768,r)),n+=String.fromCharCode.apply(null,o),e+=32768;return com.cognitect.transit.util.btoa(n)};com.cognitect.transit.util.Base64ToUint8=function(t){t=com.cognitect.transit.util.atob(t);for(var e=t.length,r=new Uint8Array(e),n=0;n<e;n++){var o=t.charCodeAt(n);r[n]=o}return r};com.cognitect.transit.delimiters={};com.cognitect.transit.delimiters.ESC="~";com.cognitect.transit.delimiters.TAG="#";com.cognitect.transit.delimiters.SUB="^";com.cognitect.transit.delimiters.RES="`";com.cognitect.transit.delimiters.ESC_TAG="~#";com.cognitect.transit.caching={};com.cognitect.transit.caching.MIN_SIZE_CACHEABLE=3;com.cognitect.transit.caching.BASE_CHAR_IDX=48;com.cognitect.transit.caching.CACHE_CODE_DIGITS=44;com.cognitect.transit.caching.MAX_CACHE_ENTRIES=com.cognitect.transit.caching.CACHE_CODE_DIGITS*com.cognitect.transit.caching.CACHE_CODE_DIGITS;com.cognitect.transit.caching.MAX_CACHE_SIZE=4096;com.cognitect.transit.caching.isCacheable=function(t,e){return t.length>com.cognitect.transit.caching.MIN_SIZE_CACHEABLE?e?!0:(e=t.charAt(0),t=t.charAt(1),e===com.cognitect.transit.delimiters.ESC?t===":"||t==="$"||t==="#":!1):!1};com.cognitect.transit.caching.idxToCode=function(t){var e=Math.floor(t/com.cognitect.transit.caching.CACHE_CODE_DIGITS);return t=String.fromCharCode(t%com.cognitect.transit.caching.CACHE_CODE_DIGITS+com.cognitect.transit.caching.BASE_CHAR_IDX),e===0?com.cognitect.transit.delimiters.SUB+t:com.cognitect.transit.delimiters.SUB+String.fromCharCode(e+com.cognitect.transit.caching.BASE_CHAR_IDX)+t};com.cognitect.transit.caching.WriteCache=function(){this.cacheSize=this.gen=this.idx=0,this.cache={}};com.cognitect.transit.caching.WriteCache.prototype.write=function(t,e){return com.cognitect.transit.caching.isCacheable(t,e)?(this.cacheSize===com.cognitect.transit.caching.MAX_CACHE_SIZE?(this.clear(),this.gen=0,this.cache={}):this.idx===com.cognitect.transit.caching.MAX_CACHE_ENTRIES&&this.clear(),e=this.cache[t],e==null?(this.cache[t]=[com.cognitect.transit.caching.idxToCode(this.idx),this.gen],this.idx++,t):e[1]!=this.gen?(e[1]=this.gen,e[0]=com.cognitect.transit.caching.idxToCode(this.idx),this.idx++,t):e[0]):t};com.cognitect.transit.caching.WriteCache.prototype.clear=function(){this.idx=0,this.gen++};com.cognitect.transit.caching.writeCache=function(){return new com.cognitect.transit.caching.WriteCache};com.cognitect.transit.caching.isCacheCode=function(t){return t.charAt(0)===com.cognitect.transit.delimiters.SUB&&t.charAt(1)!==" "};com.cognitect.transit.caching.codeToIdx=function(t){if(t.length===2)return t.charCodeAt(1)-com.cognitect.transit.caching.BASE_CHAR_IDX;var e=(t.charCodeAt(1)-com.cognitect.transit.caching.BASE_CHAR_IDX)*com.cognitect.transit.caching.CACHE_CODE_DIGITS;return t=t.charCodeAt(2)-com.cognitect.transit.caching.BASE_CHAR_IDX,e+t};com.cognitect.transit.caching.ReadCache=function(){this.idx=0,this.cache=[]};com.cognitect.transit.caching.ReadCache.prototype.write=function(t,e){return this.idx==com.cognitect.transit.caching.MAX_CACHE_ENTRIES&&(this.idx=0),this.cache[this.idx]=t,this.idx++,t};com.cognitect.transit.caching.ReadCache.prototype.read=function(t,e){return this.cache[com.cognitect.transit.caching.codeToIdx(t)]};com.cognitect.transit.caching.ReadCache.prototype.clear=function(){this.idx=0};com.cognitect.transit.caching.readCache=function(){return new com.cognitect.transit.caching.ReadCache};com.cognitect.transit.eq={};com.cognitect.transit.eq.hashCodeProperty="transit$hashCode$";com.cognitect.transit.eq.hashCodeCounter=1;com.cognitect.transit.eq.equals=function(t,e){if(t==null)return e==null;if(t===e)return!0;if(typeof t=="object"){if(com.cognitect.transit.util.isArray(t)){if(com.cognitect.transit.util.isArray(e)&&t.length===e.length){for(var r=0;r<t.length;r++)if(!com.cognitect.transit.eq.equals(t[r],e[r]))return!1;return!0}return!1}if(t.com$cognitect$transit$equals)return t.com$cognitect$transit$equals(e);if(e!=null&&typeof e=="object"){if(e.com$cognitect$transit$equals)return e.com$cognitect$transit$equals(t);r=0;var n=com.cognitect.transit.util.objectKeys(e).length,o;for(o in t)if(t.hasOwnProperty(o)&&(r++,!e.hasOwnProperty(o)||!com.cognitect.transit.eq.equals(t[o],e[o])))return!1;return r===n}}return!1};com.cognitect.transit.eq.hashCombine=function(t,e){return t^e+2654435769+(t<<6)+(t>>2)};com.cognitect.transit.eq.stringCodeCache={};com.cognitect.transit.eq.stringCodeCacheSize=0;com.cognitect.transit.eq.STR_CACHE_MAX=256;com.cognitect.transit.eq.hashString=function(t){var e=com.cognitect.transit.eq.stringCodeCache[t];if(e!=null)return e;for(var r=e=0;r<t.length;++r)e=31*e+t.charCodeAt(r),e%=4294967296;return com.cognitect.transit.eq.stringCodeCacheSize++,com.cognitect.transit.eq.stringCodeCacheSize>=com.cognitect.transit.eq.STR_CACHE_MAX&&(com.cognitect.transit.eq.stringCodeCache={},com.cognitect.transit.eq.stringCodeCacheSize=1),com.cognitect.transit.eq.stringCodeCache[t]=e};com.cognitect.transit.eq.hashMapLike=function(t){var e=0;if(t.forEach!=null)t.forEach(function(s,c,u){e=(e+(com.cognitect.transit.eq.hashCode(c)^com.cognitect.transit.eq.hashCode(s)))%4503599627370496});else for(var r=com.cognitect.transit.util.objectKeys(t),n=0;n<r.length;n++){var o=r[n],i=t[o];e=(e+(com.cognitect.transit.eq.hashCode(o)^com.cognitect.transit.eq.hashCode(i)))%4503599627370496}return e};com.cognitect.transit.eq.hashArrayLike=function(t){var e=0;if(com.cognitect.transit.util.isArray(t))for(var r=0;r<t.length;r++)e=com.cognitect.transit.eq.hashCombine(e,com.cognitect.transit.eq.hashCode(t[r]));else t.forEach&&t.forEach(function(n,o){e=com.cognitect.transit.eq.hashCombine(e,com.cognitect.transit.eq.hashCode(n))});return e};com.cognitect.transit.eq.hashCode=function(t){if(t==null)return 0;switch(typeof t){case"number":return t;case"boolean":return t===!0?1:0;case"string":return com.cognitect.transit.eq.hashString(t);case"function":var e=t[com.cognitect.transit.eq.hashCodeProperty];return e||(e=com.cognitect.transit.eq.hashCodeCounter,typeof Object.defineProperty<"u"?Object.defineProperty(t,com.cognitect.transit.eq.hashCodeProperty,{value:e,enumerable:!1}):t[com.cognitect.transit.eq.hashCodeProperty]=e,com.cognitect.transit.eq.hashCodeCounter++),e;default:return t instanceof Date?t.valueOf():com.cognitect.transit.util.isArray(t)?com.cognitect.transit.eq.hashArrayLike(t):t.com$cognitect$transit$hashCode?t.com$cognitect$transit$hashCode():com.cognitect.transit.eq.hashMapLike(t)}};com.cognitect.transit.eq.extendToEQ=function(t,e){return t.com$cognitect$transit$hashCode=e.hashCode,t.com$cognitect$transit$equals=e.equals,t};goog.debug={};function module$contents$goog$debug$Error_DebugError(t,e){if(Error.captureStackTrace)Error.captureStackTrace(this,module$contents$goog$debug$Error_DebugError);else{const r=Error().stack;r&&(this.stack=r)}t&&(this.message=String(t)),e&&(this.cause=e),this.reportErrorToServer=!0}goog.inherits(module$contents$goog$debug$Error_DebugError,Error);module$contents$goog$debug$Error_DebugError.prototype.name="CustomError";goog.debug.Error=module$contents$goog$debug$Error_DebugError;goog.dom={};goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12};goog.asserts={};goog.asserts.ENABLE_ASSERTS=goog.DEBUG;goog.asserts.AssertionError=function(t,e){module$contents$goog$debug$Error_DebugError.call(this,goog.asserts.subs_(t,e)),this.messagePattern=t};goog.inherits(goog.asserts.AssertionError,module$contents$goog$debug$Error_DebugError);goog.asserts.AssertionError.prototype.name="AssertionError";goog.asserts.DEFAULT_ERROR_HANDLER=function(t){throw t};goog.asserts.errorHandler_=goog.asserts.DEFAULT_ERROR_HANDLER;goog.asserts.subs_=function(t,e){t=t.split("%s");for(var r="",n=t.length-1,o=0;o<n;o++)r+=t[o]+(o<e.length?e[o]:"%s");return r+t[n]};goog.asserts.doAssertFailure_=function(t,e,r,n){var o="Assertion failed";if(r){o+=": "+r;var i=n}else t&&(o+=": "+t,i=e);t=new goog.asserts.AssertionError(""+o,i||[]),goog.asserts.errorHandler_(t)};goog.asserts.setErrorHandler=function(t){goog.asserts.ENABLE_ASSERTS&&(goog.asserts.errorHandler_=t)};goog.asserts.assert=function(t,e,r){return goog.asserts.ENABLE_ASSERTS&&!t&&goog.asserts.doAssertFailure_("",null,e,Array.prototype.slice.call(arguments,2)),t};goog.asserts.assertExists=function(t,e,r){return goog.asserts.ENABLE_ASSERTS&&t==null&&goog.asserts.doAssertFailure_("Expected to exist: %s.",[t],e,Array.prototype.slice.call(arguments,2)),t};goog.asserts.fail=function(t,e){goog.asserts.ENABLE_ASSERTS&&goog.asserts.errorHandler_(new goog.asserts.AssertionError("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1)))};goog.asserts.assertNumber=function(t,e,r){return goog.asserts.ENABLE_ASSERTS&&typeof t!="number"&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2)),t};goog.asserts.assertString=function(t,e,r){return goog.asserts.ENABLE_ASSERTS&&typeof t!="string"&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2)),t};goog.asserts.assertFunction=function(t,e,r){return goog.asserts.ENABLE_ASSERTS&&typeof t!="function"&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2)),t};goog.asserts.assertObject=function(t,e,r){return goog.asserts.ENABLE_ASSERTS&&!goog.isObject(t)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2)),t};goog.asserts.assertArray=function(t,e,r){return goog.asserts.ENABLE_ASSERTS&&!Array.isArray(t)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2)),t};goog.asserts.assertBoolean=function(t,e,r){return goog.asserts.ENABLE_ASSERTS&&typeof t!="boolean"&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2)),t};goog.asserts.assertElement=function(t,e,r){return!goog.asserts.ENABLE_ASSERTS||goog.isObject(t)&&t.nodeType==goog.dom.NodeType.ELEMENT||goog.asserts.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2)),t};goog.asserts.assertInstanceof=function(t,e,r,n){return!goog.asserts.ENABLE_ASSERTS||t instanceof e||goog.asserts.doAssertFailure_("Expected instanceof %s but got %s.",[goog.asserts.getType_(e),goog.asserts.getType_(t)],r,Array.prototype.slice.call(arguments,3)),t};goog.asserts.assertFinite=function(t,e,r){return!goog.asserts.ENABLE_ASSERTS||typeof t=="number"&&isFinite(t)||goog.asserts.doAssertFailure_("Expected %s to be a finite number but it is not.",[t],e,Array.prototype.slice.call(arguments,2)),t};goog.asserts.getType_=function(t){return t instanceof Function?t.displayName||t.name||"unknown type name":t instanceof Object?t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t):t===null?"null":typeof t};goog.reflect={};goog.reflect.object=function(t,e){return e};goog.reflect.objectProperty=function(t,e){return t};goog.reflect.sinkValue=function(t){return goog.reflect.sinkValue[" "](t),t};goog.reflect.sinkValue[" "]=goog.nullFunction;goog.reflect.canAccessProperty=function(t,e){try{return goog.reflect.sinkValue(t[e]),!0}catch{}return!1};goog.reflect.cache=function(t,e,r,n){return n=n?n(e):e,Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=r(e)};goog.math={};class module$contents$goog$math$Long_Long{constructor(e,r){this.low_=e|0,this.high_=r|0}toInt(){return this.low_}toNumber(){return this.high_*module$contents$goog$math$Long_TWO_PWR_32_DBL_+this.getLowBitsUnsigned()}isSafeInteger(){var e=this.high_>>21;return e==0||e==-1&&!(this.low_==0&&this.high_==-2097152)}toString(e){if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(this.isSafeInteger()){var r=this.toNumber();return e==10?""+r:r.toString(e)}r=14-(e>>2);var n=Math.pow(e,r),o=module$contents$goog$math$Long_Long.fromBits(n,n/module$contents$goog$math$Long_TWO_PWR_32_DBL_);n=this.div(o),o=Math.abs(this.subtract(n.multiply(o)).toNumber());var i=e==10?""+o:o.toString(e);return i.length<r&&(i="0000000000000".substr(i.length-r)+i),o=n.toNumber(),(e==10?o:o.toString(e))+i}getHighBits(){return this.high_}getLowBits(){return this.low_}getLowBitsUnsigned(){return this.low_>>>0}getNumBitsAbs(){if(this.isNegative())return this.equals(module$contents$goog$math$Long_Long.getMinValue())?64:this.negate().getNumBitsAbs();for(var e=this.high_!=0?this.high_:this.low_,r=31;0<r&&(e&1<<r)==0;r--);return this.high_!=0?r+33:r+1}isZero(){return this.low_==0&&this.high_==0}isNegative(){return 0>this.high_}isOdd(){return(this.low_&1)==1}equals(e){return this.low_==e.low_&&this.high_==e.high_}notEquals(e){return!this.equals(e)}lessThan(e){return 0>this.compare(e)}lessThanOrEqual(e){return 0>=this.compare(e)}greaterThan(e){return 0<this.compare(e)}greaterThanOrEqual(e){return 0<=this.compare(e)}compare(e){return this.high_==e.high_?this.low_==e.low_?0:this.getLowBitsUnsigned()>e.getLowBitsUnsigned()?1:-1:this.high_>e.high_?1:-1}negate(){var e=~this.low_+1|0;return module$contents$goog$math$Long_Long.fromBits(e,~this.high_+!e|0)}add(e){var r=this.high_>>>16,n=this.high_&65535,o=this.low_>>>16,i=e.high_>>>16,s=e.high_&65535,c=e.low_>>>16;return e=(this.low_&65535)+(e.low_&65535),c=(e>>>16)+(o+c),o=c>>>16,o+=n+s,r=(o>>>16)+(r+i)&65535,module$contents$goog$math$Long_Long.fromBits((c&65535)<<16|e&65535,r<<16|o&65535)}subtract(e){return this.add(e.negate())}multiply(e){if(this.isZero())return this;if(e.isZero())return e;var r=this.high_>>>16,n=this.high_&65535,o=this.low_>>>16,i=this.low_&65535,s=e.high_>>>16,c=e.high_&65535,u=e.low_>>>16;e=e.low_&65535;var l=i*e,d=(l>>>16)+o*e,g=d>>>16;d=(d&65535)+i*u,g+=d>>>16,g+=n*e;var p=g>>>16;return g=(g&65535)+o*u,p+=g>>>16,g=(g&65535)+i*c,p=p+(g>>>16)+(r*e+n*u+o*c+i*s)&65535,module$contents$goog$math$Long_Long.fromBits((d&65535)<<16|l&65535,p<<16|g&65535)}div(e){if(e.isZero())throw Error("division by zero");if(this.isNegative()){if(this.equals(module$contents$goog$math$Long_Long.getMinValue())){if(e.equals(module$contents$goog$math$Long_Long.getOne())||e.equals(module$contents$goog$math$Long_Long.getNegOne()))return module$contents$goog$math$Long_Long.getMinValue();if(e.equals(module$contents$goog$math$Long_Long.getMinValue()))return module$contents$goog$math$Long_Long.getOne();var r=this.shiftRight(1).div(e).shiftLeft(1);if(r.equals(module$contents$goog$math$Long_Long.getZero()))return e.isNegative()?module$contents$goog$math$Long_Long.getOne():module$contents$goog$math$Long_Long.getNegOne();var n=this.subtract(e.multiply(r));return r.add(n.div(e))}return e.isNegative()?this.negate().div(e.negate()):this.negate().div(e).negate()}if(this.isZero())return module$contents$goog$math$Long_Long.getZero();if(e.isNegative())return e.equals(module$contents$goog$math$Long_Long.getMinValue())?module$contents$goog$math$Long_Long.getZero():this.div(e.negate()).negate();var o=module$contents$goog$math$Long_Long.getZero();for(n=this;n.greaterThanOrEqual(e);){r=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));var i=Math.ceil(Math.log(r)/Math.LN2);i=48>=i?1:Math.pow(2,i-48);for(var s=module$contents$goog$math$Long_Long.fromNumber(r),c=s.multiply(e);c.isNegative()||c.greaterThan(n);)r-=i,s=module$contents$goog$math$Long_Long.fromNumber(r),c=s.multiply(e);s.isZero()&&(s=module$contents$goog$math$Long_Long.getOne()),o=o.add(s),n=n.subtract(c)}return o}modulo(e){return this.subtract(this.div(e).multiply(e))}not(){return module$contents$goog$math$Long_Long.fromBits(~this.low_,~this.high_)}and(e){return module$contents$goog$math$Long_Long.fromBits(this.low_&e.low_,this.high_&e.high_)}or(e){return module$contents$goog$math$Long_Long.fromBits(this.low_|e.low_,this.high_|e.high_)}xor(e){return module$contents$goog$math$Long_Long.fromBits(this.low_^e.low_,this.high_^e.high_)}shiftLeft(e){if(e&=63,e==0)return this;var r=this.low_;return 32>e?module$contents$goog$math$Long_Long.fromBits(r<<e,this.high_<<e|r>>>32-e):module$contents$goog$math$Long_Long.fromBits(0,r<<e-32)}shiftRight(e){if(e&=63,e==0)return this;var r=this.high_;return 32>e?module$contents$goog$math$Long_Long.fromBits(this.low_>>>e|r<<32-e,r>>e):module$contents$goog$math$Long_Long.fromBits(r>>e-32,0<=r?0:-1)}shiftRightUnsigned(e){if(e&=63,e==0)return this;var r=this.high_;return 32>e?module$contents$goog$math$Long_Long.fromBits(this.low_>>>e|r<<32-e,r>>>e):e==32?module$contents$goog$math$Long_Long.fromBits(r,0):module$contents$goog$math$Long_Long.fromBits(r>>>e-32,0)}static fromInt(e){var r=e|0;return goog.asserts.assert(e===r,"value should be a 32-bit integer"),-128<=r&&128>r?module$contents$goog$math$Long_getCachedIntValue_(r):new module$contents$goog$math$Long_Long(r,0>r?-1:0)}static fromNumber(e){return 0<e?e>=module$contents$goog$math$Long_TWO_PWR_63_DBL_?module$contents$goog$math$Long_Long.getMaxValue():new module$contents$goog$math$Long_Long(e,e/module$contents$goog$math$Long_TWO_PWR_32_DBL_):0>e?e<=-module$contents$goog$math$Long_TWO_PWR_63_DBL_?module$contents$goog$math$Long_Long.getMinValue():new module$contents$goog$math$Long_Long(-e,-e/module$contents$goog$math$Long_TWO_PWR_32_DBL_).negate():module$contents$goog$math$Long_Long.getZero()}static fromBits(e,r){return new module$contents$goog$math$Long_Long(e,r)}static fromString(e,r){if(e.charAt(0)=="-")return module$contents$goog$math$Long_Long.fromString(e.substring(1),r).negate();var n=parseInt(e,r||10);if(n<=module$contents$goog$math$Long_MAX_SAFE_INTEGER_)return new module$contents$goog$math$Long_Long(n%module$contents$goog$math$Long_TWO_PWR_32_DBL_|0,n/module$contents$goog$math$Long_TWO_PWR_32_DBL_|0);if(e.length==0)throw Error("number format error: empty string");if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character: '+e);if(r=r||10,2>r||36<r)throw Error("radix out of range: "+r);n=module$contents$goog$math$Long_Long.fromNumber(Math.pow(r,8));for(var o=module$contents$goog$math$Long_Long.getZero(),i=0;i<e.length;i+=8){var s=Math.min(8,e.length-i),c=parseInt(e.substring(i,i+s),r);8>s?(s=module$contents$goog$math$Long_Long.fromNumber(Math.pow(r,s)),o=o.multiply(s).add(module$contents$goog$math$Long_Long.fromNumber(c))):(o=o.multiply(n),o=o.add(module$contents$goog$math$Long_Long.fromNumber(c)))}return o}static isStringInRange(e,r){if(r=r||10,2>r||36<r)throw Error("radix out of range: "+r);return r=e.charAt(0)=="-"?module$contents$goog$math$Long_MIN_VALUE_FOR_RADIX_[r]:module$contents$goog$math$Long_MAX_VALUE_FOR_RADIX_[r],e.length<r.length?!0:e.length==r.length&&e<=r}static getZero(){return module$contents$goog$math$Long_ZERO_}static getOne(){return module$contents$goog$math$Long_ONE_}static getNegOne(){return module$contents$goog$math$Long_NEG_ONE_}static getMaxValue(){return module$contents$goog$math$Long_MAX_VALUE_}static getMinValue(){return module$contents$goog$math$Long_MIN_VALUE_}static getTwoPwr24(){return module$contents$goog$math$Long_TWO_PWR_24_}}goog.math.Long=module$contents$goog$math$Long_Long;const module$contents$goog$math$Long_IntCache_={};function module$contents$goog$math$Long_getCachedIntValue_(t){return goog.reflect.cache(module$contents$goog$math$Long_IntCache_,t,function(e){return new module$contents$goog$math$Long_Long(e,0>e?-1:0)})}const module$contents$goog$math$Long_MAX_VALUE_FOR_RADIX_="  111111111111111111111111111111111111111111111111111111111111111 2021110011022210012102010021220101220221 13333333333333333333333333333333 1104332401304422434310311212 1540241003031030222122211 22341010611245052052300 777777777777777777777 67404283172107811827 9223372036854775807 1728002635214590697 41a792678515120367 10b269549075433c37 4340724c6c71dc7a7 160e2ad3246366807 7fffffffffffffff 33d3d8307b214008 16agh595df825fa7 ba643dci0ffeehh 5cbfjia3fh26ja7 2heiciiie82dh97 1adaibb21dckfa7 i6k448cf4192c2 acd772jnc9l0l7 64ie1focnn5g77 3igoecjbmca687 27c48l5b37oaop 1bk39f3ah3dmq7 q1se8f0m04isb hajppbc1fc207 bm03i95hia437 7vvvvvvvvvvvv 5hg4ck9jd4u37 3tdtk1v8j6tpp 2pijmikexrxp7 1y2p0ij32e8e7".split(" "),module$contents$goog$math$Long_MIN_VALUE_FOR_RADIX_="  -1000000000000000000000000000000000000000000000000000000000000000 -2021110011022210012102010021220101220222 -20000000000000000000000000000000 -1104332401304422434310311213 -1540241003031030222122212 -22341010611245052052301 -1000000000000000000000 -67404283172107811828 -9223372036854775808 -1728002635214590698 -41a792678515120368 -10b269549075433c38 -4340724c6c71dc7a8 -160e2ad3246366808 -8000000000000000 -33d3d8307b214009 -16agh595df825fa8 -ba643dci0ffeehi -5cbfjia3fh26ja8 -2heiciiie82dh98 -1adaibb21dckfa8 -i6k448cf4192c3 -acd772jnc9l0l8 -64ie1focnn5g78 -3igoecjbmca688 -27c48l5b37oaoq -1bk39f3ah3dmq8 -q1se8f0m04isc -hajppbc1fc208 -bm03i95hia438 -8000000000000 -5hg4ck9jd4u38 -3tdtk1v8j6tpq -2pijmikexrxp8 -1y2p0ij32e8e8".split(" "),module$contents$goog$math$Long_MAX_SAFE_INTEGER_=9007199254740991,module$contents$goog$math$Long_TWO_PWR_32_DBL_=4294967296,module$contents$goog$math$Long_TWO_PWR_63_DBL_=9223372036854776e3,module$contents$goog$math$Long_ZERO_=module$contents$goog$math$Long_Long.fromBits(0,0),module$contents$goog$math$Long_ONE_=module$contents$goog$math$Long_Long.fromBits(1,0),module$contents$goog$math$Long_NEG_ONE_=module$contents$goog$math$Long_Long.fromBits(-1,-1),module$contents$goog$math$Long_MAX_VALUE_=module$contents$goog$math$Long_Long.fromBits(4294967295,2147483647),module$contents$goog$math$Long_MIN_VALUE_=module$contents$goog$math$Long_Long.fromBits(0,2147483648),module$contents$goog$math$Long_TWO_PWR_24_=module$contents$goog$math$Long_Long.fromBits(16777216,0);com.cognitect.transit.types={};com.cognitect.transit.types.ITERATOR=typeof Symbol<"u"?Symbol.iterator:"@@iterator";com.cognitect.transit.types.TaggedValue=function(t,e){this.tag=t,this.rep=e,this.hashCode=-1};com.cognitect.transit.types.TaggedValue.prototype.toString=function(){return"[TaggedValue: "+this.tag+", "+this.rep+"]"};com.cognitect.transit.types.TaggedValue.prototype.equiv=function(t){return com.cognitect.transit.eq.equals(this,t)};com.cognitect.transit.types.TaggedValue.prototype.equiv=com.cognitect.transit.types.TaggedValue.prototype.equiv;com.cognitect.transit.types.TaggedValue.prototype.com$cognitect$transit$equals=function(t){return t instanceof com.cognitect.transit.types.TaggedValue?this.tag===t.tag&&com.cognitect.transit.eq.equals(this.rep,t.rep):!1};com.cognitect.transit.types.TaggedValue.prototype.com$cognitect$transit$hashCode=function(){return this.hashCode===-1&&(this.hashCode=com.cognitect.transit.eq.hashCombine(com.cognitect.transit.eq.hashCode(this.tag),com.cognitect.transit.eq.hashCode(this.rep))),this.hashCode};com.cognitect.transit.types.taggedValue=function(t,e){return new com.cognitect.transit.types.TaggedValue(t,e)};com.cognitect.transit.types.isTaggedValue=function(t){return t instanceof com.cognitect.transit.types.TaggedValue};com.cognitect.transit.types.nullValue=function(){return null};com.cognitect.transit.types.boolValue=function(t){return t==="t"};com.cognitect.transit.types.MAX_INT=module$contents$goog$math$Long_Long.fromString("9007199254740991");com.cognitect.transit.types.MIN_INT=module$contents$goog$math$Long_Long.fromString("-9007199254740991");com.cognitect.transit.types.intValue=function(t){return typeof t=="number"||t instanceof module$contents$goog$math$Long_Long?t:(t=module$contents$goog$math$Long_Long.fromString(t,10),t.greaterThan(com.cognitect.transit.types.MAX_INT)||t.lessThan(com.cognitect.transit.types.MIN_INT)?t:t.toNumber())};module$contents$goog$math$Long_Long.prototype.equiv=function(t){return com.cognitect.transit.eq.equals(this,t)};module$contents$goog$math$Long_Long.prototype.equiv=module$contents$goog$math$Long_Long.prototype.equiv;module$contents$goog$math$Long_Long.prototype.com$cognitect$transit$equals=function(t){return t instanceof module$contents$goog$math$Long_Long&&this.equals(t)};module$contents$goog$math$Long_Long.prototype.com$cognitect$transit$hashCode=function(){return this.toInt()};com.cognitect.transit.types.isInteger=function(t){return t instanceof module$contents$goog$math$Long_Long?!0:typeof t=="number"&&!isNaN(t)&&t!==1/0&&parseFloat(t)===parseInt(t,10)};com.cognitect.transit.types.floatValue=function(t){return parseFloat(t)};com.cognitect.transit.types.bigInteger=function(t){return com.cognitect.transit.types.taggedValue("n",t)};com.cognitect.transit.types.isBigInteger=function(t){return t instanceof com.cognitect.transit.types.TaggedValue&&t.tag==="n"};com.cognitect.transit.types.bigDecimalValue=function(t){return com.cognitect.transit.types.taggedValue("f",t)};com.cognitect.transit.types.isBigDecimal=function(t){return t instanceof com.cognitect.transit.types.TaggedValue&&t.tag==="f"};com.cognitect.transit.types.charValue=function(t){return t};com.cognitect.transit.types.Keyword=function(t){this._name=t,this.hashCode=-1};com.cognitect.transit.types.Keyword.prototype.toString=function(){return":"+this._name};com.cognitect.transit.types.Keyword.prototype.namespace=function(){var t=this._name.indexOf("/");return t!=-1?this._name.substring(0,t):null};com.cognitect.transit.types.Keyword.prototype.name=function(){var t=this._name.indexOf("/");return t!=-1?this._name.substring(t+1,this._name.length):this._name};com.cognitect.transit.types.Keyword.prototype.equiv=function(t){return com.cognitect.transit.eq.equals(this,t)};com.cognitect.transit.types.Keyword.prototype.equiv=com.cognitect.transit.types.Keyword.prototype.equiv;com.cognitect.transit.types.Keyword.prototype.com$cognitect$transit$equals=function(t){return t instanceof com.cognitect.transit.types.Keyword&&this._name==t._name};com.cognitect.transit.types.Keyword.prototype.com$cognitect$transit$hashCode=function(){return this.hashCode===-1&&(this.hashCode=com.cognitect.transit.eq.hashCode(this._name)),this.hashCode};com.cognitect.transit.types.keyword=function(t){return new com.cognitect.transit.types.Keyword(t)};com.cognitect.transit.types.isKeyword=function(t){return t instanceof com.cognitect.transit.types.Keyword};com.cognitect.transit.types.Symbol=function(t){this._name=t,this.hashCode=-1};com.cognitect.transit.types.Symbol.prototype.namespace=function(){var t=this._name.indexOf("/");return t!=-1?this._name.substring(0,t):null};com.cognitect.transit.types.Symbol.prototype.name=function(){var t=this._name.indexOf("/");return t!=-1?this._name.substring(t+1,this._name.length):this._name};com.cognitect.transit.types.Symbol.prototype.toString=function(){return this._name};com.cognitect.transit.types.Symbol.prototype.equiv=function(t){return com.cognitect.transit.eq.equals(this,t)};com.cognitect.transit.types.Symbol.prototype.equiv=com.cognitect.transit.types.Symbol.prototype.equiv;com.cognitect.transit.types.Symbol.prototype.com$cognitect$transit$equals=function(t){return t instanceof com.cognitect.transit.types.Symbol&&this._name==t._name};com.cognitect.transit.types.Symbol.prototype.com$cognitect$transit$hashCode=function(){return this.hashCode===-1&&(this.hashCode=com.cognitect.transit.eq.hashCode(this._name)),this.hashCode};com.cognitect.transit.types.symbol=function(t){return new com.cognitect.transit.types.Symbol(t)};com.cognitect.transit.types.isSymbol=function(t){return t instanceof com.cognitect.transit.types.Symbol};com.cognitect.transit.types.hexFor=function(t,e,r){var n="";r=r||e+1;for(var o=8*(7-e),i=module$contents$goog$math$Long_Long.fromInt(255).shiftLeft(o);e<r;e++,o-=8,i=i.shiftRightUnsigned(8)){var s=t.and(i).shiftRightUnsigned(o).toString(16);s.length==1&&(s="0"+s),n+=s}return n};com.cognitect.transit.types.UUID=function(t,e){this.high=t,this.low=e,this.hashCode=-1};com.cognitect.transit.types.UUID.prototype.getLeastSignificantBits=function(){return this.low};com.cognitect.transit.types.UUID.prototype.getMostSignificantBits=function(){return this.high};com.cognitect.transit.types.UUID.prototype.toString=function(){var t=this.high,e=this.low,r=com.cognitect.transit.types.hexFor(t,0,4)+"-";return r+=com.cognitect.transit.types.hexFor(t,4,6)+"-",r+=com.cognitect.transit.types.hexFor(t,6,8)+"-",r+=com.cognitect.transit.types.hexFor(e,0,2)+"-",r+=com.cognitect.transit.types.hexFor(e,2,8)};com.cognitect.transit.types.UUID.prototype.equiv=function(t){return com.cognitect.transit.eq.equals(this,t)};com.cognitect.transit.types.UUID.prototype.equiv=com.cognitect.transit.types.UUID.prototype.equiv;com.cognitect.transit.types.UUID.prototype.com$cognitect$transit$equals=function(t){return t instanceof com.cognitect.transit.types.UUID&&this.high.equals(t.high)&&this.low.equals(t.low)};com.cognitect.transit.types.UUID.prototype.com$cognitect$transit$hashCode=function(){return this.hashCode===-1&&(this.hashCode=com.cognitect.transit.eq.hashCode(this.toString())),this.hashCode};com.cognitect.transit.types.UUIDfromString=function(t){t=t.replace(/-/g,"");var e,r,n=e=0;for(r=24;8>n;n+=2,r-=8)e|=parseInt(t.substring(n,n+2),16)<<r;var o=0;for(n=8,r=24;16>n;n+=2,r-=8)o|=parseInt(t.substring(n,n+2),16)<<r;var i=module$contents$goog$math$Long_Long.fromBits(o,e);for(e=0,n=16,r=24;24>n;n+=2,r-=8)e|=parseInt(t.substring(n,n+2),16)<<r;for(o=0,r=n=24;32>n;n+=2,r-=8)o|=parseInt(t.substring(n,n+2),16)<<r;return t=module$contents$goog$math$Long_Long.fromBits(o,e),new com.cognitect.transit.types.UUID(i,t)};com.cognitect.transit.types.uuid=function(t){return com.cognitect.transit.types.UUIDfromString(t)};com.cognitect.transit.types.isUUID=function(t){return t instanceof com.cognitect.transit.types.UUID};com.cognitect.transit.types.date=function(t){return t=typeof t=="number"?t:parseInt(t,10),new Date(t)};com.cognitect.transit.types.verboseDate=function(t){return new Date(t)};Date.prototype.com$cognitect$transit$equals=function(t){return t instanceof Date?this.valueOf()===t.valueOf():!1};Date.prototype.com$cognitect$transit$hashCode=function(){return this.valueOf()};com.cognitect.transit.types.binary=function(t,e){return e&&e.preferBuffers===!1||typeof goog.global.Buffer>"u"?typeof Uint8Array<"u"?com.cognitect.transit.util.Base64ToUint8(t):com.cognitect.transit.types.taggedValue("b",t):new goog.global.Buffer(t,"base64")};com.cognitect.transit.types.isBinary=function(t){return typeof goog.global.Buffer<"u"&&t instanceof goog.global.Buffer||typeof Uint8Array<"u"&&t instanceof Uint8Array?!0:t instanceof com.cognitect.transit.types.TaggedValue&&t.tag==="b"};com.cognitect.transit.types.uri=function(t){return com.cognitect.transit.types.taggedValue("r",t)};com.cognitect.transit.types.isURI=function(t){return t instanceof com.cognitect.transit.types.TaggedValue&&t.tag==="r"};com.cognitect.transit.types.KEYS=0;com.cognitect.transit.types.VALUES=1;com.cognitect.transit.types.ENTRIES=2;com.cognitect.transit.types.TransitArrayMapIterator=function(t,e){this.entries=t,this.type=e||com.cognitect.transit.types.KEYS,this.idx=0};com.cognitect.transit.types.TransitArrayMapIterator.prototype.next=function(){if(this.idx<this.entries.length){var t={value:this.type===com.cognitect.transit.types.KEYS?this.entries[this.idx]:this.type===com.cognitect.transit.types.VALUES?this.entries[this.idx+1]:[this.entries[this.idx],this.entries[this.idx+1]],done:!1};return this.idx+=2,t}return{value:null,done:!0}};com.cognitect.transit.types.TransitArrayMapIterator.prototype.next=com.cognitect.transit.types.TransitArrayMapIterator.prototype.next;com.cognitect.transit.types.TransitArrayMapIterator.prototype[com.cognitect.transit.types.ITERATOR]=function(){return this};com.cognitect.transit.types.TransitMapIterator=function(t,e){this.map=t,this.type=e||com.cognitect.transit.types.KEYS,this.keys=this.map.getKeys(),this.idx=0,this.bucket=null,this.bucketIdx=0};com.cognitect.transit.types.TransitMapIterator.prototype.next=function(){if(this.idx<this.map.size){this.bucket!=null&&this.bucketIdx<this.bucket.length||(this.bucket=this.map.map[this.keys[this.idx]],this.bucketIdx=0);var t={value:this.type===com.cognitect.transit.types.KEYS?this.bucket[this.bucketIdx]:this.type===com.cognitect.transit.types.VALUES?this.bucket[this.bucketIdx+1]:[this.bucket[this.bucketIdx],this.bucket[this.bucketIdx+1]],done:!1};return this.idx++,this.bucketIdx+=2,t}return{value:null,done:!0}};com.cognitect.transit.types.TransitMapIterator.prototype.next=com.cognitect.transit.types.TransitMapIterator.prototype.next;com.cognitect.transit.types.TransitMapIterator.prototype[com.cognitect.transit.types.ITERATOR]=function(){return this};com.cognitect.transit.types.mapEquals=function(t,e){if(t instanceof com.cognitect.transit.types.TransitMap&&com.cognitect.transit.types.isMap(e)){if(t.size!==e.size)return!1;for(var r in t.map)for(var n=t.map[r],o=0;o<n.length;o+=2)if(!com.cognitect.transit.eq.equals(n[o+1],e.get(n[o])))return!1;return!0}if(t instanceof com.cognitect.transit.types.TransitArrayMap&&com.cognitect.transit.types.isMap(e)){if(t.size!==e.size)return!1;for(t=t._entries,o=0;o<t.length;o+=2)if(!com.cognitect.transit.eq.equals(t[o+1],e.get(t[o])))return!1;return!0}if(e!=null&&typeof e=="object"&&(o=com.cognitect.transit.util.objectKeys(e),r=o.length,t.size===r)){for(n=0;n<r;n++){var i=o[n];if(!t.has(i)||!com.cognitect.transit.eq.equals(e[i],t.get(i)))return!1}return!0}return!1};com.cognitect.transit.types.SMALL_ARRAY_MAP_THRESHOLD=8;com.cognitect.transit.types.ARRAY_MAP_THRESHOLD=32;com.cognitect.transit.types.ARRAY_MAP_ACCESS_THRESHOLD=32;com.cognitect.transit.types.print=function(t){return t==null?"null":goog.typeOf(t)==="array"?"["+t.toString()+"]":goog.typeOf(t)==="string"?'"'+t+'"':t.toString()};com.cognitect.transit.types.printMap=function(t){var e=0,r="TransitMap {";return t.forEach(function(n,o){r+=com.cognitect.transit.types.print(o)+" => "+com.cognitect.transit.types.print(n),e<t.size-1&&(r+=", "),e++}),r+"}"};com.cognitect.transit.types.printSet=function(t){var e=0,r="TransitSet {";return t.forEach(function(n){r+=com.cognitect.transit.types.print(n),e<t.size-1&&(r+=", "),e++}),r+"}"};com.cognitect.transit.types.TransitArrayMap=function(t){this._entries=t,this.backingMap=null,this.hashCode=-1,this.size=t.length/2,this.accesses=0};com.cognitect.transit.types.TransitArrayMap.prototype.toString=function(){return com.cognitect.transit.types.printMap(this)};com.cognitect.transit.types.TransitArrayMap.prototype.inspect=function(){return this.toString()};com.cognitect.transit.types.TransitArrayMap.prototype.convert=function(){if(this.backingMap)throw Error("Invalid operation, already converted");return this.size<com.cognitect.transit.types.SMALL_ARRAY_MAP_THRESHOLD?!1:(this.accesses++,this.accesses>com.cognitect.transit.types.ARRAY_MAP_ACCESS_THRESHOLD?(this.backingMap=com.cognitect.transit.types.map(this._entries,!1,!0),this._entries=[],!0):!1)};com.cognitect.transit.types.TransitArrayMap.prototype.clear=function(){this.hashCode=-1,this.backingMap?this.backingMap.clear():this._entries=[],this.size=0};com.cognitect.transit.types.TransitArrayMap.prototype.clear=com.cognitect.transit.types.TransitArrayMap.prototype.clear;com.cognitect.transit.types.TransitArrayMap.prototype.keys=function(){return this.backingMap?this.backingMap.keys():new com.cognitect.transit.types.TransitArrayMapIterator(this._entries,com.cognitect.transit.types.KEYS)};com.cognitect.transit.types.TransitArrayMap.prototype.keys=com.cognitect.transit.types.TransitArrayMap.prototype.keys;com.cognitect.transit.types.TransitArrayMap.prototype.keySet=function(){if(this.backingMap)return this.backingMap.keySet();for(var t=[],e=0,r=0;r<this._entries.length;e++,r+=2)t[e]=this._entries[r];return t};com.cognitect.transit.types.TransitArrayMap.prototype.keySet=com.cognitect.transit.types.TransitArrayMap.prototype.keySet;com.cognitect.transit.types.TransitArrayMap.prototype.entries=function(){return this.backingMap?this.backingMap.entries():new com.cognitect.transit.types.TransitArrayMapIterator(this._entries,com.cognitect.transit.types.ENTRIES)};com.cognitect.transit.types.TransitArrayMap.prototype.entries=com.cognitect.transit.types.TransitArrayMap.prototype.entries;com.cognitect.transit.types.TransitArrayMap.prototype.values=function(){return this.backingMap?this.backingMap.values():new com.cognitect.transit.types.TransitArrayMapIterator(this._entries,com.cognitect.transit.types.VALUES)};com.cognitect.transit.types.TransitArrayMap.prototype.values=com.cognitect.transit.types.TransitArrayMap.prototype.values;com.cognitect.transit.types.TransitArrayMap.prototype.forEach=function(t){if(this.backingMap)this.backingMap.forEach(t);else for(var e=0;e<this._entries.length;e+=2)t(this._entries[e+1],this._entries[e])};com.cognitect.transit.types.TransitArrayMap.prototype.forEach=com.cognitect.transit.types.TransitArrayMap.prototype.forEach;com.cognitect.transit.types.TransitArrayMap.prototype.get=function(t,e){if(this.backingMap)return this.backingMap.get(t);if(this.convert())return this.get(t);for(var r=0;r<this._entries.length;r+=2)if(com.cognitect.transit.eq.equals(this._entries[r],t))return this._entries[r+1];return e};com.cognitect.transit.types.TransitArrayMap.prototype.get=com.cognitect.transit.types.TransitArrayMap.prototype.get;com.cognitect.transit.types.TransitArrayMap.prototype.has=function(t){if(this.backingMap)return this.backingMap.has(t);if(this.convert())return this.has(t);for(var e=0;e<this._entries.length;e+=2)if(com.cognitect.transit.eq.equals(this._entries[e],t))return!0;return!1};com.cognitect.transit.types.TransitArrayMap.prototype.has=com.cognitect.transit.types.TransitArrayMap.prototype.has;com.cognitect.transit.types.TransitArrayMap.prototype.set=function(t,e){if(this.hashCode=-1,this.backingMap)this.backingMap.set(t,e),this.size=this.backingMap.size;else{for(var r=0;r<this._entries.length;r+=2)if(com.cognitect.transit.eq.equals(this._entries[r],t)){this._entries[r+1]=e;return}this._entries.push(t),this._entries.push(e),this.size++,this.size>com.cognitect.transit.types.ARRAY_MAP_THRESHOLD&&(this.backingMap=com.cognitect.transit.types.map(this._entries,!1,!0),this._entries=null)}};com.cognitect.transit.types.TransitArrayMap.prototype.set=com.cognitect.transit.types.TransitArrayMap.prototype.set;com.cognitect.transit.types.TransitArrayMap.prototype.delete=function(t){if(this.hashCode=-1,this.backingMap)return t=this.backingMap.delete(t),this.size=this.backingMap.size,t;for(var e=0;e<this._entries.length;e+=2)if(com.cognitect.transit.eq.equals(this._entries[e],t))return t=this._entries[e+1],this._entries.splice(e,2),this.size--,t};com.cognitect.transit.types.TransitArrayMap.prototype.clone=function(){var t=com.cognitect.transit.types.map();return this.forEach(function(e,r){t.set(r,e)}),t};com.cognitect.transit.types.TransitArrayMap.prototype.clone=com.cognitect.transit.types.TransitArrayMap.prototype.clone;com.cognitect.transit.types.TransitArrayMap.prototype[com.cognitect.transit.types.ITERATOR]=function(){return this.entries()};com.cognitect.transit.types.TransitArrayMap.prototype.com$cognitect$transit$hashCode=function(){return this.backingMap?this.backingMap.com$cognitect$transit$hashCode():(this.hashCode===-1&&(this.hashCode=com.cognitect.transit.eq.hashMapLike(this)),this.hashCode)};com.cognitect.transit.types.TransitArrayMap.prototype.com$cognitect$transit$equals=function(t){return this.backingMap?com.cognitect.transit.types.mapEquals(this.backingMap,t):com.cognitect.transit.types.mapEquals(this,t)};com.cognitect.transit.types.TransitMap=function(t,e,r){this.map=e||{},this._keys=t||[],this.size=r||0,this.hashCode=-1};com.cognitect.transit.types.TransitMap.prototype.toString=function(){return com.cognitect.transit.types.printMap(this)};com.cognitect.transit.types.TransitMap.prototype.inspect=function(){return this.toString()};com.cognitect.transit.types.TransitMap.prototype.clear=function(){this.hashCode=-1,this.map={},this._keys=[],this.size=0};com.cognitect.transit.types.TransitMap.prototype.clear=com.cognitect.transit.types.TransitMap.prototype.clear;com.cognitect.transit.types.TransitMap.prototype.getKeys=function(){return this._keys!=null?this._keys:com.cognitect.transit.util.objectKeys(this.map)};com.cognitect.transit.types.TransitMap.prototype.delete=function(t){this.hashCode=-1,this._keys=null;for(var e=com.cognitect.transit.eq.hashCode(t),r=this.map[e],n=0;n<r.length;n+=2)if(com.cognitect.transit.eq.equals(t,r[n]))return t=r[n+1],r.splice(n,2),r.length===0&&delete this.map[e],this.size--,t};com.cognitect.transit.types.TransitMap.prototype.entries=function(){return new com.cognitect.transit.types.TransitMapIterator(this,com.cognitect.transit.types.ENTRIES)};com.cognitect.transit.types.TransitMap.prototype.entries=com.cognitect.transit.types.TransitMap.prototype.entries;com.cognitect.transit.types.TransitMap.prototype.forEach=function(t){for(var e=this.getKeys(),r=0;r<e.length;r++)for(var n=this.map[e[r]],o=0;o<n.length;o+=2)t(n[o+1],n[o],this)};com.cognitect.transit.types.TransitMap.prototype.forEach=com.cognitect.transit.types.TransitMap.prototype.forEach;com.cognitect.transit.types.TransitMap.prototype.get=function(t,e){var r=com.cognitect.transit.eq.hashCode(t);if(r=this.map[r],r!=null){for(e=0;e<r.length;e+=2)if(com.cognitect.transit.eq.equals(t,r[e]))return r[e+1]}else return e};com.cognitect.transit.types.TransitMap.prototype.get=com.cognitect.transit.types.TransitMap.prototype.get;com.cognitect.transit.types.TransitMap.prototype.has=function(t){var e=com.cognitect.transit.eq.hashCode(t);if(e=this.map[e],e!=null){for(var r=0;r<e.length;r+=2)if(com.cognitect.transit.eq.equals(t,e[r]))return!0}return!1};com.cognitect.transit.types.TransitMap.prototype.has=com.cognitect.transit.types.TransitMap.prototype.has;com.cognitect.transit.types.TransitMap.prototype.keys=function(){return new com.cognitect.transit.types.TransitMapIterator(this,com.cognitect.transit.types.KEYS)};com.cognitect.transit.types.TransitMap.prototype.keys=com.cognitect.transit.types.TransitMap.prototype.keys;com.cognitect.transit.types.TransitMap.prototype.keySet=function(){for(var t=this.getKeys(),e=[],r=0;r<t.length;r++)for(var n=this.map[t[r]],o=0;o<n.length;o+=2)e.push(n[o]);return e};com.cognitect.transit.types.TransitMap.prototype.keySet=com.cognitect.transit.types.TransitMap.prototype.keySet;com.cognitect.transit.types.TransitMap.prototype.set=function(t,e){this.hashCode=-1;var r=com.cognitect.transit.eq.hashCode(t),n=this.map[r];if(n==null)this._keys&&this._keys.push(r),this.map[r]=[t,e],this.size++;else{r=!0;for(var o=0;o<n.length;o+=2)if(com.cognitect.transit.eq.equals(e,n[o])){r=!1,n[o]=e;break}r&&(n.push(t),n.push(e),this.size++)}};com.cognitect.transit.types.TransitMap.prototype.set=com.cognitect.transit.types.TransitMap.prototype.set;com.cognitect.transit.types.TransitMap.prototype.values=function(){return new com.cognitect.transit.types.TransitMapIterator(this,com.cognitect.transit.types.VALUES)};com.cognitect.transit.types.TransitMap.prototype.values=com.cognitect.transit.types.TransitMap.prototype.values;com.cognitect.transit.types.TransitMap.prototype.clone=function(){var t=com.cognitect.transit.types.map();return this.forEach(function(e,r){t.set(r,e)}),t};com.cognitect.transit.types.TransitMap.prototype.clone=com.cognitect.transit.types.TransitMap.prototype.clone;com.cognitect.transit.types.TransitMap.prototype[com.cognitect.transit.types.ITERATOR]=function(){return this.entries()};com.cognitect.transit.types.TransitMap.prototype.com$cognitect$transit$hashCode=function(){return this.hashCode===-1&&(this.hashCode=com.cognitect.transit.eq.hashMapLike(this)),this.hashCode};com.cognitect.transit.types.TransitMap.prototype.com$cognitect$transit$equals=function(t){return com.cognitect.transit.types.mapEquals(this,t)};com.cognitect.transit.types.map=function(t,e,r){if(t=t||[],e=e===!1?e:!0,(r!==!0||!r)&&t.length<=2*com.cognitect.transit.types.ARRAY_MAP_THRESHOLD){if(e){var n=t;for(t=[],e=0;e<n.length;e+=2){var o=!1;for(r=0;r<t.length;r+=2)if(com.cognitect.transit.eq.equals(t[r],n[e])){t[r+1]=n[e+1],o=!0;break}o||(t.push(n[e]),t.push(n[e+1]))}}return new com.cognitect.transit.types.TransitArrayMap(t)}n={},o=[];var i=0;for(e=0;e<t.length;e+=2){r=com.cognitect.transit.eq.hashCode(t[e]);var s=n[r];if(s==null)o.push(r),n[r]=[t[e],t[e+1]],i++;else{var c=!0;for(r=0;r<s.length;r+=2)if(com.cognitect.transit.eq.equals(s[r],t[e])){s[r+1]=t[e+1],c=!1;break}c&&(s.push(t[e]),s.push(t[e+1]),i++)}}return new com.cognitect.transit.types.TransitMap(o,n,i)};com.cognitect.transit.types.isArrayMap=function(t){return t instanceof com.cognitect.transit.types.TransitArrayMap};com.cognitect.transit.types.isMap=function(t){return t instanceof com.cognitect.transit.types.TransitArrayMap||t instanceof com.cognitect.transit.types.TransitMap};com.cognitect.transit.types.TransitSet=function(t){this.map=t,this.size=t.size};com.cognitect.transit.types.TransitSet.prototype.toString=function(){return com.cognitect.transit.types.printSet(this)};com.cognitect.transit.types.TransitSet.prototype.inspect=function(){return this.toString()};com.cognitect.transit.types.TransitSet.prototype.add=function(t){this.map.set(t,t),this.size=this.map.size};com.cognitect.transit.types.TransitSet.prototype.add=com.cognitect.transit.types.TransitSet.prototype.add;com.cognitect.transit.types.TransitSet.prototype.clear=function(){this.map=new com.cognitect.transit.types.TransitMap,this.size=0};com.cognitect.transit.types.TransitSet.prototype.clear=com.cognitect.transit.types.TransitSet.prototype.clear;com.cognitect.transit.types.TransitSet.prototype.delete=function(t){return t=this.map.delete(t),this.size=this.map.size,t};com.cognitect.transit.types.TransitSet.prototype.entries=function(){return this.map.entries()};com.cognitect.transit.types.TransitSet.prototype.entries=com.cognitect.transit.types.TransitSet.prototype.entries;com.cognitect.transit.types.TransitSet.prototype.forEach=function(t,e){var r=this;this.map.forEach(function(n,o,i){t(o,r)})};com.cognitect.transit.types.TransitSet.prototype.forEach=com.cognitect.transit.types.TransitSet.prototype.forEach;com.cognitect.transit.types.TransitSet.prototype.has=function(t){return this.map.has(t)};com.cognitect.transit.types.TransitSet.prototype.has=com.cognitect.transit.types.TransitSet.prototype.has;com.cognitect.transit.types.TransitSet.prototype.keys=function(){return this.map.keys()};com.cognitect.transit.types.TransitSet.prototype.keys=com.cognitect.transit.types.TransitSet.prototype.keys;com.cognitect.transit.types.TransitSet.prototype.keySet=function(){return this.map.keySet()};com.cognitect.transit.types.TransitSet.prototype.keySet=com.cognitect.transit.types.TransitSet.prototype.keySet;com.cognitect.transit.types.TransitSet.prototype.values=function(){return this.map.values()};com.cognitect.transit.types.TransitSet.prototype.values=com.cognitect.transit.types.TransitSet.prototype.values;com.cognitect.transit.types.TransitSet.prototype.clone=function(){var t=com.cognitect.transit.types.set();return this.forEach(function(e){t.add(e)}),t};com.cognitect.transit.types.TransitSet.prototype.clone=com.cognitect.transit.types.TransitSet.prototype.clone;com.cognitect.transit.types.TransitSet.prototype[com.cognitect.transit.types.ITERATOR]=function(){return this.values()};com.cognitect.transit.types.TransitSet.prototype.com$cognitect$transit$equals=function(t){if(t instanceof com.cognitect.transit.types.TransitSet){if(this.size===t.size)return com.cognitect.transit.eq.equals(this.map,t.map)}else return!1};com.cognitect.transit.types.TransitSet.prototype.com$cognitect$transit$hashCode=function(t){return com.cognitect.transit.eq.hashCode(this.map)};com.cognitect.transit.types.set=function(t){t=t||[];for(var e={},r=[],n=0,o=0;o<t.length;o++){var i=com.cognitect.transit.eq.hashCode(t[o]),s=e[i];if(s==null)r.push(i),e[i]=[t[o],t[o]],n++;else{i=!0;for(var c=0;c<s.length;c+=2)if(com.cognitect.transit.eq.equals(s[c],t[o])){i=!1;break}i&&(s.push(t[o]),s.push(t[o]),n++)}}return new com.cognitect.transit.types.TransitSet(new com.cognitect.transit.types.TransitMap(r,e,n))};com.cognitect.transit.types.isSet=function(t){return t instanceof com.cognitect.transit.types.TransitSet};com.cognitect.transit.types.quoted=function(t){return com.cognitect.transit.types.taggedValue("'",t)};com.cognitect.transit.types.isQuoted=function(t){return t instanceof com.cognitect.transit.types.TaggedValue&&t.tag==="'"};com.cognitect.transit.types.list=function(t){return com.cognitect.transit.types.taggedValue("list",t)};com.cognitect.transit.types.isList=function(t){return t instanceof com.cognitect.transit.types.TaggedValue&&t.tag==="list"};com.cognitect.transit.types.link=function(t){return com.cognitect.transit.types.taggedValue("link",t)};com.cognitect.transit.types.isLink=function(t){return t instanceof com.cognitect.transit.types.TaggedValue&&t.tag==="link"};com.cognitect.transit.types.specialDouble=function(t){switch(t){case"-INF":return-1/0;case"INF":return 1/0;case"NaN":return NaN;default:throw Error("Invalid special double value "+t)}};com.cognitect.transit.impl={};com.cognitect.transit.impl.decoder={};com.cognitect.transit.impl.decoder.Tag=function(t){this.str=t};com.cognitect.transit.impl.decoder.tag=function(t){return new com.cognitect.transit.impl.decoder.Tag(t)};com.cognitect.transit.impl.decoder.isTag=function(t){return t&&t instanceof com.cognitect.transit.impl.decoder.Tag};com.cognitect.transit.impl.decoder.isGroundHandler=function(t){switch(t){case"_":case"s":case"?":case"i":case"d":case"b":case"'":case"array":case"map":return!0}return!1};com.cognitect.transit.impl.decoder.Decoder=function(t){this.options=t||{},this.handlers={};for(var e in this.defaults.handlers)this.handlers[e]=this.defaults.handlers[e];for(e in this.options.handlers){if(com.cognitect.transit.impl.decoder.isGroundHandler(e))throw Error('Cannot override handler for ground type "'+e+'"');this.handlers[e]=this.options.handlers[e]}this.preferStrings=this.options.preferStrings!=null?this.options.preferStrings:this.defaults.preferStrings,this.preferBuffers=this.options.preferBuffers!=null?this.options.preferBuffers:this.defaults.preferBuffers,this.defaultHandler=this.options.defaultHandler||this.defaults.defaultHandler,this.mapBuilder=this.options.mapBuilder,this.arrayBuilder=this.options.arrayBuilder};com.cognitect.transit.impl.decoder.Decoder.prototype.defaults={handlers:{_:function(t,e){return com.cognitect.transit.types.nullValue()},"?":function(t,e){return com.cognitect.transit.types.boolValue(t)},b:function(t,e){return com.cognitect.transit.types.binary(t,e)},i:function(t,e){return com.cognitect.transit.types.intValue(t)},n:function(t,e){return com.cognitect.transit.types.bigInteger(t)},d:function(t,e){return com.cognitect.transit.types.floatValue(t)},f:function(t,e){return com.cognitect.transit.types.bigDecimalValue(t)},c:function(t,e){return com.cognitect.transit.types.charValue(t)},":":function(t,e){return com.cognitect.transit.types.keyword(t)},$:function(t,e){return com.cognitect.transit.types.symbol(t)},r:function(t,e){return com.cognitect.transit.types.uri(t)},z:function(t,e){return com.cognitect.transit.types.specialDouble(t)},"'":function(t,e){return t},m:function(t,e){return com.cognitect.transit.types.date(t)},t:function(t,e){return com.cognitect.transit.types.verboseDate(t)},u:function(t,e){return com.cognitect.transit.types.uuid(t)},set:function(t,e){return com.cognitect.transit.types.set(t)},list:function(t,e){return com.cognitect.transit.types.list(t)},link:function(t,e){return com.cognitect.transit.types.link(t)},cmap:function(t,e){return com.cognitect.transit.types.map(t,!1)}},defaultHandler:function(t,e){return com.cognitect.transit.types.taggedValue(t,e)},preferStrings:!0,preferBuffers:!0};com.cognitect.transit.impl.decoder.Decoder.prototype.decode=function(t,e,r,n){if(t==null)return null;switch(typeof t){case"string":return this.decodeString(t,e,r,n);case"object":return com.cognitect.transit.util.isArray(t)?t[0]==="^ "?this.decodeArrayHash(t,e,r,n):this.decodeArray(t,e,r,n):this.decodeHash(t,e,r,n)}return t};com.cognitect.transit.impl.decoder.Decoder.prototype.decode=com.cognitect.transit.impl.decoder.Decoder.prototype.decode;com.cognitect.transit.impl.decoder.Decoder.prototype.decodeString=function(t,e,r,n){return com.cognitect.transit.caching.isCacheable(t,r)?(t=this.parseString(t,e,!1),e&&e.write(t,r),t):com.cognitect.transit.caching.isCacheCode(t)?e.read(t,r):this.parseString(t,e,r)};com.cognitect.transit.impl.decoder.Decoder.prototype.decodeHash=function(t,e,r,n){r=com.cognitect.transit.util.objectKeys(t);var o=r[0];if(n=r.length==1?this.decode(o,e,!1,!1):null,com.cognitect.transit.impl.decoder.isTag(n))return t=t[o],r=this.handlers[n.str],r!=null?r(this.decode(t,e,!1,!0),this):com.cognitect.transit.types.taggedValue(n.str,this.decode(t,e,!1,!1));if(this.mapBuilder){if(r.length<2*com.cognitect.transit.types.SMALL_ARRAY_MAP_THRESHOLD&&this.mapBuilder.fromArray){var i=[];for(n=0;n<r.length;n++)o=r[n],i.push(this.decode(o,e,!0,!1)),i.push(this.decode(t[o],e,!1,!1));return this.mapBuilder.fromArray(i,t)}for(i=this.mapBuilder.init(t),n=0;n<r.length;n++)o=r[n],i=this.mapBuilder.add(i,this.decode(o,e,!0,!1),this.decode(t[o],e,!1,!1),t);return this.mapBuilder.finalize(i,t)}for(i=[],n=0;n<r.length;n++)o=r[n],i.push(this.decode(o,e,!0,!1)),i.push(this.decode(t[o],e,!1,!1));return com.cognitect.transit.types.map(i,!1)};com.cognitect.transit.impl.decoder.Decoder.prototype.decodeArrayHash=function(t,e,r,n){if(this.mapBuilder){if(t.length<2*com.cognitect.transit.types.SMALL_ARRAY_MAP_THRESHOLD+1&&this.mapBuilder.fromArray){for(n=[],r=1;r<t.length;r+=2)n.push(this.decode(t[r],e,!0,!1)),n.push(this.decode(t[r+1],e,!1,!1));return this.mapBuilder.fromArray(n,t)}for(n=this.mapBuilder.init(t),r=1;r<t.length;r+=2)n=this.mapBuilder.add(n,this.decode(t[r],e,!0,!1),this.decode(t[r+1],e,!1,!1),t);return this.mapBuilder.finalize(n,t)}for(n=[],r=1;r<t.length;r+=2)n.push(this.decode(t[r],e,!0,!1)),n.push(this.decode(t[r+1],e,!1,!1));return com.cognitect.transit.types.map(n,!1)};com.cognitect.transit.impl.decoder.Decoder.prototype.decodeArray=function(t,e,r,n){if(n){var o=[];for(n=0;n<t.length;n++)o.push(this.decode(t[n],e,r,!1));return o}if(o=e&&e.idx,t.length===2&&typeof t[0]=="string"&&(n=this.decode(t[0],e,!1,!1),com.cognitect.transit.impl.decoder.isTag(n)))return t=t[1],o=this.handlers[n.str],o!=null?o=o(this.decode(t,e,r,!0),this):com.cognitect.transit.types.taggedValue(n.str,this.decode(t,e,r,!1));if(e&&o!=e.idx&&(e.idx=o),this.arrayBuilder){if(32>=t.length&&this.arrayBuilder.fromArray){for(o=[],n=0;n<t.length;n++)o.push(this.decode(t[n],e,r,!1));return this.arrayBuilder.fromArray(o,t)}for(o=this.arrayBuilder.init(t),n=0;n<t.length;n++)o=this.arrayBuilder.add(o,this.decode(t[n],e,r,!1),t);return this.arrayBuilder.finalize(o,t)}for(o=[],n=0;n<t.length;n++)o.push(this.decode(t[n],e,r,!1));return o};com.cognitect.transit.impl.decoder.Decoder.prototype.parseString=function(t,e,r){return t.charAt(0)===com.cognitect.transit.delimiters.ESC?(e=t.charAt(1),e===com.cognitect.transit.delimiters.ESC||e===com.cognitect.transit.delimiters.SUB||e===com.cognitect.transit.delimiters.RES?t.substring(1):e===com.cognitect.transit.delimiters.TAG?com.cognitect.transit.impl.decoder.tag(t.substring(2)):(r=this.handlers[e],r==null?this.defaultHandler(e,t.substring(2)):r(t.substring(2),this))):t};com.cognitect.transit.impl.decoder.decoder=function(t){return new com.cognitect.transit.impl.decoder.Decoder(t)};com.cognitect.transit.impl.reader={};com.cognitect.transit.impl.reader.JSONUnmarshaller=function(t){this.decoder=new com.cognitect.transit.impl.decoder.Decoder(t)};com.cognitect.transit.impl.reader.JSONUnmarshaller.prototype.unmarshal=function(t,e){return this.decoder.decode(JSON.parse(t),e)};com.cognitect.transit.impl.reader.Reader=function(t,e){this.unmarshaller=t,this.options=e||{},this.cache=this.options.cache?this.options.cache:new com.cognitect.transit.caching.ReadCache};com.cognitect.transit.impl.reader.Reader.prototype.read=function(t){return t=this.unmarshaller.unmarshal(t,this.cache),this.cache.clear(),t};com.cognitect.transit.impl.reader.Reader.prototype.read=com.cognitect.transit.impl.reader.Reader.prototype.read;com.cognitect.transit.handlers={};com.cognitect.transit.handlers.ctorGuid=0;com.cognitect.transit.handlers.ctorGuidProperty="transit$guid$"+com.cognitect.transit.util.randomUUID();com.cognitect.transit.handlers.typeTag=function(t){if(t==null)return"null";if(t===String)return"string";if(t===Boolean)return"boolean";if(t===Number)return"number";if(t===Array)return"array";if(t===Object)return"map";var e=t[com.cognitect.transit.handlers.ctorGuidProperty];return e==null&&(typeof Object.defineProperty<"u"?(e=++com.cognitect.transit.handlers.ctorGuid,Object.defineProperty(t,com.cognitect.transit.handlers.ctorGuidProperty,{value:e,enumerable:!1})):t[com.cognitect.transit.handlers.ctorGuidProperty]=e=++com.cognitect.transit.handlers.ctorGuid),e};com.cognitect.transit.handlers.constructor=function(t){return t==null?null:t.constructor};com.cognitect.transit.handlers.padZeros=function(t,e){t=t.toString();for(var r=t.length;r<e;r++)t="0"+t;return t};com.cognitect.transit.handlers.stringableKeys=function(t){t=com.cognitect.transit.util.objectKeys(t);for(var e=0;e<t.length;e++);return!0};com.cognitect.transit.handlers.NilHandler=function(){};com.cognitect.transit.handlers.NilHandler.prototype.tag=function(t){return"_"};com.cognitect.transit.handlers.NilHandler.prototype.rep=function(t){return null};com.cognitect.transit.handlers.NilHandler.prototype.stringRep=function(t){return"null"};com.cognitect.transit.handlers.StringHandler=function(){};com.cognitect.transit.handlers.StringHandler.prototype.tag=function(t){return"s"};com.cognitect.transit.handlers.StringHandler.prototype.rep=function(t){return t};com.cognitect.transit.handlers.StringHandler.prototype.stringRep=function(t){return t};com.cognitect.transit.handlers.NumberHandler=function(){};com.cognitect.transit.handlers.NumberHandler.prototype.tag=function(t){return"i"};com.cognitect.transit.handlers.NumberHandler.prototype.rep=function(t){return t};com.cognitect.transit.handlers.NumberHandler.prototype.stringRep=function(t){return t.toString()};com.cognitect.transit.handlers.IntegerHandler=function(){};com.cognitect.transit.handlers.IntegerHandler.prototype.tag=function(t){return"i"};com.cognitect.transit.handlers.IntegerHandler.prototype.rep=function(t){return t.toString()};com.cognitect.transit.handlers.IntegerHandler.prototype.stringRep=function(t){return t.toString()};com.cognitect.transit.handlers.BooleanHandler=function(){};com.cognitect.transit.handlers.BooleanHandler.prototype.tag=function(t){return"?"};com.cognitect.transit.handlers.BooleanHandler.prototype.rep=function(t){return t};com.cognitect.transit.handlers.BooleanHandler.prototype.stringRep=function(t){return t.toString()};com.cognitect.transit.handlers.ArrayHandler=function(){};com.cognitect.transit.handlers.ArrayHandler.prototype.tag=function(t){return"array"};com.cognitect.transit.handlers.ArrayHandler.prototype.rep=function(t){return t};com.cognitect.transit.handlers.ArrayHandler.prototype.stringRep=function(t){return null};com.cognitect.transit.handlers.MapHandler=function(){};com.cognitect.transit.handlers.MapHandler.prototype.tag=function(t){return"map"};com.cognitect.transit.handlers.MapHandler.prototype.rep=function(t){return t};com.cognitect.transit.handlers.MapHandler.prototype.stringRep=function(t){return null};com.cognitect.transit.handlers.VerboseDateHandler=function(){};com.cognitect.transit.handlers.VerboseDateHandler.prototype.tag=function(t){return"t"};com.cognitect.transit.handlers.VerboseDateHandler.prototype.rep=function(t){return t.getUTCFullYear()+"-"+com.cognitect.transit.handlers.padZeros(t.getUTCMonth()+1,2)+"-"+com.cognitect.transit.handlers.padZeros(t.getUTCDate(),2)+"T"+com.cognitect.transit.handlers.padZeros(t.getUTCHours(),2)+":"+com.cognitect.transit.handlers.padZeros(t.getUTCMinutes(),2)+":"+com.cognitect.transit.handlers.padZeros(t.getUTCSeconds(),2)+"."+com.cognitect.transit.handlers.padZeros(t.getUTCMilliseconds(),3)+"Z"};com.cognitect.transit.handlers.VerboseDateHandler.prototype.stringRep=function(t,e){return e.rep(t)};com.cognitect.transit.handlers.DateHandler=function(){};com.cognitect.transit.handlers.DateHandler.prototype.tag=function(t){return"m"};com.cognitect.transit.handlers.DateHandler.prototype.rep=function(t){return t.valueOf()};com.cognitect.transit.handlers.DateHandler.prototype.stringRep=function(t){return t.valueOf().toString()};com.cognitect.transit.handlers.DateHandler.prototype.getVerboseHandler=function(t){return new com.cognitect.transit.handlers.VerboseDateHandler};com.cognitect.transit.handlers.UUIDHandler=function(){};com.cognitect.transit.handlers.UUIDHandler.prototype.tag=function(t){return"u"};com.cognitect.transit.handlers.UUIDHandler.prototype.rep=function(t){return t.toString()};com.cognitect.transit.handlers.UUIDHandler.prototype.stringRep=function(t){return t.toString()};com.cognitect.transit.handlers.KeywordHandler=function(){};com.cognitect.transit.handlers.KeywordHandler.prototype.tag=function(t){return":"};com.cognitect.transit.handlers.KeywordHandler.prototype.rep=function(t){return t._name};com.cognitect.transit.handlers.KeywordHandler.prototype.stringRep=function(t,e){return e.rep(t)};com.cognitect.transit.handlers.SymbolHandler=function(){};com.cognitect.transit.handlers.SymbolHandler.prototype.tag=function(t){return"$"};com.cognitect.transit.handlers.SymbolHandler.prototype.rep=function(t){return t._name};com.cognitect.transit.handlers.SymbolHandler.prototype.stringRep=function(t,e){return e.rep(t)};com.cognitect.transit.handlers.TaggedHandler=function(){};com.cognitect.transit.handlers.TaggedHandler.prototype.tag=function(t){return t.tag};com.cognitect.transit.handlers.TaggedHandler.prototype.rep=function(t){return t.rep};com.cognitect.transit.handlers.TaggedHandler.prototype.stringRep=function(t,e){return null};com.cognitect.transit.handlers.TransitSetHandler=function(){};com.cognitect.transit.handlers.TransitSetHandler.prototype.tag=function(t){return"set"};com.cognitect.transit.handlers.TransitSetHandler.prototype.rep=function(t){var e=[];return t.forEach(function(r,n){e.push(r)}),com.cognitect.transit.types.taggedValue("array",e)};com.cognitect.transit.handlers.TransitSetHandler.prototype.stringRep=function(t,e){return null};com.cognitect.transit.handlers.TransitArrayMapHandler=function(){};com.cognitect.transit.handlers.TransitArrayMapHandler.prototype.tag=function(t){return"map"};com.cognitect.transit.handlers.TransitArrayMapHandler.prototype.rep=function(t){return t};com.cognitect.transit.handlers.TransitArrayMapHandler.prototype.stringRep=function(t,e){return null};com.cognitect.transit.handlers.TransitMapHandler=function(){};com.cognitect.transit.handlers.TransitMapHandler.prototype.tag=function(t){return"map"};com.cognitect.transit.handlers.TransitMapHandler.prototype.rep=function(t){return t};com.cognitect.transit.handlers.TransitMapHandler.prototype.stringRep=function(t,e){return null};com.cognitect.transit.handlers.BufferHandler=function(){};com.cognitect.transit.handlers.BufferHandler.prototype.tag=function(t){return"b"};com.cognitect.transit.handlers.BufferHandler.prototype.rep=function(t){return t.toString("base64")};com.cognitect.transit.handlers.BufferHandler.prototype.stringRep=function(t,e){return null};com.cognitect.transit.handlers.Uint8ArrayHandler=function(){};com.cognitect.transit.handlers.Uint8ArrayHandler.prototype.tag=function(t){return"b"};com.cognitect.transit.handlers.Uint8ArrayHandler.prototype.rep=function(t){return com.cognitect.transit.util.Uint8ToBase64(t)};com.cognitect.transit.handlers.Uint8ArrayHandler.prototype.stringRep=function(t,e){return null};com.cognitect.transit.handlers.defaultHandlers=function(t){return t.set(null,new com.cognitect.transit.handlers.NilHandler),t.set(String,new com.cognitect.transit.handlers.StringHandler),t.set(Number,new com.cognitect.transit.handlers.NumberHandler),t.set(module$contents$goog$math$Long_Long,new com.cognitect.transit.handlers.IntegerHandler),t.set(Boolean,new com.cognitect.transit.handlers.BooleanHandler),t.set(Array,new com.cognitect.transit.handlers.ArrayHandler),t.set(Object,new com.cognitect.transit.handlers.MapHandler),t.set(Date,new com.cognitect.transit.handlers.DateHandler),t.set(com.cognitect.transit.types.UUID,new com.cognitect.transit.handlers.UUIDHandler),t.set(com.cognitect.transit.types.Keyword,new com.cognitect.transit.handlers.KeywordHandler),t.set(com.cognitect.transit.types.Symbol,new com.cognitect.transit.handlers.SymbolHandler),t.set(com.cognitect.transit.types.TaggedValue,new com.cognitect.transit.handlers.TaggedHandler),t.set(com.cognitect.transit.types.TransitSet,new com.cognitect.transit.handlers.TransitSetHandler),t.set(com.cognitect.transit.types.TransitArrayMap,new com.cognitect.transit.handlers.TransitArrayMapHandler),t.set(com.cognitect.transit.types.TransitMap,new com.cognitect.transit.handlers.TransitMapHandler),typeof goog.global.Buffer<"u"&&t.set(goog.global.Buffer,new com.cognitect.transit.handlers.BufferHandler),typeof Uint8Array<"u"&&t.set(Uint8Array,new com.cognitect.transit.handlers.Uint8ArrayHandler),t};com.cognitect.transit.handlers.Handlers=function(){this.handlers={},com.cognitect.transit.handlers.defaultHandlers(this)};com.cognitect.transit.handlers.Handlers.prototype.get=function(t){return t=typeof t=="string"?this.handlers[t]:this.handlers[com.cognitect.transit.handlers.typeTag(t)],t!=null?t:this.handlers.default};com.cognitect.transit.handlers.Handlers.prototype.get=com.cognitect.transit.handlers.Handlers.prototype.get;com.cognitect.transit.handlers.validTag=function(t){switch(t){case"null":case"string":case"boolean":case"number":case"array":case"map":return!1}return!0};com.cognitect.transit.handlers.Handlers.prototype.set=function(t,e){typeof t=="string"&&com.cognitect.transit.handlers.validTag(t)?this.handlers[t]=e:this.handlers[com.cognitect.transit.handlers.typeTag(t)]=e};com.cognitect.transit.impl.writer={};com.cognitect.transit.impl.writer.escape=function(t){if(0<t.length){var e=t.charAt(0);return e===com.cognitect.transit.delimiters.ESC||e===com.cognitect.transit.delimiters.SUB||e===com.cognitect.transit.delimiters.RES?com.cognitect.transit.delimiters.ESC+t:t}return t};com.cognitect.transit.impl.writer.JSONMarshaller=function(t){if(this.opts=t||{},this.preferStrings=this.opts.preferStrings!=null?this.opts.preferStrings:!0,this.objectBuilder=this.opts.objectBuilder||null,this.transform=this.opts.transform||null,this.handlers=new com.cognitect.transit.handlers.Handlers,t=this.opts.handlers){if(com.cognitect.transit.util.isArray(t)||!t.forEach)throw Error('transit writer "handlers" option must be a map');var e=this;t.forEach(function(r,n){if(n!==void 0)e.handlers.set(n,r);else throw Error("Cannot create handler for JavaScript undefined")})}this.handlerForForeign=this.opts.handlerForForeign,this.unpack=this.opts.unpack||function(r){return com.cognitect.transit.types.isArrayMap(r)&&r.backingMap===null?r._entries:!1},this.verbose=this.opts&&this.opts.verbose||!1};com.cognitect.transit.impl.writer.JSONMarshaller.prototype.handler=function(t){var e=this.handlers.get(com.cognitect.transit.handlers.constructor(t));return e!=null?e:(t=t&&t.transitTag)?this.handlers.get(t):null};com.cognitect.transit.impl.writer.JSONMarshaller.prototype.registerHandler=function(t,e){this.handlers.set(t,e)};com.cognitect.transit.impl.writer.JSONMarshaller.prototype.emitNil=function(t,e){return t?this.emitString(com.cognitect.transit.delimiters.ESC,"_","",t,e):null};com.cognitect.transit.impl.writer.JSONMarshaller.prototype.emitString=function(t,e,r,n,o){return t=t+e+r,o?o.write(t,n):t};com.cognitect.transit.impl.writer.JSONMarshaller.prototype.emitBoolean=function(t,e,r){return e?this.emitString(com.cognitect.transit.delimiters.ESC,"?",t.toString()[0],e,r):t};com.cognitect.transit.impl.writer.JSONMarshaller.prototype.emitInteger=function(t,e,r){return t===1/0?this.emitString(com.cognitect.transit.delimiters.ESC,"z","INF",e,r):t===-1/0?this.emitString(com.cognitect.transit.delimiters.ESC,"z","-INF",e,r):isNaN(t)?this.emitString(com.cognitect.transit.delimiters.ESC,"z","NaN",e,r):e||typeof t=="string"||t instanceof module$contents$goog$math$Long_Long?this.emitString(com.cognitect.transit.delimiters.ESC,"i",t.toString(),e,r):t};com.cognitect.transit.impl.writer.JSONMarshaller.prototype.emitDouble=function(t,e,r){return e?this.emitString(t.ESC,"d",t,e,r):t};com.cognitect.transit.impl.writer.JSONMarshaller.prototype.emitBinary=function(t,e,r){return this.emitString(com.cognitect.transit.delimiters.ESC,"b",t,e,r)};com.cognitect.transit.impl.writer.JSONMarshaller.prototype.emitQuoted=function(t,e,r){if(t.verbose){t={};var n=this.emitString(com.cognitect.transit.delimiters.ESC_TAG,"'","",!0,r);return t[n]=com.cognitect.transit.impl.writer.marshal(this,e,!1,r),t}return[this.emitString(com.cognitect.transit.delimiters.ESC_TAG,"'","",!0,r),com.cognitect.transit.impl.writer.marshal(this,e,!1,r)]};com.cognitect.transit.impl.writer.emitObjects=function(t,e,r){var n=[];if(com.cognitect.transit.util.isArray(e))for(var o=0;o<e.length;o++)n.push(com.cognitect.transit.impl.writer.marshal(t,e[o],!1,r));else e.forEach(function(i,s){n.push(com.cognitect.transit.impl.writer.marshal(t,i,!1,r))});return n};com.cognitect.transit.impl.writer.emitArray=function(t,e,r,n){return com.cognitect.transit.impl.writer.emitObjects(t,e,n)};com.cognitect.transit.impl.writer.isStringableKey=function(t,e){return typeof e!="string"?(t=t.handler(e))&&t.tag(e).length===1:!0};com.cognitect.transit.impl.writer.stringableKeys=function(t,e){var r=t.unpack(e),n=!0;if(r){for(e=0;e<r.length&&(n=com.cognitect.transit.impl.writer.isStringableKey(t,r[e]),n);e+=2);return n}if(e.keys){r=e.keys();var o=null;if(r.next){for(o=r.next();!o.done&&(n=com.cognitect.transit.impl.writer.isStringableKey(t,o.value),!!n);)o=r.next();return n}}if(e.forEach)return e.forEach(function(i,s){n=n&&com.cognitect.transit.impl.writer.isStringableKey(t,s)}),n;throw Error("Cannot walk keys of object type "+com.cognitect.transit.handlers.constructor(e).name)};com.cognitect.transit.impl.writer.isForeignObject=function(t){if(t.constructor.transit$isObject)return!0;var e=t.constructor.toString();return e=e.substr(9),e=e.substr(0,e.indexOf("(")),e=e=="Object",typeof Object.defineProperty<"u"?Object.defineProperty(t.constructor,"transit$isObject",{value:e,enumerable:!1}):t.constructor.transit$isObject=e,e};com.cognitect.transit.impl.writer.emitMap=function(t,e,r,n){var o=null,i=null,s=null;if(o=null,r=0,e.constructor===Object||e.forEach!=null||t.handlerForForeign&&com.cognitect.transit.impl.writer.isForeignObject(e)){if(t.verbose){if(e.forEach!=null)if(com.cognitect.transit.impl.writer.stringableKeys(t,e)){var c={};e.forEach(function(u,l){c[com.cognitect.transit.impl.writer.marshal(t,l,!0,!1)]=com.cognitect.transit.impl.writer.marshal(t,u,!1,n)})}else{if(o=t.unpack(e),i=[],s=t.emitString(com.cognitect.transit.delimiters.ESC_TAG,"cmap","",!0,n),o)for(;r<o.length;r+=2)i.push(com.cognitect.transit.impl.writer.marshal(t,o[r],!1,!1)),i.push(com.cognitect.transit.impl.writer.marshal(t,o[r+1],!1,n));else e.forEach(function(u,l){i.push(com.cognitect.transit.impl.writer.marshal(t,l,!1,!1)),i.push(com.cognitect.transit.impl.writer.marshal(t,u,!1,n))});c={},c[s]=i}else for(o=com.cognitect.transit.util.objectKeys(e),c={};r<o.length;r++)c[com.cognitect.transit.impl.writer.marshal(t,o[r],!0,!1)]=com.cognitect.transit.impl.writer.marshal(t,e[o[r]],!1,n);return c}if(e.forEach!=null){if(com.cognitect.transit.impl.writer.stringableKeys(t,e)){if(o=t.unpack(e),c=["^ "],o)for(;r<o.length;r+=2)c.push(com.cognitect.transit.impl.writer.marshal(t,o[r],!0,n)),c.push(com.cognitect.transit.impl.writer.marshal(t,o[r+1],!1,n));else e.forEach(function(u,l){c.push(com.cognitect.transit.impl.writer.marshal(t,l,!0,n)),c.push(com.cognitect.transit.impl.writer.marshal(t,u,!1,n))});return c}if(o=t.unpack(e),i=[],s=t.emitString(com.cognitect.transit.delimiters.ESC_TAG,"cmap","",!0,n),o)for(;r<o.length;r+=2)i.push(com.cognitect.transit.impl.writer.marshal(t,o[r],!1,n)),i.push(com.cognitect.transit.impl.writer.marshal(t,o[r+1],!1,n));else e.forEach(function(u,l){i.push(com.cognitect.transit.impl.writer.marshal(t,l,!1,n)),i.push(com.cognitect.transit.impl.writer.marshal(t,u,!1,n))});return[s,i]}for(c=["^ "],o=com.cognitect.transit.util.objectKeys(e);r<o.length;r++)c.push(com.cognitect.transit.impl.writer.marshal(t,o[r],!0,n)),c.push(com.cognitect.transit.impl.writer.marshal(t,e[o[r]],!1,n));return c}if(t.objectBuilder!=null)return t.objectBuilder(e,function(u){return com.cognitect.transit.impl.writer.marshal(t,u,!0,n)},function(u){return com.cognitect.transit.impl.writer.marshal(t,u,!1,n)});throw r=com.cognitect.transit.handlers.constructor(e).name,o=Error("Cannot write "+r),o.data={obj:e,type:r},o};com.cognitect.transit.impl.writer.emitTaggedMap=function(t,e,r,n,o){return t.verbose?(n={},n[t.emitString(com.cognitect.transit.delimiters.ESC_TAG,e,"",!0,o)]=com.cognitect.transit.impl.writer.marshal(t,r,!1,o),n):[t.emitString(com.cognitect.transit.delimiters.ESC_TAG,e,"",!0,o),com.cognitect.transit.impl.writer.marshal(t,r,!1,o)]};com.cognitect.transit.impl.writer.emitEncoded=function(t,e,r,n,o,i,s){if(r.length===1){if(typeof n=="string")return t.emitString(com.cognitect.transit.delimiters.ESC,r,n,i,s);if(i||t.preferStrings){if((n=t.verbose&&e.getVerboseHandler())?(r=n.tag(o),n=n.stringRep(o,n)):n=e.stringRep(o,e),n!==null)return t.emitString(com.cognitect.transit.delimiters.ESC,r,n,i,s);throw t=Error('Tag "'+r+'" cannot be encoded as string'),t.data={tag:r,rep:n,obj:o},t}}return com.cognitect.transit.impl.writer.emitTaggedMap(t,r,n,i,s)};com.cognitect.transit.impl.writer.marshal=function(t,e,r,n){t.transform!==null&&(e=t.transform(e));var o=t.handler(e)||(t.handlerForForeign?t.handlerForForeign(e,t.handlers):null),i=o?o.tag(e):null,s=o?o.rep(e):null;if(o!=null&&i!=null)switch(i){case"_":return t.emitNil(r,n);case"s":return t.emitString("","",com.cognitect.transit.impl.writer.escape(s),r,n);case"?":return t.emitBoolean(s,r,n);case"i":return t.emitInteger(s,r,n);case"d":return t.emitDouble(s,r,n);case"b":return t.emitBinary(s,r,n);case"'":return t.emitQuoted(t,s,n);case"array":return com.cognitect.transit.impl.writer.emitArray(t,s,r,n);case"map":return com.cognitect.transit.impl.writer.emitMap(t,s,r,n);default:return com.cognitect.transit.impl.writer.emitEncoded(t,o,i,s,e,r,n)}else throw t=com.cognitect.transit.handlers.constructor(e).name,r=Error("Cannot write "+t),r.data={obj:e,type:t},r};com.cognitect.transit.impl.writer.maybeQuoted=function(t,e){if(t=t.handler(e)||(t.handlerForForeign?t.handlerForForeign(e,t.handlers):null),t!=null)return t.tag(e).length===1?com.cognitect.transit.types.quoted(e):e;t=com.cognitect.transit.handlers.constructor(e).name;var r=Error("Cannot write "+t);throw r.data={obj:e,type:t},r};com.cognitect.transit.impl.writer.marshalTop=function(t,e,r,n){return JSON.stringify(com.cognitect.transit.impl.writer.marshal(t,com.cognitect.transit.impl.writer.maybeQuoted(t,e),r,n))};com.cognitect.transit.impl.writer.Writer=function(t,e){this._marshaller=t,this.options=e||{},this.cache=this.options.cache===!1?null:this.options.cache?this.options.cache:new com.cognitect.transit.caching.WriteCache};com.cognitect.transit.impl.writer.Writer.prototype.marshaller=function(){return this._marshaller};com.cognitect.transit.impl.writer.Writer.prototype.marshaller=com.cognitect.transit.impl.writer.Writer.prototype.marshaller;com.cognitect.transit.impl.writer.Writer.prototype.write=function(t,e){e=e||{};var r=e.asMapKey||!1,n=this._marshaller.verbose?!1:this.cache;return t=e.marshalTop===!1?com.cognitect.transit.impl.writer.marshal(this._marshaller,t,r,n):com.cognitect.transit.impl.writer.marshalTop(this._marshaller,t,r,n),this.cache!=null&&this.cache.clear(),t};com.cognitect.transit.impl.writer.Writer.prototype.write=com.cognitect.transit.impl.writer.Writer.prototype.write;com.cognitect.transit.impl.writer.Writer.prototype.register=function(t,e){this._marshaller.registerHandler(t,e)};com.cognitect.transit.impl.writer.Writer.prototype.register=com.cognitect.transit.impl.writer.Writer.prototype.register;com.cognitect.transit.reader=function(t,e){if(t==="json"||t==="json-verbose"||t==null)return t=new com.cognitect.transit.impl.reader.JSONUnmarshaller(e),new com.cognitect.transit.impl.reader.Reader(t,e);throw Error("Cannot create reader of type "+t)};com.cognitect.transit.writer=function(t,e){if(t==="json"||t==="json-verbose"||t==null)return t==="json-verbose"&&(e==null&&(e={}),e.verbose=!0),t=new com.cognitect.transit.impl.writer.JSONMarshaller(e),new com.cognitect.transit.impl.writer.Writer(t,e);throw e=Error('Type must be "json"'),e.data={type:t},e};com.cognitect.transit.makeWriteHandler=function(t){var e=function(){};return e.prototype.tag=t.tag,e.prototype.rep=t.rep,e.prototype.stringRep=t.stringRep,e.prototype.getVerboseHandler=t.getVerboseHandler,new e};com.cognitect.transit.makeBuilder=function(t){var e=function(){};return e.prototype.init=t.init,e.prototype.add=t.add,e.prototype.finalize=t.finalize,e.prototype.fromArray=t.fromArray,new e};com.cognitect.transit.date=com.cognitect.transit.types.date;com.cognitect.transit.integer=com.cognitect.transit.types.intValue;com.cognitect.transit.isInteger=com.cognitect.transit.types.isInteger;com.cognitect.transit.uuid=com.cognitect.transit.types.uuid;com.cognitect.transit.isUUID=com.cognitect.transit.types.isUUID;com.cognitect.transit.bigInt=com.cognitect.transit.types.bigInteger;com.cognitect.transit.isBigInt=com.cognitect.transit.types.isBigInteger;com.cognitect.transit.bigDec=com.cognitect.transit.types.bigDecimalValue;com.cognitect.transit.isBigDec=com.cognitect.transit.types.isBigDecimal;com.cognitect.transit.keyword=com.cognitect.transit.types.keyword;com.cognitect.transit.isKeyword=com.cognitect.transit.types.isKeyword;com.cognitect.transit.symbol=com.cognitect.transit.types.symbol;com.cognitect.transit.isSymbol=com.cognitect.transit.types.isSymbol;com.cognitect.transit.binary=com.cognitect.transit.types.binary;com.cognitect.transit.isBinary=com.cognitect.transit.types.isBinary;com.cognitect.transit.uri=com.cognitect.transit.types.uri;com.cognitect.transit.isURI=com.cognitect.transit.types.isURI;com.cognitect.transit.map=com.cognitect.transit.types.map;com.cognitect.transit.isMap=com.cognitect.transit.types.isMap;com.cognitect.transit.set=com.cognitect.transit.types.set;com.cognitect.transit.isSet=com.cognitect.transit.types.isSet;com.cognitect.transit.list=com.cognitect.transit.types.list;com.cognitect.transit.isList=com.cognitect.transit.types.isList;com.cognitect.transit.quoted=com.cognitect.transit.types.quoted;com.cognitect.transit.isQuoted=com.cognitect.transit.types.isQuoted;com.cognitect.transit.tagged=com.cognitect.transit.types.taggedValue;com.cognitect.transit.isTaggedValue=com.cognitect.transit.types.isTaggedValue;com.cognitect.transit.link=com.cognitect.transit.types.link;com.cognitect.transit.isLink=com.cognitect.transit.types.isLink;com.cognitect.transit.hash=com.cognitect.transit.eq.hashCode;com.cognitect.transit.hashMapLike=com.cognitect.transit.eq.hashMapLike;com.cognitect.transit.hashArrayLike=com.cognitect.transit.eq.hashArrayLike;com.cognitect.transit.equals=com.cognitect.transit.eq.equals;com.cognitect.transit.extendToEQ=com.cognitect.transit.eq.extendToEQ;com.cognitect.transit.mapToObject=function(t){var e={};return t.forEach(function(r,n){if(typeof n!="string")throw Error("Cannot convert map with non-string keys");e[n]=r}),e};com.cognitect.transit.objectToMap=function(t){var e=com.cognitect.transit.map(),r;for(r in t)t.hasOwnProperty(r)&&e.set(r,t[r]);return e};com.cognitect.transit.decoder=com.cognitect.transit.impl.decoder.decoder;com.cognitect.transit.readCache=com.cognitect.transit.caching.readCache;com.cognitect.transit.writeCache=com.cognitect.transit.caching.writeCache;com.cognitect.transit.UUIDfromString=com.cognitect.transit.types.UUIDfromString;com.cognitect.transit.randomUUID=com.cognitect.transit.util.randomUUID;com.cognitect.transit.stringableKeys=com.cognitect.transit.impl.writer.stringableKeys;transit.exports={reader:com.cognitect.transit.reader,writer:com.cognitect.transit.writer,makeBuilder:com.cognitect.transit.makeBuilder,makeWriteHandler:com.cognitect.transit.makeWriteHandler,date:com.cognitect.transit.types.date,integer:com.cognitect.transit.types.intValue,isInteger:com.cognitect.transit.types.isInteger,uuid:com.cognitect.transit.types.uuid,isUUID:com.cognitect.transit.types.isUUID,bigInt:com.cognitect.transit.types.bigInteger,isBigInt:com.cognitect.transit.types.isBigInteger,bigDec:com.cognitect.transit.types.bigDecimalValue,isBigDec:com.cognitect.transit.types.isBigDecimal,keyword:com.cognitect.transit.types.keyword,isKeyword:com.cognitect.transit.types.isKeyword,symbol:com.cognitect.transit.types.symbol,isSymbol:com.cognitect.transit.types.isSymbol,binary:com.cognitect.transit.types.binary,isBinary:com.cognitect.transit.types.isBinary,uri:com.cognitect.transit.types.uri,isURI:com.cognitect.transit.types.isURI,map:com.cognitect.transit.types.map,isMap:com.cognitect.transit.types.isMap,set:com.cognitect.transit.types.set,isSet:com.cognitect.transit.types.isSet,list:com.cognitect.transit.types.list,isList:com.cognitect.transit.types.isList,quoted:com.cognitect.transit.types.quoted,isQuoted:com.cognitect.transit.types.isQuoted,tagged:com.cognitect.transit.types.taggedValue,isTaggedValue:com.cognitect.transit.types.isTaggedValue,link:com.cognitect.transit.types.link,isLink:com.cognitect.transit.types.isLink,hash:com.cognitect.transit.eq.hashCode,hashArrayLike:com.cognitect.transit.eq.hashArrayLike,hashMapLike:com.cognitect.transit.eq.hashMapLike,equals:com.cognitect.transit.eq.equals,extendToEQ:com.cognitect.transit.eq.extendToEQ,mapToObject:com.cognitect.transit.mapToObject,objectToMap:com.cognitect.transit.objectToMap,decoder:com.cognitect.transit.impl.decoder.decoder,UUIDfromString:com.cognitect.transit.types.UUIDfromString,randomUUID:com.cognitect.transit.util.randomUUID,stringableKeys:com.cognitect.transit.impl.writer.stringableKeys,readCache:com.cognitect.transit.caching.readCache,writeCache:com.cognitect.transit.caching.writeCache};function err$1(t){const e=new Error(t);if(e.stack===void 0)try{throw e}catch{}return e}var err_1$1=err$1,Recoil_err$1=err_1$1;function lazyProxy(t,e){return new Proxy(t,{get:(n,o)=>(!(o in n)&&o in e&&(n[o]=e[o]()),n[o]),ownKeys:n=>Object.keys(n)})}var Recoil_lazyProxy=lazyProxy;function _defineProperty$6(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const{DefaultValue,RecoilLoadable,useRecoilSnapshot,useRecoilStoreID,useRecoilTransaction_UNSTABLE}=Recoil_index,{useCallback,useEffect,useRef}=react$1,DEFAULT_VALUE=new DefaultValue;function setIntersectsMap(t,e){if(t.size<=e.size){for(const r of t)if(e.has(r))return!0}else for(const r of e.keys())if(t.has(r))return!0;return!1}class Registries{constructor(){_defineProperty$6(this,"atomRegistries",new Map),_defineProperty$6(this,"nextEffectKey",0),_defineProperty$6(this,"storageRegistries",new Map)}getAtomRegistry(e,r){this.atomRegistries.has(e)||this.atomRegistries.set(e,new Map);const n=this.atomRegistries.get(e),o=n==null?void 0:n.get(r);if(o!=null)return o;const i=new Map;return n==null||n.set(r,i),i}setAtomEffect(e,r,n,o){var i;const s=this.getAtomRegistry(e,r);s.has(n.key)||s.set(n.key,{atom:n,effects:new Map});const c=this.nextEffectKey++,u={options:o,subscribedItemKeys:new Set([o.itemKey])};return(i=s.get(n.key))===null||i===void 0||i.effects.set(c,u),{effectRegistration:u,unregisterEffect:()=>{var l;return void((l=s.get(n.key))===null||l===void 0?void 0:l.effects.delete(c))}}}getStorage(e,r){var n;return(n=this.storageRegistries.get(e))===null||n===void 0?void 0:n.get(r)}setStorage(e,r,n){var o;return this.storageRegistries.has(e)||this.storageRegistries.set(e,new Map),(o=this.storageRegistries.get(e))===null||o===void 0||o.set(r,n),()=>{var i;return void((i=this.storageRegistries.get(e))===null||i===void 0?void 0:i.delete(r))}}}const registries=new Registries;function validateLoadable(t,{refine:e,actionOnFailure_UNSTABLE:r}){return RecoilLoadable.of(t).map(n=>{if(n instanceof DefaultValue)return n;const o=e(n);if(o.type==="success")return o.value;if(r==="defaultValue")return new DefaultValue;throw Recoil_err$1(`[${o.path.toString()}]: ${o.message}`)})}function readAtomItems(t,e,r){const{options:n}=t,o=e!=null?e:c=>RecoilLoadable.error(`Read functionality not provided for ${n.storeKey!=null?`"${n.storeKey}" `:""}store in useRecoilSync() hook while updating item "${c}".`);t.subscribedItemKeys=new Set;const i=c=>{t.subscribedItemKeys.add(c);const u=r!=null&&r.has(c)?r==null?void 0:r.get(c):o(c);if(RecoilLoadable.isLoadable(u)){const l=u;if(l.state==="hasError")throw l.contents}return u};let s;try{s=n.read({read:i})}catch(c){return RecoilLoadable.error(c)}return s instanceof DefaultValue?null:validateLoadable(s,n)}function writeAtomItemsToDiff(t,e,r,n){if(n!=null&&(n==null?void 0:n.state)!=="hasValue")return t;const o=r!=null?r:u=>{throw Recoil_err$1(`Read functionality not provided for ${e.storeKey!=null?`"${e.storeKey}" `:""}store in useRecoilSync() hook while writing item "${e.itemKey}".`)},i=u=>t.has(u)?t.get(u):o(u),s=(u,l)=>void t.set(u,l),c=u=>void t.set(u,DEFAULT_VALUE);return e.write({write:s,reset:c,read:i},n==null?DEFAULT_VALUE:n.contents),t}const itemsFromSnapshot=(t,e,r)=>{const n=new Map;for(const[,{atom:i,effects:s}]of registries.getAtomRegistry(t,e))for(const[,{options:c}]of s){var o;const u=r(i);writeAtomItemsToDiff(n,c,(o=registries.getStorage(t,e))===null||o===void 0?void 0:o.read,u.isSet||c.syncDefault===!0?u.loadable:null)}return n};function getWriteInterface(t,e,r,n){return Recoil_lazyProxy({diff:r},{allItems:()=>itemsFromSnapshot(t,e,n)})}function useRecoilSync({storeKey:t,write:e,read:r,listen:n}){const o=useRecoilStoreID(),i=useRecoilSnapshot(),s=useRef(i);useEffect(()=>{if(e!=null&&i!==s.current){s.current=i;const f=new Map,h=registries.getAtomRegistry(o,t),y=i.getNodes_UNSTABLE({isModified:!0});for(const m of y){const v=h.get(m.key);if(v!=null){var d,g,p;const $=i.getInfo_UNSTABLE(v.atom);if($.isSet&&((d=$.loadable)===null||d===void 0?void 0:d.contents)!==((g=v.pendingUpdate)===null||g===void 0?void 0:g.value)||!$.isSet&&!(((p=v.pendingUpdate)===null||p===void 0?void 0:p.value)instanceof DefaultValue))for(const[,{options:_}]of v.effects)writeAtomItemsToDiff(f,_,r,$.isSet||_.syncDefault===!0?$.loadable:null);delete v.pendingUpdate}}f.size&&e(getWriteInterface(o,t,f,i.getInfo_UNSTABLE))}},[r,o,i,t,e]);const c=useRecoilTransaction_UNSTABLE(({set:d,reset:g})=>p=>{const f=registries.getAtomRegistry(o,t);for(const[,h]of f)for(const[,y]of Array.from(h.effects).reverse()){const{options:m,subscribedItemKeys:v}=y;if(setIntersectsMap(v,p)){const $=readAtomItems(y,r,p);if($!=null){switch($.state){case"hasValue":$.contents instanceof DefaultValue?(h.pendingUpdate={value:DEFAULT_VALUE},g(h.atom)):(h.pendingUpdate={value:$.contents},d(h.atom,$.contents));break;case"hasError":m.actionOnFailure_UNSTABLE==="errorState"&&(h.pendingUpdate={value:DEFAULT_VALUE},g(h.atom));break;case"loading":throw Recoil_err$1("Recoil does not yet support setting atoms to an asynchronous state")}break}else h.pendingUpdate={value:DEFAULT_VALUE},g(h.atom)}}},[o,t,r]),u=useCallback((d,g)=>{c(new Map([[d,g]]))},[c]),l=useCallback(d=>{const g=registries.getAtomRegistry(o,t);for(const[,p]of g)for(const[,{subscribedItemKeys:f}]of p.effects)for(const h of f)d.has(h)||d.set(h,DEFAULT_VALUE);c(d)},[o,t,c]);useEffect(()=>n==null?void 0:n({updateItem:u,updateAllKnownItems:l}),[u,l,n]),registries.setStorage(o,t,{write:e,read:r}),useEffect(()=>registries.setStorage(o,t,{write:e,read:r}),[o,t,r,e])}function RecoilSync({children:t,...e}){return useRecoilSync(e),t}function syncEffect(t){return({node:e,trigger:r,storeID:n,setSelf:o,getLoadable:i,getInfo_UNSTABLE:s})=>{var c;const u=(c=t.itemKey)!==null&&c!==void 0?c:e.key,l={itemKey:u,read:({read:h})=>h(u),write:({write:h},y)=>h(u,y),syncDefault:!1,actionOnFailure_UNSTABLE:"errorState",...t},{storeKey:d}=l,g=registries.getStorage(n,d),{effectRegistration:p,unregisterEffect:f}=registries.setAtomEffect(n,d,e,l);if(r==="get"){const h=g==null?void 0:g.read;if(h!=null)try{const m=readAtomItems(p,h);if(m!=null)switch(m.state){case"hasValue":m.contents instanceof DefaultValue||o(m.contents);break;case"hasError":if(l.actionOnFailure_UNSTABLE==="errorState")throw m.contents;break;case"loading":o(m.toPromise());break}}catch(m){if(l.actionOnFailure_UNSTABLE==="errorState")throw m}const y=g==null?void 0:g.write;l.syncDefault===!0&&y!=null&&window.setTimeout(()=>{const m=i(e);if(m.state==="hasValue"){const v=writeAtomItemsToDiff(new Map,l,g==null?void 0:g.read,m);y(getWriteInterface(n,d,v,s))}},0)}return f}}var RecoilSync_1={useRecoilSync,RecoilSync,syncEffect,registries_FOR_TESTING:registries},RecoilSync_2=RecoilSync_1.useRecoilSync,RecoilSync_3=RecoilSync_1.RecoilSync,RecoilSync_4=RecoilSync_1.syncEffect,RecoilSync_5=RecoilSync_1.registries_FOR_TESTING,RecoilSync$1=Object.freeze({__proto__:null,useRecoilSync:RecoilSync_2,RecoilSync:RecoilSync_3,syncEffect:RecoilSync_4,registries_FOR_TESTING:RecoilSync_5});function raiseError$1(t,e){if(e!=null){const r=e.path.toString(),n=e.message;throw Recoil_err$1(`[refine.js (path=${r}, message=${n})]: ${t}`)}throw Recoil_err$1(`[refine.js (null result)]: ${t}`)}function assertion$3(t,e="assertion error"){return r=>{const n=t(r);return n.type==="success"?n.value:raiseError$1(e,n)}}function coercion$2(t,e){return r=>{const n=t(r);return e!=null&&e(n),n.type==="success"?n.value:null}}var Refine_API$1={assertion:assertion$3,coercion:coercion$2};class Path$5{constructor(e=null,r="<root>"){_defineProperty$6(this,"parent",void 0),_defineProperty$6(this,"field",void 0),this.parent=e,this.field=r}extend(e){return new Path$5(this,e)}toString(){const e=[];let r=this;for(;r!=null;){const{field:n,parent:o}=r;e.push(n),r=o}return e.reverse().join("")}}function success$4(t,e){return{type:"success",value:t,warnings:e}}function failure$4(t,e){return{type:"failure",message:t,path:e}}function compose$4(t,e){return(r,n=new Path$5)=>{const o=t(r,n);return o.type==="failure"?o:e(o,n)}}var Refine_Checkers$2={Path:Path$5,success:success$4,failure:failure$4,compose:compose$4},Refine_Checkers_1$1=Refine_Checkers$2.Path,Refine_Checkers_2$1=Refine_Checkers$2.success,Refine_Checkers_3$1=Refine_Checkers$2.failure,Refine_Checkers_4$1=Refine_Checkers$2.compose,Refine_Checkers$1$1=Object.freeze({__proto__:null,Path:Refine_Checkers_1$1,success:Refine_Checkers_2$1,failure:Refine_Checkers_3$1,compose:Refine_Checkers_4$1});const{Path:Path$1$1,compose:compose$1$1,failure:failure$1$1,success:success$1$1}=Refine_Checkers$1$1;function isPlainObject$2(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function array$2(t){return(e,r=new Path$1$1)=>{if(!Array.isArray(e))return failure$1$1("value is not an array",r);const n=e.length,o=new Array(n),i=[];for(let s=0;s<n;s++){const c=e[s],u=t(c,r.extend(`[${s}]`));if(u.type==="failure")return failure$1$1(u.message,u.path);o[s]=u.value,u.warnings.length!==0&&i.push(...u.warnings)}return success$1$1(o,i)}}function tuple$2(...t){return(e,r=new Path$1$1)=>{if(!Array.isArray(e))return failure$1$1("value is not an array",r);const n=new Array(t.length),o=[];for(const[i,s]of t.entries()){const c=s(e[i],r.extend(`[${i}]`));if(c.type==="failure")return failure$1$1(c.message,c.path);n[i]=c.value,c.warnings.length!==0&&o.push(...c.warnings)}return success$1$1(n,o)}}function dict$2(t){return(e,r=new Path$1$1)=>{if(typeof e!="object"||e===null||!isPlainObject$2(e))return failure$1$1("value is not an object",r);const n={},o=[];for(const[i,s]of Object.entries(e)){const c=t(s,r.extend(`.${i}`));if(c.type==="failure")return failure$1$1(c.message,c.path);n[i]=c.value,c.warnings.length!==0&&o.push(...c.warnings)}return success$1$1(n,o)}}class OptionalProperty$1{constructor(e){_defineProperty$6(this,"checker",void 0),this.checker=e}}function optional$2(t){return new OptionalProperty$1((e,r=new Path$1$1)=>{const n=t(e,r);return n.type==="failure"?{...n,message:"(optional property) "+n.message}:n})}function object$2(t){const e=Object.keys(t);return(r,n=new Path$1$1)=>{if(typeof r!="object"||r===null||!isPlainObject$2(r))return failure$1$1("value is not an object",n);const o={},i=[];for(const s of e){const c=t[s];let u,l;if(c instanceof OptionalProperty$1){if(u=c.checker,!r.hasOwnProperty(s))continue;l=r[s]}else u=c,l=r.hasOwnProperty(s)?r[s]:void 0;const d=u(l,n.extend(`.${s}`));if(d.type==="failure")return failure$1$1(d.message,d.path);o[s]=d.value,d.warnings.length!==0&&i.push(...d.warnings)}return success$1$1(o,i)}}function set$2(t){return(e,r=new Path$1$1)=>{if(!(e instanceof Set))return failure$1$1("value is not a Set",r);const n=new Set,o=[];for(const i of e){const s=t(i,r.extend("[]"));if(s.type==="failure")return failure$1$1(s.message,s.path);n.add(s.value),s.warnings.length&&o.push(...s.warnings)}return success$1$1(n,o)}}function map$2(t,e){return(r,n=new Path$1$1)=>{if(!(r instanceof Map))return failure$1$1("value is not a Map",n);const o=new Map,i=[];for(const[s,c]of r.entries()){const u=t(s,n.extend(`[${s}] key`));if(u.type==="failure")return failure$1$1(u.message,u.path);const l=e(c,n.extend(`[${s}]`));if(l.type==="failure")return failure$1$1(l.message,l.path);o.set(s,c),i.push(...u.warnings,...l.warnings)}return success$1$1(o,i)}}function writableArray$2(t){return compose$1$1(array$2(t),({value:e,warnings:r})=>success$1$1([...e],r))}function writableDict$2(t){return compose$1$1(dict$2(t),({value:e,warnings:r})=>success$1$1({...e},r))}function writableObject$2(t){return compose$1$1(object$2(t),({value:e,warnings:r})=>success$1$1({...e},r))}var Refine_ContainerCheckers$2={array:array$2,tuple:tuple$2,object:object$2,optional:optional$2,dict:dict$2,set:set$2,map:map$2,writableArray:writableArray$2,writableDict:writableDict$2,writableObject:writableObject$2},Refine_ContainerCheckers_1$1=Refine_ContainerCheckers$2.array,Refine_ContainerCheckers_2$1=Refine_ContainerCheckers$2.tuple,Refine_ContainerCheckers_3$1=Refine_ContainerCheckers$2.object,Refine_ContainerCheckers_4$1=Refine_ContainerCheckers$2.optional,Refine_ContainerCheckers_5$1=Refine_ContainerCheckers$2.dict,Refine_ContainerCheckers_6$1=Refine_ContainerCheckers$2.set,Refine_ContainerCheckers_7$1=Refine_ContainerCheckers$2.map,Refine_ContainerCheckers_8$1=Refine_ContainerCheckers$2.writableArray,Refine_ContainerCheckers_9$1=Refine_ContainerCheckers$2.writableDict,Refine_ContainerCheckers_10$1=Refine_ContainerCheckers$2.writableObject,Refine_ContainerCheckers$1$1=Object.freeze({__proto__:null,array:Refine_ContainerCheckers_1$1,tuple:Refine_ContainerCheckers_2$1,object:Refine_ContainerCheckers_3$1,optional:Refine_ContainerCheckers_4$1,dict:Refine_ContainerCheckers_5$1,set:Refine_ContainerCheckers_6$1,map:Refine_ContainerCheckers_7$1,writableArray:Refine_ContainerCheckers_8$1,writableDict:Refine_ContainerCheckers_9$1,writableObject:Refine_ContainerCheckers_10$1});const{assertion:assertion$1$1}=Refine_API$1;function tryParseJSONMixed$1(t,e){if(t==null)return null;try{return JSON.parse(t,e)}catch{return null}}function jsonParserEnforced$2(t,e){const r=assertion$1$1(t,e!=null?e:"value is invalid");return n=>r(tryParseJSONMixed$1(n!=null?n:""))}function jsonParser$2(t){return e=>{const r=t(tryParseJSONMixed$1(e));return r.type==="success"?r.value:null}}var Refine_JSON$1={jsonParserEnforced:jsonParserEnforced$2,jsonParser:jsonParser$2};const{Path:Path$2$1,compose:compose$2$1,failure:failure$2$1,success:success$2$1}=Refine_Checkers$1$1;function mixed$2(){return MIXED_CHECKER$1}const MIXED_CHECKER$1=t=>success$2$1(t,[]);function literal$2(t){const e=r=>JSON.stringify(r);return(r,n=new Path$2$1)=>{var o;return r===t?success$2$1(t,[]):failure$2$1(`value is not literal ${(o=e(t))!==null&&o!==void 0?o:"void"}`,n)}}function bool$2(){return(t,e=new Path$2$1)=>typeof t=="boolean"?success$2$1(t,[]):failure$2$1("value is not a boolean",e)}function number$2(){return(t,e=new Path$2$1)=>typeof t=="number"?success$2$1(t,[]):failure$2$1("value is not a number",e)}function string$2(t){return(e,r=new Path$2$1)=>typeof e!="string"?failure$2$1("value is not a string",r):t!=null&&!t.test(e)?failure$2$1(`value does not match regex: ${t.toString()}`,r):success$2$1(e,[])}function stringLiterals$2(t){return(e,r=new Path$2$1)=>{if(typeof e!="string")return failure$2$1("value must be a string",r);const n=t[e];return n==null?failure$2$1(`value is not one of ${Object.values(t).join(", ")}`,r):success$2$1(n,[])}}function date$2(){return(t,e=new Path$2$1)=>t instanceof Date?isNaN(t)?failure$2$1("invalid date",e):success$2$1(t,[]):failure$2$1("value is not a date",e)}function jsonDate$2(){return compose$2$1(string$2(),({value:t,warnings:e},r)=>{const n=new Date(t);return Number.isNaN(n)?failure$2$1("value is not valid date string",r):success$2$1(n,e)})}var Refine_PrimitiveCheckers$1={mixed:mixed$2,literal:literal$2,bool:bool$2,number:number$2,string:string$2,stringLiterals:stringLiterals$2,date:date$2,jsonDate:jsonDate$2};const{Path:Path$3$1,compose:compose$3$1,failure:failure$3$1,success:success$3$1}=Refine_Checkers$1$1;function asType$2(t,e){return compose$3$1(t,({value:r,warnings:n})=>success$3$1(e(r),n))}function unionFailure$1(t,e,r){return failure$3$1(`${t}: ${r.map(n=>n.message).join(", ")}`,e)}function or$2(t,e){return(r,n=new Path$3$1)=>{const o=t(r,n);if(o.type==="success")return success$3$1(o.value,o.warnings);const i=e(r,n);return i.type==="success"?success$3$1(i.value,i.warnings):unionFailure$1("value did not match any types in or()",n,[o,i])}}function union$2(...t){return(e,r=new Path$3$1)=>{const n=[];for(const o of t){const i=o(e,r);if(i.type==="success")return success$3$1(i.value,i.warnings);n.push(i)}return unionFailure$1("value did not match any types in union",r,n)}}function match$2(...t){return union$2(...t)}function nullable$2(t,e){const{nullWithWarningWhenInvalid:r=!1}=e!=null?e:{};return(n,o=new Path$3$1)=>{if(n==null)return success$3$1(n,[]);const i=t(n,o);if(i.type==="success")return success$3$1(i.value,i.warnings);if(r)return success$3$1(null,[i]);const{message:s,path:c}=i;return failure$3$1(s,c)}}function voidable$2(t,e){const{undefinedWithWarningWhenInvalid:r=!1}=e!=null?e:{};return(n,o=new Path$3$1)=>{if(n===void 0)return success$3$1(void 0,[]);const i=t(n,o);if(i.type==="success")return success$3$1(i.value,i.warnings);if(r)return success$3$1(void 0,[i]);const{message:s,path:c}=i;return failure$3$1(s,c)}}function withDefault$2(t,e){return(r,n=new Path$3$1)=>{if(r==null)return success$3$1(e,[]);const o=t(r,n);return o.type==="failure"||o.value!=null?o:success$3$1(e,[])}}function constraint$2(t,e){return compose$3$1(t,({value:r,warnings:n},o)=>{const i=e(r),[s,c]=typeof i=="boolean"?[i,"value failed constraint check"]:i;return s?success$3$1(r,n):failure$3$1(c,o)})}function lazy$2(t){return(e,r=new Path$3$1)=>t()(e,r)}function custom$2(t,e="failed to return non-null from custom checker."){return(r,n=new Path$3$1)=>{try{const o=t(r);return o!=null?success$3$1(o,[]):failure$3$1(e,n)}catch(o){return failure$3$1(o.message,n)}}}var Refine_UtilityCheckers$1={or:or$2,union:union$2,match:match$2,nullable:nullable$2,voidable:voidable$2,withDefault:withDefault$2,constraint:constraint$2,asType:asType$2,lazy:lazy$2,custom:custom$2};const{assertion:assertion$2$1,coercion:coercion$1$1}=Refine_API$1,{Path:Path$4$1}=Refine_Checkers$1$1,{array:array$1$1,dict:dict$1$1,map:map$1$1,object:object$1$1,optional:optional$1$1,set:set$1$1,tuple:tuple$1$1,writableArray:writableArray$1$1,writableDict:writableDict$1$1,writableObject:writableObject$1$1}=Refine_ContainerCheckers$1$1,{jsonParser:jsonParser$1$1,jsonParserEnforced:jsonParserEnforced$1$1}=Refine_JSON$1,{bool:bool$1$1,date:date$1$1,jsonDate:jsonDate$1$1,literal:literal$1$1,mixed:mixed$1$1,number:number$1$1,string:string$1$1,stringLiterals:stringLiterals$1$1}=Refine_PrimitiveCheckers$1,{asType:asType$1$1,constraint:constraint$1$1,custom:custom$1$1,lazy:lazy$1$1,match:match$1$1,nullable:nullable$1$1,or:or$1$1,union:union$1$2,voidable:voidable$1$1,withDefault:withDefault$1$1}=Refine_UtilityCheckers$1;var Refine_index$1={assertion:assertion$2$1,coercion:coercion$1$1,jsonParser:jsonParser$1$1,jsonParserEnforced:jsonParserEnforced$1$1,Path:Path$4$1,mixed:mixed$1$1,literal:literal$1$1,bool:bool$1$1,number:number$1$1,string:string$1$1,stringLiterals:stringLiterals$1$1,date:date$1$1,jsonDate:jsonDate$1$1,asType:asType$1$1,or:or$1$1,union:union$1$2,match:match$1$1,nullable:nullable$1$1,voidable:voidable$1$1,withDefault:withDefault$1$1,constraint:constraint$1$1,lazy:lazy$1$1,custom:custom$1$1,array:array$1$1,tuple:tuple$1$1,dict:dict$1$1,object:object$1$1,optional:optional$1$1,set:set$1$1,map:map$1$1,writableArray:writableArray$1$1,writableDict:writableDict$1$1,writableObject:writableObject$1$1};const{DefaultValue:DefaultValue$1,RecoilLoadable:RecoilLoadable$1}=Recoil_index,{syncEffect:syncEffect$1,useRecoilSync:useRecoilSync$1}=RecoilSync$1,{useCallback:useCallback$1,useEffect:useEffect$1,useMemo,useRef:useRef$1}=react$1,{assertion:assertion$3$1,mixed:mixed$2$1,writableDict:writableDict$2$1}=Refine_index$1,registries$1=new Map,itemStateChecker=writableDict$2$1(mixed$2$1()),refineState=assertion$3$1(itemStateChecker),wrapState=t=>new Map(Array.from(Object.entries(refineState(t)))),unwrapState=t=>Object.fromEntries(Array.from(t.entries()).filter(([,e])=>!(e instanceof DefaultValue$1)));function parseURL(t,e,r){const n=new URL(t);switch(e.part){case"href":return wrapState(r(`${n.pathname}${n.search}${n.hash}`));case"hash":return n.hash?wrapState(r(decodeURIComponent(n.hash.substr(1)))):null;case"search":return n.search?wrapState(r(decodeURIComponent(n.search.substr(1)))):null;case"queryParams":{const o=new URLSearchParams(n.search),{param:i}=e;if(i!=null){const s=o.get(i);return s!=null?wrapState(r(s)):null}return new Map(Array.from(o.entries()).map(([s,c])=>{try{return[s,r(c)]}catch(u){return[s,RecoilLoadable$1.error(u)]}}))}}throw Recoil_err$1(`Unknown URL location part: "${e.part}"`)}function encodeURL(t,e,r,n){const o=new URL(t);switch(e.part){case"href":return n(unwrapState(r));case"hash":o.hash=encodeURIComponent(n(unwrapState(r)));break;case"search":o.search=encodeURIComponent(n(unwrapState(r)));break;case"queryParams":{const{param:i}=e,s=new URLSearchParams(o.search);if(i!=null)s.set(i,n(unwrapState(r)));else for(const[c,u]of r.entries())u instanceof DefaultValue$1?s.delete(c):s.set(c,n(u));o.search=s.toString();break}default:throw Recoil_err$1(`Unknown URL location part: "${e.part}"`)}return o.href}const DEFAULT_BROWSER_INTERFACE={replaceURL:t=>history.replaceState(null,"",t),pushURL:t=>history.pushState(null,"",t),getURL:()=>window.document.location,listenChangeURL:t=>(window.addEventListener("popstate",t),()=>window.removeEventListener("popstate",t))};function RecoilURLSync({storeKey:t,location:e,serialize:r,deserialize:n,browserInterface:o,children:i}){const{getURL:s,replaceURL:c,pushURL:u,listenChangeURL:l}={...DEFAULT_BROWSER_INTERFACE,...o!=null?o:{}},d=useMemo(()=>e,[e.part,e.queryParam]),g=useCallback$1(()=>{p.current=parseURL(s(),d,n)},[s,d,n]),p=useRef$1(null),f=useRef$1(!0);f.current&&g(),f.current=!1,useEffect$1(g,[g]);const h=useCallback$1(({diff:v,allItems:$})=>{g();const _=registries$1.get(t),E=_!=null?new Set(Array.from(_).filter(([,{history:S,itemKeys:w}])=>S==="push"&&Array.from(w).some(T=>v.has(T))).map(([,{itemKeys:S}])=>S).reduce((S,w)=>S.concat(Array.from(w)),[])):null;if(E!=null&&E.size&&p.current!=null){const S=p.current;for(const[w,T]of $)E.has(w)||S.set(w,T);c(encodeURL(s(),e,S,r)),u(encodeURL(s(),e,$,r))}else c(encodeURL(s(),e,$,r));p.current=$},[s,e,u,c,r,t,g]),y=useCallback$1(v=>{var $,_;return($=p.current)!==null&&$!==void 0&&$.has(v)?(_=p.current)===null||_===void 0?void 0:_.get(v):new DefaultValue$1},[]),m=useCallback$1(({updateAllKnownItems:v})=>{function $(){g(),p.current!=null&&v(p.current)}return l($)},[l,g]);return useRecoilSync$1({storeKey:t,read:y,write:h,listen:m}),i}function urlSyncEffect({history:t="replace",...e}){const r=syncEffect$1(e);return n=>{var o;registries$1.has(e.storeKey)||registries$1.set(e.storeKey,new Map);const i=registries$1.get(e.storeKey);if(i==null)throw Recoil_err$1("Error with atom registration");i.set(n.node.key,{history:t,itemKeys:new Set([(o=e.itemKey)!==null&&o!==void 0?o:n.node.key])});const s=r(n);return()=>{i.delete(n.node.key),s==null||s()}}}var RecoilSync_URL={RecoilURLSync,urlSyncEffect};function nullthrows(t,e){if(t!=null)return t;throw Recoil_err$1(e!=null?e:"Got unexpected null or undefined")}var Recoil_nullthrows=nullthrows;const{RecoilURLSync:RecoilURLSync$1}=RecoilSync_URL,{useCallback:useCallback$2}=react$1;function RecoilURLSyncJSON(t){if(t.location.part==="href")throw Recoil_err$1('"href" location is not supported for JSON encoding');const e=useCallback$2(n=>n===void 0?"":Recoil_nullthrows(JSON.stringify(n),"Unable to serialize state with JSON"),[]),r=useCallback$2(n=>JSON.parse(n),[]);return jsx(RecoilURLSync$1,{...t,serialize:e,deserialize:r})}var RecoilSync_URLJSON={RecoilURLSyncJSON},RecoilSync_URLJSON_1=RecoilSync_URLJSON.RecoilURLSyncJSON,RecoilSync_URLJSON$1=Object.freeze({__proto__:null,RecoilURLSyncJSON:RecoilSync_URLJSON_1});const{DefaultValue:DefaultValue$2}=Recoil_index,{RecoilURLSync:RecoilURLSync$2}=RecoilSync_URL,{useCallback:useCallback$3,useMemo:useMemo$1}=react$1,BUILTIN_HANDLERS=[{tag:"Date",class:Date,write:t=>t.toISOString(),read:t=>new Date(t)},{tag:"Set",class:Set,write:t=>Array.from(t),read:t=>new Set(t)},{tag:"Map",class:Map,write:t=>Array.from(t.entries()),read:t=>new Map(t)},{tag:"__DV",class:DefaultValue$2,write:()=>0,read:()=>new DefaultValue$2}];function RecoilURLSyncTransit({handlers:t,...e}){if(e.location.part==="href")throw Recoil_err$1('"href" location is not supported for Transit encoding');const r=useMemo$1(()=>[...BUILTIN_HANDLERS,...t!=null?t:[]],[t]),n=useMemo$1(()=>transit.exports.writer("json",{handlers:transit.exports.map(r.map(c=>[c.class,transit.exports.makeWriteHandler({tag:()=>c.tag,rep:c.write})]).flat(1))}),[r]),o=useCallback$3(c=>n.write(c),[n]),i=useMemo$1(()=>transit.exports.reader("json",{handlers:r.reduce((c,{tag:u,read:l})=>(c[u]=l,c),{}),mapBuilder:{init:()=>({}),add:(c,u,l)=>(c[u]=l,c),finalize:c=>c}}),[r]),s=useCallback$3(c=>i.read(c),[i]);return jsx(RecoilURLSync$2,{...e,serialize:o,deserialize:s})}var RecoilSync_URLTransit={RecoilURLSyncTransit},RecoilSync_URLTransit_1=RecoilSync_URLTransit.RecoilURLSyncTransit,RecoilSync_URLTransit$1=Object.freeze({__proto__:null,RecoilURLSyncTransit:RecoilSync_URLTransit_1});const{RecoilSync:RecoilSync$2,syncEffect:syncEffect$2}=RecoilSync$1,{RecoilURLSync:RecoilURLSync$3,urlSyncEffect:urlSyncEffect$1}=RecoilSync_URL,{RecoilURLSyncJSON:RecoilURLSyncJSON$1}=RecoilSync_URLJSON$1,{RecoilURLSyncTransit:RecoilURLSyncTransit$1}=RecoilSync_URLTransit$1;var RecoilSync_index={RecoilSync:RecoilSync$2,syncEffect:syncEffect$2,RecoilURLSync:RecoilURLSync$3,RecoilURLSyncJSON:RecoilURLSyncJSON$1,RecoilURLSyncTransit:RecoilURLSyncTransit$1,urlSyncEffect:urlSyncEffect$1},RecoilSync_index_1=RecoilSync_index.RecoilSync,RecoilSync_index_2=RecoilSync_index.syncEffect;function err(t){const e=new Error(t);if(e.stack===void 0)try{throw e}catch{}return e}var err_1=err,Recoil_err=err_1;function raiseError(t,e){if(e!=null){const r=e.path.toString(),n=e.message;throw Recoil_err(`[refine.js (path=${r}, message=${n})]: ${t}`)}throw Recoil_err(`[refine.js (null result)]: ${t}`)}function assertion(t,e="assertion error"){return r=>{const n=t(r);return n.type==="success"?n.value:raiseError(e,n)}}function coercion(t,e){return r=>{const n=t(r);return e!=null&&e(n),n.type==="success"?n.value:null}}var Refine_API={assertion,coercion};function _defineProperty$5(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class Path{constructor(e=null,r="<root>"){_defineProperty$5(this,"parent",void 0),_defineProperty$5(this,"field",void 0),this.parent=e,this.field=r}extend(e){return new Path(this,e)}toString(){const e=[];let r=this;for(;r!=null;){const{field:n,parent:o}=r;e.push(n),r=o}return e.reverse().join("")}}function success(t,e){return{type:"success",value:t,warnings:e}}function failure(t,e){return{type:"failure",message:t,path:e}}function compose(t,e){return(r,n=new Path)=>{const o=t(r,n);return o.type==="failure"?o:e(o,n)}}var Refine_Checkers={Path,success,failure,compose},Refine_Checkers_1=Refine_Checkers.Path,Refine_Checkers_2=Refine_Checkers.success,Refine_Checkers_3=Refine_Checkers.failure,Refine_Checkers_4=Refine_Checkers.compose,Refine_Checkers$1=Object.freeze({__proto__:null,Path:Refine_Checkers_1,success:Refine_Checkers_2,failure:Refine_Checkers_3,compose:Refine_Checkers_4});const{Path:Path$1,compose:compose$1,failure:failure$1,success:success$1}=Refine_Checkers$1;function isPlainObject$1(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function array(t){return(e,r=new Path$1)=>{if(!Array.isArray(e))return failure$1("value is not an array",r);const n=e.length,o=new Array(n),i=[];for(let s=0;s<n;s++){const c=e[s],u=t(c,r.extend(`[${s}]`));if(u.type==="failure")return failure$1(u.message,u.path);o[s]=u.value,u.warnings.length!==0&&i.push(...u.warnings)}return success$1(o,i)}}function tuple(...t){return(e,r=new Path$1)=>{if(!Array.isArray(e))return failure$1("value is not an array",r);const n=new Array(t.length),o=[];for(const[i,s]of t.entries()){const c=s(e[i],r.extend(`[${i}]`));if(c.type==="failure")return failure$1(c.message,c.path);n[i]=c.value,c.warnings.length!==0&&o.push(...c.warnings)}return success$1(n,o)}}function dict(t){return(e,r=new Path$1)=>{if(typeof e!="object"||e===null||!isPlainObject$1(e))return failure$1("value is not an object",r);const n={},o=[];for(const[i,s]of Object.entries(e)){const c=t(s,r.extend(`.${i}`));if(c.type==="failure")return failure$1(c.message,c.path);n[i]=c.value,c.warnings.length!==0&&o.push(...c.warnings)}return success$1(n,o)}}class OptionalProperty{constructor(e){_defineProperty$5(this,"checker",void 0),this.checker=e}}function optional(t){return new OptionalProperty((e,r=new Path$1)=>{const n=t(e,r);return n.type==="failure"?{...n,message:"(optional property) "+n.message}:n})}function object(t){const e=Object.keys(t);return(r,n=new Path$1)=>{if(typeof r!="object"||r===null||!isPlainObject$1(r))return failure$1("value is not an object",n);const o={},i=[];for(const s of e){const c=t[s];let u,l;if(c instanceof OptionalProperty){if(u=c.checker,!r.hasOwnProperty(s))continue;l=r[s]}else u=c,l=r.hasOwnProperty(s)?r[s]:void 0;const d=u(l,n.extend(`.${s}`));if(d.type==="failure")return failure$1(d.message,d.path);o[s]=d.value,d.warnings.length!==0&&i.push(...d.warnings)}return success$1(o,i)}}function set(t){return(e,r=new Path$1)=>{if(!(e instanceof Set))return failure$1("value is not a Set",r);const n=new Set,o=[];for(const i of e){const s=t(i,r.extend("[]"));if(s.type==="failure")return failure$1(s.message,s.path);n.add(s.value),s.warnings.length&&o.push(...s.warnings)}return success$1(n,o)}}function map(t,e){return(r,n=new Path$1)=>{if(!(r instanceof Map))return failure$1("value is not a Map",n);const o=new Map,i=[];for(const[s,c]of r.entries()){const u=t(s,n.extend(`[${s}] key`));if(u.type==="failure")return failure$1(u.message,u.path);const l=e(c,n.extend(`[${s}]`));if(l.type==="failure")return failure$1(l.message,l.path);o.set(s,c),i.push(...u.warnings,...l.warnings)}return success$1(o,i)}}function writableArray(t){return compose$1(array(t),({value:e,warnings:r})=>success$1([...e],r))}function writableDict(t){return compose$1(dict(t),({value:e,warnings:r})=>success$1({...e},r))}function writableObject(t){return compose$1(object(t),({value:e,warnings:r})=>success$1({...e},r))}var Refine_ContainerCheckers={array,tuple,object,optional,dict,set,map,writableArray,writableDict,writableObject},Refine_ContainerCheckers_1=Refine_ContainerCheckers.array,Refine_ContainerCheckers_2=Refine_ContainerCheckers.tuple,Refine_ContainerCheckers_3=Refine_ContainerCheckers.object,Refine_ContainerCheckers_4=Refine_ContainerCheckers.optional,Refine_ContainerCheckers_5=Refine_ContainerCheckers.dict,Refine_ContainerCheckers_6=Refine_ContainerCheckers.set,Refine_ContainerCheckers_7=Refine_ContainerCheckers.map,Refine_ContainerCheckers_8=Refine_ContainerCheckers.writableArray,Refine_ContainerCheckers_9=Refine_ContainerCheckers.writableDict,Refine_ContainerCheckers_10=Refine_ContainerCheckers.writableObject,Refine_ContainerCheckers$1=Object.freeze({__proto__:null,array:Refine_ContainerCheckers_1,tuple:Refine_ContainerCheckers_2,object:Refine_ContainerCheckers_3,optional:Refine_ContainerCheckers_4,dict:Refine_ContainerCheckers_5,set:Refine_ContainerCheckers_6,map:Refine_ContainerCheckers_7,writableArray:Refine_ContainerCheckers_8,writableDict:Refine_ContainerCheckers_9,writableObject:Refine_ContainerCheckers_10});const{assertion:assertion$1}=Refine_API;function tryParseJSONMixed(t,e){if(t==null)return null;try{return JSON.parse(t,e)}catch{return null}}function jsonParserEnforced(t,e){const r=assertion$1(t,e!=null?e:"value is invalid");return n=>r(tryParseJSONMixed(n!=null?n:""))}function jsonParser(t){return e=>{const r=t(tryParseJSONMixed(e));return r.type==="success"?r.value:null}}var Refine_JSON={jsonParserEnforced,jsonParser};const{Path:Path$2,compose:compose$2,failure:failure$2,success:success$2}=Refine_Checkers$1;function mixed(){return MIXED_CHECKER}const MIXED_CHECKER=t=>success$2(t,[]);function literal(t){const e=r=>JSON.stringify(r);return(r,n=new Path$2)=>{var o;return r===t?success$2(t,[]):failure$2(`value is not literal ${(o=e(t))!==null&&o!==void 0?o:"void"}`,n)}}function bool(){return(t,e=new Path$2)=>typeof t=="boolean"?success$2(t,[]):failure$2("value is not a boolean",e)}function number(){return(t,e=new Path$2)=>typeof t=="number"?success$2(t,[]):failure$2("value is not a number",e)}function string(t){return(e,r=new Path$2)=>typeof e!="string"?failure$2("value is not a string",r):t!=null&&!t.test(e)?failure$2(`value does not match regex: ${t.toString()}`,r):success$2(e,[])}function stringLiterals(t){return(e,r=new Path$2)=>{if(typeof e!="string")return failure$2("value must be a string",r);const n=t[e];return n==null?failure$2(`value is not one of ${Object.values(t).join(", ")}`,r):success$2(n,[])}}function date(){return(t,e=new Path$2)=>t instanceof Date?isNaN(t)?failure$2("invalid date",e):success$2(t,[]):failure$2("value is not a date",e)}function jsonDate(){return compose$2(string(),({value:t,warnings:e},r)=>{const n=new Date(t);return Number.isNaN(n)?failure$2("value is not valid date string",r):success$2(n,e)})}var Refine_PrimitiveCheckers={mixed,literal,bool,number,string,stringLiterals,date,jsonDate};const{Path:Path$3,compose:compose$3,failure:failure$3,success:success$3}=Refine_Checkers$1;function asType(t,e){return compose$3(t,({value:r,warnings:n})=>success$3(e(r),n))}function unionFailure(t,e,r){return failure$3(`${t}: ${r.map(n=>n.message).join(", ")}`,e)}function or(t,e){return(r,n=new Path$3)=>{const o=t(r,n);if(o.type==="success")return success$3(o.value,o.warnings);const i=e(r,n);return i.type==="success"?success$3(i.value,i.warnings):unionFailure("value did not match any types in or()",n,[o,i])}}function union$1(...t){return(e,r=new Path$3)=>{const n=[];for(const o of t){const i=o(e,r);if(i.type==="success")return success$3(i.value,i.warnings);n.push(i)}return unionFailure("value did not match any types in union",r,n)}}function match(...t){return union$1(...t)}function nullable(t,e){const{nullWithWarningWhenInvalid:r=!1}=e!=null?e:{};return(n,o=new Path$3)=>{if(n==null)return success$3(n,[]);const i=t(n,o);if(i.type==="success")return success$3(i.value,i.warnings);if(r)return success$3(null,[i]);const{message:s,path:c}=i;return failure$3(s,c)}}function voidable(t,e){const{undefinedWithWarningWhenInvalid:r=!1}=e!=null?e:{};return(n,o=new Path$3)=>{if(n===void 0)return success$3(void 0,[]);const i=t(n,o);if(i.type==="success")return success$3(i.value,i.warnings);if(r)return success$3(void 0,[i]);const{message:s,path:c}=i;return failure$3(s,c)}}function withDefault(t,e){return(r,n=new Path$3)=>{if(r==null)return success$3(e,[]);const o=t(r,n);return o.type==="failure"||o.value!=null?o:success$3(e,[])}}function constraint(t,e){return compose$3(t,({value:r,warnings:n},o)=>{const i=e(r),[s,c]=typeof i=="boolean"?[i,"value failed constraint check"]:i;return s?success$3(r,n):failure$3(c,o)})}function lazy(t){return(e,r=new Path$3)=>t()(e,r)}function custom(t,e="failed to return non-null from custom checker."){return(r,n=new Path$3)=>{try{const o=t(r);return o!=null?success$3(o,[]):failure$3(e,n)}catch(o){return failure$3(o.message,n)}}}var Refine_UtilityCheckers={or,union:union$1,match,nullable,voidable,withDefault,constraint,asType,lazy,custom};const{assertion:assertion$2,coercion:coercion$1}=Refine_API,{Path:Path$4}=Refine_Checkers$1,{array:array$1,dict:dict$1,map:map$1,object:object$1,optional:optional$1,set:set$1,tuple:tuple$1,writableArray:writableArray$1,writableDict:writableDict$1,writableObject:writableObject$1}=Refine_ContainerCheckers$1,{jsonParser:jsonParser$1,jsonParserEnforced:jsonParserEnforced$1}=Refine_JSON,{bool:bool$1,date:date$1,jsonDate:jsonDate$1,literal:literal$1,mixed:mixed$1,number:number$1,string:string$1,stringLiterals:stringLiterals$1}=Refine_PrimitiveCheckers,{asType:asType$1,constraint:constraint$1,custom:custom$1,lazy:lazy$1,match:match$1,nullable:nullable$1,or:or$1,union:union$1$1,voidable:voidable$1,withDefault:withDefault$1}=Refine_UtilityCheckers;var Refine_index={assertion:assertion$2,coercion:coercion$1,jsonParser:jsonParser$1,jsonParserEnforced:jsonParserEnforced$1,Path:Path$4,mixed:mixed$1,literal:literal$1,bool:bool$1,number:number$1,string:string$1,stringLiterals:stringLiterals$1,date:date$1,jsonDate:jsonDate$1,asType:asType$1,or:or$1,union:union$1$1,match:match$1,nullable:nullable$1,voidable:voidable$1,withDefault:withDefault$1,constraint:constraint$1,lazy:lazy$1,custom:custom$1,array:array$1,tuple:tuple$1,dict:dict$1,object:object$1,optional:optional$1,set:set$1,map:map$1,writableArray:writableArray$1,writableDict:writableDict$1,writableObject:writableObject$1},Refine_index_23=Refine_index.custom;const PAGE_ATOM_KEY=generateRecoilKey$1("_pageAtom"),PAGE_ATOM_KEY_STORE_KEY=`${PAGE_ATOM_KEY}_STORE_KEY`,selectedWidgetIdAtom=Recoil_index_7({key:generateRecoilKey$1("selectedWidgetIdAtom"),default:""}),PAGE_ATOM_STATUS={canUpdate:!0},_pageAtom=Recoil_index_7({key:PAGE_ATOM_KEY,default:{id:"",name:"",rootWidgetId:"",widgets:[]},effects:[RecoilSync_index_2({storeKey:PAGE_ATOM_KEY_STORE_KEY,refine:Refine_index_23(t=>t)})]}),pageSelector=Recoil_index_8({key:generateRecoilKey$1("pageSelector"),get:({get:t})=>t(_pageAtom),set:({set:t},e)=>{PAGE_ATOM_STATUS.canUpdate=!1,t(_pageAtom,e)}}),widgetsSelector=Recoil_index_8({key:generateRecoilKey$1("widgetsSelector"),get:({get:t})=>t(pageSelector).widgets,set:({set:t},e)=>t(pageSelector,produce(r=>{if(e instanceof Recoil_index_1)return r;r.widgets=e})),cachePolicy_UNSTABLE:{eviction:"most-recent"}}),widgetByIdSelector$1=Recoil_index_8({key:generateRecoilKey$1("widgetByIdSelector"),get:({get:t})=>lodash.exports.keyBy(t(widgetsSelector),"widgetId"),cachePolicy_UNSTABLE:{eviction:"most-recent"}}),widgetSelector$1=Recoil_index_10({key:generateRecoilKey$1("widgetSelector"),get:t=>({get:e})=>e(widgetByIdSelector$1)[t],set:t=>({set:e,get:r},n)=>{e(widgetsSelector,Object.values(produce(r(widgetByIdSelector$1),o=>{if(n instanceof Recoil_index_1)return o;o[t]=n})))},cachePolicy_UNSTABLE:{eviction:"most-recent"}}),widgetRelationByWidgetIdSelector=Recoil_index_8({key:generateRecoilKey$1("widgetRelationByWidgetIdSelectorSelector"),get:({get:t})=>{const e=t(widgetByIdSelector$1);return t(widgetsSelector).reduce((r,n)=>{const o=n.widgetId;Reflect.has(r,o)||(r[o]={props:n});const i=r[o];return lodash.exports.isEmpty(n.slots)||Object.entries(n.slots).forEach(([s,c])=>{c.forEach(u=>{Reflect.has(r,u)?(r[u].parent=i,r[u].slotName=s):r[u]={props:e[u],parent:i,slotName:s}})}),r},{})},cachePolicy_UNSTABLE:{eviction:"most-recent"}}),pageOutlineTreeSelector=Recoil_index_8({key:generateRecoilKey$1("pageOutlineTreeSelector"),get:({get:t})=>{var c,u,l,d;const e=t(pageSelector),r=t(widgetByIdSelector$1),n=r[e.rootWidgetId],o=[{key:e.id,title:e.name,page:e,nodeType:"page",children:[]}],i=lodash.exports.head(o),s=[n];for(;s.length!==0;){const g=s.pop(),p={key:(c=g==null?void 0:g.widgetId)!=null?c:"",title:(u=g==null?void 0:g.widgetName)!=null?u:"",nodeType:"widget",widget:g,children:[]},f=o.pop();f==null||f.children.unshift(p),lodash.exports.isEmpty((l=g==null?void 0:g.slots)==null?void 0:l.children)||(d=g==null?void 0:g.slots)==null||d.children.forEach(h=>{s.push(r[h]),o.push(p)})}return i},cachePolicy_UNSTABLE:{eviction:"most-recent"}}),isRootWidgetSelector=Recoil_index_10({key:generateRecoilKey$1("isRootWidgetSelector"),get:t=>({get:e})=>!e(widgetRelationByWidgetIdSelector)[t].parent,cachePolicy_UNSTABLE:{eviction:"most-recent"}});var isFunction=function t(e){return typeof e=="function"},isString=function t(e){return typeof e=="string"},isNumber=function t(e){return typeof e=="number"};function depsAreSame(t,e){if(t===e)return!0;for(var r=0;r<t.length;r++)if(!Object.is(t[r],e[r]))return!1;return!0}function useLatest(t){var e=react.exports.useRef(t);return e.current=t,e}var useUnmount=function t(e){var r=useLatest(e);react.exports.useEffect(function(){return function(){r.current()}},[])};const useUnmount$1=useUnmount;var isBrowser=!!(typeof window<"u"&&window.document&&window.document.createElement);const isBrowser$1=isBrowser;function getTargetElement(t,e){if(!!isBrowser$1){if(!t)return e;var r;return isFunction(t)?r=t():"current"in t?r=t.current:r=t,r}}var createEffectWithTarget=function t(e){var r=function(o,i,s){var c=react.exports.useRef(!1),u=react.exports.useRef([]),l=react.exports.useRef([]),d=react.exports.useRef();e(function(){var g,p=Array.isArray(s)?s:[s],f=p.map(function(h){return getTargetElement(h)});if(!c.current){c.current=!0,u.current=f,l.current=i,d.current=o();return}(f.length!==u.current.length||!depsAreSame(f,u.current)||!depsAreSame(i,l.current))&&((g=d.current)===null||g===void 0||g.call(d),u.current=f,l.current=i,d.current=o())}),useUnmount$1(function(){var g;(g=d.current)===null||g===void 0||g.call(d),c.current=!1})};return r};const createEffectWithTarget$1=createEffectWithTarget;var useEffectWithTarget=createEffectWithTarget$1(react.exports.useEffect);const useEffectWithTarget$1=useEffectWithTarget;function useEventListener(t,e,r){r===void 0&&(r={});var n=useLatest(e);useEffectWithTarget$1(function(){var o=getTargetElement(r.target,window);if(!!(o!=null&&o.addEventListener)){var i=function(c){return n.current(c)};return o.addEventListener(t,i,{capture:r.capture,once:r.once,passive:r.passive}),function(){o.removeEventListener(t,i,{capture:r.capture})}}},[t,r.capture,r.once,r.passive],r.target)}var depsEqual=function t(e,r){return r===void 0&&(r=[]),isEqual_1(e,r)},useDeepCompareEffectWithTarget=function t(e,r,n){var o=react.exports.useRef(),i=react.exports.useRef(0);depsEqual(r,o.current)||(o.current=r,i.current+=1),useEffectWithTarget$1(e,[i.current],n)};const useDeepCompareEffectWithTarget$1=useDeepCompareEffectWithTarget;var __values=globalThis&&globalThis.__values||function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},aliasKeyCodeMap={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pausebreak:19,capslock:20,esc:27,space:32,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,delete:46,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftwindowkey:91,rightwindowkey:92,selectkey:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalpoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,semicolon:186,equalsign:187,comma:188,dash:189,period:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222},modifierKey={ctrl:function t(e){return e.ctrlKey},shift:function t(e){return e.shiftKey},alt:function t(e){return e.altKey},meta:function t(e){return e.metaKey}};function countKeyByEvent(t){var e=Object.keys(modifierKey).reduce(function(r,n){return modifierKey[n](t)?r+1:r},0);return[16,17,18,91,92].includes(t.keyCode)?e:e+1}function genFilterKey(t,e,r){var n,o;if(!t.key)return!1;if(isNumber(e))return t.keyCode===e;var i=e.split("."),s=0;try{for(var c=__values(i),u=c.next();!u.done;u=c.next()){var l=u.value,d=modifierKey[l],g=aliasKeyCodeMap[l.toLowerCase()];(d&&d(t)||g&&g===t.keyCode)&&s++}}catch(p){n={error:p}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}return r?s===i.length&&countKeyByEvent(t)===i.length:s===i.length}function genKeyFormatter(t,e){return isFunction(t)?t:isString(t)||isNumber(t)?function(r){return genFilterKey(r,t,e)}:Array.isArray(t)?function(r){return t.some(function(n){return genFilterKey(r,n,e)})}:t?function(){return!0}:function(){return!1}}var defaultEvents=["keydown"];function useKeyPress(t,e,r){var n=r||{},o=n.events,i=o===void 0?defaultEvents:o,s=n.target,c=n.exactMatch,u=c===void 0?!1:c,l=useLatest(e),d=useLatest(t);useDeepCompareEffectWithTarget$1(function(){var g,p,f,h=getTargetElement(s,window);if(!!h){var y=function(E){var S,w=genKeyFormatter(d.current,u);if(w(E))return(S=l.current)===null||S===void 0?void 0:S.call(l,E)};try{for(var m=__values(i),v=m.next();!v.done;v=m.next()){var $=v.value;(f=h==null?void 0:h.addEventListener)===null||f===void 0||f.call(h,$,y)}}catch(_){g={error:_}}finally{try{v&&!v.done&&(p=m.return)&&p.call(m)}finally{if(g)throw g.error}}return function(){var _,E,S;try{for(var w=__values(i),T=w.next();!T.done;T=w.next()){var R=T.value;(S=h==null?void 0:h.removeEventListener)===null||S===void 0||S.call(h,R,y)}}catch(C){_={error:C}}finally{try{T&&!T.done&&(E=w.return)&&E.call(w)}finally{if(_)throw _.error}}}}},[i],s)}var useMutationObserver=function t(e,r,n){n===void 0&&(n={});var o=useLatest(e);useDeepCompareEffectWithTarget$1(function(){var i=getTargetElement(r);if(!!i){var s=new MutationObserver(o.current);return s.observe(i,n),function(){s&&s.disconnect()}}},[n],r)};const useMutationObserver$1=useMutationObserver,useWidgetHovering=t=>{var s,c,u,l;const[e,r]=react.exports.useState({x:0,y:0,width:0,height:0}),[n,o]=react.exports.useState(!1);return useEventListener("mousemove",()=>{o(!1)},{target:document.body,capture:!0,passive:!0}),useEventListener("mousemove",d=>{const g=getRawElement(d.target,t.current);if(g){const p=g.getClientRects()[0];r({x:p.x,y:p.y,width:p.width,height:p.height}),o(!0)}else r({x:0,y:0,width:0,height:0}),o(!1)},{target:t,passive:!0}),{style:{width:`${(s=e.width)!=null?s:0}px`,height:`${(c=e.height)!=null?c:0}px`,left:`${(u=e.x)!=null?u:0}px`,top:`${(l=e.y)!=null?l:0}px`,display:n?"block":"none"}}},useAddWidget=()=>{const t=Recoil_index_23(widgetsSelector);return{addWidget:react.exports.useCallback(({sourceWidget:r,targetWidgetId:n,targetPosition:o,targetSlotName:i})=>{t(produce(s=>{const c=s.find(u=>u.widgetId===n);!c||(s.push(r),c.slots[i].splice(o,0,r.widgetId))}))},[t])}},useRemoveWidget=()=>{const t=Recoil_index_23(widgetsSelector);return{removeWidget:react.exports.useCallback((r,n=!0)=>{t(produce(o=>{o.forEach(c=>{lodash.exports.isObject(c.slots)&&Object.keys(c.slots).forEach(u=>{const l=c.slots[u].findIndex(d=>d===r);l!==-1&&c.slots[u].splice(l,1)})});const i=[r],s=[o.find(c=>c.widgetId===r)];for(;!lodash.exports.isEmpty(s);){const c=s.shift();lodash.exports.isObject(c.slots)&&Object.values(c.slots).forEach(u=>{u.forEach(l=>{i.push(l),s.push(o.find(d=>d.widgetId===l))})})}i.forEach(c=>{const u=o.findIndex(l=>l.widgetId===c);u!==-1&&o.splice(u,1)})}))},[t])}},useMoveWidget=()=>{const t=Recoil_index_23(widgetsSelector),e=Recoil_index_19(widgetRelationByWidgetIdSelector);return{moveWidget:react.exports.useCallback(({sourceWidgetId:n,targetPosition:o,targetSlotName:i,targetWidgetId:s})=>{t(produce(c=>{let u=-1;c.forEach(l=>{var d,g;lodash.exports.isObject(l.slots)&&Object.keys(l.slots).forEach(p=>{u===-1&&(u=l.slots[p].findIndex(f=>f===n),u!==-1&&l.slots[p].splice(u,1))}),l.widgetId===s&&(((g=(d=e[n])==null?void 0:d.parent)==null?void 0:g.props.widgetId)===s&&e[n].slotName===i?l.slots[i].splice(u<o?o-1:o,0,n):l.slots[i].splice(o,0,n))})}))},[t,e])}},DndContext=react.exports.createContext({dragDropManager:void 0});function formatProdErrorMessage(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var $$observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),randomString=function t(){return Math.random().toString(36).substring(7).split("").join(".")},ActionTypes={INIT:"@@redux/INIT"+randomString(),REPLACE:"@@redux/REPLACE"+randomString(),PROBE_UNKNOWN_ACTION:function t(){return"@@redux/PROBE_UNKNOWN_ACTION"+randomString()}};function isPlainObject(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function createStore(t,e,r){var n;if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(formatProdErrorMessage(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(formatProdErrorMessage(1));return r(createStore)(t,e)}if(typeof t!="function")throw new Error(formatProdErrorMessage(2));var o=t,i=e,s=[],c=s,u=!1;function l(){c===s&&(c=s.slice())}function d(){if(u)throw new Error(formatProdErrorMessage(3));return i}function g(y){if(typeof y!="function")throw new Error(formatProdErrorMessage(4));if(u)throw new Error(formatProdErrorMessage(5));var m=!0;return l(),c.push(y),function(){if(!!m){if(u)throw new Error(formatProdErrorMessage(6));m=!1,l();var $=c.indexOf(y);c.splice($,1),s=null}}}function p(y){if(!isPlainObject(y))throw new Error(formatProdErrorMessage(7));if(typeof y.type>"u")throw new Error(formatProdErrorMessage(8));if(u)throw new Error(formatProdErrorMessage(9));try{u=!0,i=o(i,y)}finally{u=!1}for(var m=s=c,v=0;v<m.length;v++){var $=m[v];$()}return y}function f(y){if(typeof y!="function")throw new Error(formatProdErrorMessage(10));o=y,p({type:ActionTypes.REPLACE})}function h(){var y,m=g;return y={subscribe:function($){if(typeof $!="object"||$===null)throw new Error(formatProdErrorMessage(11));function _(){$.next&&$.next(d())}_();var E=m(_);return{unsubscribe:E}}},y[$$observable]=function(){return this},y}return p({type:ActionTypes.INIT}),n={dispatch:p,subscribe:g,getState:d,replaceReducer:f},n[$$observable]=h,n}function invariant(t,e,...r){if(isProduction()&&e===void 0)throw new Error("invariant requires an error message argument");if(!t){let n;if(e===void 0)n=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let o=0;n=new Error(e.replace(/%s/g,function(){return r[o++]})),n.name="Invariant Violation"}throw n.framesToPop=1,n}}function isProduction(){return typeof process<"u"&&process.env.NODE_ENV==="production"}function get(t,e,r){return e.split(".").reduce((n,o)=>n&&n[o]?n[o]:r||null,t)}function without$1(t,e){return t.filter(r=>r!==e)}function isObject(t){return typeof t=="object"}function xor(t,e){const r=new Map,n=i=>{r.set(i,r.has(i)?r.get(i)+1:1)};t.forEach(n),e.forEach(n);const o=[];return r.forEach((i,s)=>{i===1&&o.push(s)}),o}function intersection(t,e){return t.filter(r=>e.indexOf(r)>-1)}const INIT_COORDS="dnd-core/INIT_COORDS",BEGIN_DRAG="dnd-core/BEGIN_DRAG",PUBLISH_DRAG_SOURCE="dnd-core/PUBLISH_DRAG_SOURCE",HOVER="dnd-core/HOVER",DROP="dnd-core/DROP",END_DRAG="dnd-core/END_DRAG";function setClientOffset(t,e){return{type:INIT_COORDS,payload:{sourceClientOffset:e||null,clientOffset:t||null}}}const ResetCoordinatesAction={type:INIT_COORDS,payload:{clientOffset:null,sourceClientOffset:null}};function createBeginDrag(t){return function(r=[],n={publishSource:!0}){const{publishSource:o=!0,clientOffset:i,getSourceClientOffset:s}=n,c=t.getMonitor(),u=t.getRegistry();t.dispatch(setClientOffset(i)),verifyInvariants$1(r,c,u);const l=getDraggableSource(r,c);if(l==null){t.dispatch(ResetCoordinatesAction);return}let d=null;if(i){if(!s)throw new Error("getSourceClientOffset must be defined");verifyGetSourceClientOffsetIsFunction(s),d=s(l)}t.dispatch(setClientOffset(i,d));const p=u.getSource(l).beginDrag(c,l);if(p==null)return;verifyItemIsObject(p),u.pinSource(l);const f=u.getSourceType(l);return{type:BEGIN_DRAG,payload:{itemType:f,item:p,sourceId:l,clientOffset:i||null,sourceClientOffset:d||null,isSourcePublic:!!o}}}}function verifyInvariants$1(t,e,r){invariant(!e.isDragging(),"Cannot call beginDrag while dragging."),t.forEach(function(n){invariant(r.getSource(n),"Expected sourceIds to be registered.")})}function verifyGetSourceClientOffsetIsFunction(t){invariant(typeof t=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function verifyItemIsObject(t){invariant(isObject(t),"Item must be an object.")}function getDraggableSource(t,e){let r=null;for(let n=t.length-1;n>=0;n--)if(e.canDragSource(t[n])){r=t[n];break}return r}function _defineProperty$4(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _objectSpread$4(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable}))),n.forEach(function(o){_defineProperty$4(t,o,r[o])})}return t}function createDrop(t){return function(r={}){const n=t.getMonitor(),o=t.getRegistry();verifyInvariants(n),getDroppableTargets(n).forEach((s,c)=>{const u=determineDropResult(s,c,o,n),l={type:DROP,payload:{dropResult:_objectSpread$4({},r,u)}};t.dispatch(l)})}}function verifyInvariants(t){invariant(t.isDragging(),"Cannot call drop while not dragging."),invariant(!t.didDrop(),"Cannot call drop twice during one drag operation.")}function determineDropResult(t,e,r,n){const o=r.getTarget(t);let i=o?o.drop(n,t):void 0;return verifyDropResultType(i),typeof i>"u"&&(i=e===0?{}:n.getDropResult()),i}function verifyDropResultType(t){invariant(typeof t>"u"||isObject(t),"Drop result must either be an object or undefined.")}function getDroppableTargets(t){const e=t.getTargetIds().filter(t.canDropOnTarget,t);return e.reverse(),e}function createEndDrag(t){return function(){const r=t.getMonitor(),n=t.getRegistry();verifyIsDragging(r);const o=r.getSourceId();return o!=null&&(n.getSource(o,!0).endDrag(r,o),n.unpinSource()),{type:END_DRAG}}}function verifyIsDragging(t){invariant(t.isDragging(),"Cannot call endDrag while not dragging.")}function matchesType(t,e){return e===null?t===null:Array.isArray(t)?t.some(r=>r===e):t===e}function createHover(t){return function(r,{clientOffset:n}={}){verifyTargetIdsIsArray(r);const o=r.slice(0),i=t.getMonitor(),s=t.getRegistry(),c=i.getItemType();return removeNonMatchingTargetIds(o,s,c),checkInvariants(o,i,s),hoverAllTargets(o,i,s),{type:HOVER,payload:{targetIds:o,clientOffset:n||null}}}}function verifyTargetIdsIsArray(t){invariant(Array.isArray(t),"Expected targetIds to be an array.")}function checkInvariants(t,e,r){invariant(e.isDragging(),"Cannot call hover while not dragging."),invariant(!e.didDrop(),"Cannot call hover after drop.");for(let n=0;n<t.length;n++){const o=t[n];invariant(t.lastIndexOf(o)===n,"Expected targetIds to be unique in the passed array.");const i=r.getTarget(o);invariant(i,"Expected targetIds to be registered.")}}function removeNonMatchingTargetIds(t,e,r){for(let n=t.length-1;n>=0;n--){const o=t[n],i=e.getTargetType(o);matchesType(i,r)||t.splice(n,1)}}function hoverAllTargets(t,e,r){t.forEach(function(n){r.getTarget(n).hover(e,n)})}function createPublishDragSource(t){return function(){if(t.getMonitor().isDragging())return{type:PUBLISH_DRAG_SOURCE}}}function createDragDropActions(t){return{beginDrag:createBeginDrag(t),publishDragSource:createPublishDragSource(t),hover:createHover(t),drop:createDrop(t),endDrag:createEndDrag(t)}}class DragDropManagerImpl{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const e=this,{dispatch:r}=this.store;function n(i){return(...s)=>{const c=i.apply(e,s);typeof c<"u"&&r(c)}}const o=createDragDropActions(this);return Object.keys(o).reduce((i,s)=>{const c=o[s];return i[s]=n(c),i},{})}dispatch(e){this.store.dispatch(e)}constructor(e,r){this.isSetUp=!1,this.handleRefCountChange=()=>{const n=this.store.getState().refCount>0;this.backend&&(n&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!n&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=r,e.subscribe(this.handleRefCountChange)}}function add(t,e){return{x:t.x+e.x,y:t.y+e.y}}function subtract(t,e){return{x:t.x-e.x,y:t.y-e.y}}function getSourceClientOffset(t){const{clientOffset:e,initialClientOffset:r,initialSourceClientOffset:n}=t;return!e||!r||!n?null:subtract(add(e,n),r)}function getDifferenceFromInitialOffset(t){const{clientOffset:e,initialClientOffset:r}=t;return!e||!r?null:subtract(e,r)}const NONE=[],ALL=[];NONE.__IS_NONE__=!0;ALL.__IS_ALL__=!0;function areDirty(t,e){return t===NONE?!1:t===ALL||typeof e>"u"?!0:intersection(e,t).length>0}class DragDropMonitorImpl{subscribeToStateChange(e,r={}){const{handlerIds:n}=r;invariant(typeof e=="function","listener must be a function."),invariant(typeof n>"u"||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");let o=this.store.getState().stateId;const i=()=>{const s=this.store.getState(),c=s.stateId;try{c===o||c===o+1&&!areDirty(s.dirtyHandlerIds,n)||e()}finally{o=c}};return this.store.subscribe(i)}subscribeToOffsetChange(e){invariant(typeof e=="function","listener must be a function.");let r=this.store.getState().dragOffset;const n=()=>{const o=this.store.getState().dragOffset;o!==r&&(r=o,e())};return this.store.subscribe(n)}canDragSource(e){if(!e)return!1;const r=this.registry.getSource(e);return invariant(r,`Expected to find a valid source. sourceId=${e}`),this.isDragging()?!1:r.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;const r=this.registry.getTarget(e);if(invariant(r,`Expected to find a valid target. targetId=${e}`),!this.isDragging()||this.didDrop())return!1;const n=this.registry.getTargetType(e),o=this.getItemType();return matchesType(n,o)&&r.canDrop(this,e)}isDragging(){return Boolean(this.getItemType())}isDraggingSource(e){if(!e)return!1;const r=this.registry.getSource(e,!0);if(invariant(r,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()||!this.isSourcePublic())return!1;const n=this.registry.getSourceType(e),o=this.getItemType();return n!==o?!1:r.isDragging(this,e)}isOverTarget(e,r={shallow:!1}){if(!e)return!1;const{shallow:n}=r;if(!this.isDragging())return!1;const o=this.registry.getTargetType(e),i=this.getItemType();if(i&&!matchesType(o,i))return!1;const s=this.getTargetIds();if(!s.length)return!1;const c=s.indexOf(e);return n?c===s.length-1:c>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return getSourceClientOffset(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return getDifferenceFromInitialOffset(this.store.getState().dragOffset)}constructor(e,r){this.store=e,this.registry=r}}const scope=typeof global<"u"?global:self,BrowserMutationObserver=scope.MutationObserver||scope.WebKitMutationObserver;function makeRequestCallFromTimer(t){return function(){const r=setTimeout(o,0),n=setInterval(o,50);function o(){clearTimeout(r),clearInterval(n),t()}}}function makeRequestCallFromMutationObserver(t){let e=1;const r=new BrowserMutationObserver(t),n=document.createTextNode("");return r.observe(n,{characterData:!0}),function(){e=-e,n.data=e}}const makeRequestCall=typeof BrowserMutationObserver=="function"?makeRequestCallFromMutationObserver:makeRequestCallFromTimer;class AsapQueue{enqueueTask(e){const{queue:r,requestFlush:n}=this;r.length||(n(),this.flushing=!0),r[r.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const r=this.index;if(this.index++,e[r].call(),this.index>this.capacity){for(let n=0,o=e.length-this.index;n<o;n++)e[n]=e[n+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=makeRequestCall(this.flush),this.requestErrorThrow=makeRequestCallFromTimer(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class RawTask{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,r){this.onError=e,this.release=r,this.task=null}}class TaskFactory{create(e){const r=this.freeTasks,n=r.length?r.pop():new RawTask(this.onError,o=>r[r.length]=o);return n.task=e,n}constructor(e){this.onError=e,this.freeTasks=[]}}const asapQueue=new AsapQueue,taskFactory=new TaskFactory(asapQueue.registerPendingError);function asap(t){asapQueue.enqueueTask(taskFactory.create(t))}const ADD_SOURCE="dnd-core/ADD_SOURCE",ADD_TARGET="dnd-core/ADD_TARGET",REMOVE_SOURCE="dnd-core/REMOVE_SOURCE",REMOVE_TARGET="dnd-core/REMOVE_TARGET";function addSource(t){return{type:ADD_SOURCE,payload:{sourceId:t}}}function addTarget(t){return{type:ADD_TARGET,payload:{targetId:t}}}function removeSource(t){return{type:REMOVE_SOURCE,payload:{sourceId:t}}}function removeTarget(t){return{type:REMOVE_TARGET,payload:{targetId:t}}}function validateSourceContract(t){invariant(typeof t.canDrag=="function","Expected canDrag to be a function."),invariant(typeof t.beginDrag=="function","Expected beginDrag to be a function."),invariant(typeof t.endDrag=="function","Expected endDrag to be a function.")}function validateTargetContract(t){invariant(typeof t.canDrop=="function","Expected canDrop to be a function."),invariant(typeof t.hover=="function","Expected hover to be a function."),invariant(typeof t.drop=="function","Expected beginDrag to be a function.")}function validateType(t,e){if(e&&Array.isArray(t)){t.forEach(r=>validateType(r,!1));return}invariant(typeof t=="string"||typeof t=="symbol",e?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var HandlerRole;(function(t){t.SOURCE="SOURCE",t.TARGET="TARGET"})(HandlerRole||(HandlerRole={}));let nextUniqueId=0;function getNextUniqueId(){return nextUniqueId++}function getNextHandlerId(t){const e=getNextUniqueId().toString();switch(t){case HandlerRole.SOURCE:return`S${e}`;case HandlerRole.TARGET:return`T${e}`;default:throw new Error(`Unknown Handler Role: ${t}`)}}function parseRoleFromHandlerId(t){switch(t[0]){case"S":return HandlerRole.SOURCE;case"T":return HandlerRole.TARGET;default:throw new Error(`Cannot parse handler ID: ${t}`)}}function mapContainsValue(t,e){const r=t.entries();let n=!1;do{const{done:o,value:[,i]}=r.next();if(i===e)return!0;n=!!o}while(!n);return!1}class HandlerRegistryImpl{addSource(e,r){validateType(e),validateSourceContract(r);const n=this.addHandler(HandlerRole.SOURCE,e,r);return this.store.dispatch(addSource(n)),n}addTarget(e,r){validateType(e,!0),validateTargetContract(r);const n=this.addHandler(HandlerRole.TARGET,e,r);return this.store.dispatch(addTarget(n)),n}containsHandler(e){return mapContainsValue(this.dragSources,e)||mapContainsValue(this.dropTargets,e)}getSource(e,r=!1){return invariant(this.isSourceId(e),"Expected a valid source ID."),r&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return invariant(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}getSourceType(e){return invariant(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}getTargetType(e){return invariant(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}isSourceId(e){return parseRoleFromHandlerId(e)===HandlerRole.SOURCE}isTargetId(e){return parseRoleFromHandlerId(e)===HandlerRole.TARGET}removeSource(e){invariant(this.getSource(e),"Expected an existing source."),this.store.dispatch(removeSource(e)),asap(()=>{this.dragSources.delete(e),this.types.delete(e)})}removeTarget(e){invariant(this.getTarget(e),"Expected an existing target."),this.store.dispatch(removeTarget(e)),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){const r=this.getSource(e);invariant(r,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=r}unpinSource(){invariant(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,r,n){const o=getNextHandlerId(e);return this.types.set(o,r),e===HandlerRole.SOURCE?this.dragSources.set(o,n):e===HandlerRole.TARGET&&this.dropTargets.set(o,n),o}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}}const strictEquality=(t,e)=>t===e;function areCoordsEqual(t,e){return!t&&!e?!0:!t||!e?!1:t.x===e.x&&t.y===e.y}function areArraysEqual(t,e,r=strictEquality){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!r(t[n],e[n]))return!1;return!0}function reduce$5(t=NONE,e){switch(e.type){case HOVER:break;case ADD_SOURCE:case ADD_TARGET:case REMOVE_TARGET:case REMOVE_SOURCE:return NONE;case BEGIN_DRAG:case PUBLISH_DRAG_SOURCE:case END_DRAG:case DROP:default:return ALL}const{targetIds:r=[],prevTargetIds:n=[]}=e.payload,o=xor(r,n);if(!(o.length>0||!areArraysEqual(r,n)))return NONE;const s=n[n.length-1],c=r[r.length-1];return s!==c&&(s&&o.push(s),c&&o.push(c)),o}function _defineProperty$3(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _objectSpread$3(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable}))),n.forEach(function(o){_defineProperty$3(t,o,r[o])})}return t}const initialState$1={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function reduce$4(t=initialState$1,e){const{payload:r}=e;switch(e.type){case INIT_COORDS:case BEGIN_DRAG:return{initialSourceClientOffset:r.sourceClientOffset,initialClientOffset:r.clientOffset,clientOffset:r.clientOffset};case HOVER:return areCoordsEqual(t.clientOffset,r.clientOffset)?t:_objectSpread$3({},t,{clientOffset:r.clientOffset});case END_DRAG:case DROP:return initialState$1;default:return t}}function _defineProperty$2(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _objectSpread$2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable}))),n.forEach(function(o){_defineProperty$2(t,o,r[o])})}return t}const initialState={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function reduce$3(t=initialState,e){const{payload:r}=e;switch(e.type){case BEGIN_DRAG:return _objectSpread$2({},t,{itemType:r.itemType,item:r.item,sourceId:r.sourceId,isSourcePublic:r.isSourcePublic,dropResult:null,didDrop:!1});case PUBLISH_DRAG_SOURCE:return _objectSpread$2({},t,{isSourcePublic:!0});case HOVER:return _objectSpread$2({},t,{targetIds:r.targetIds});case REMOVE_TARGET:return t.targetIds.indexOf(r.targetId)===-1?t:_objectSpread$2({},t,{targetIds:without$1(t.targetIds,r.targetId)});case DROP:return _objectSpread$2({},t,{dropResult:r.dropResult,didDrop:!0,targetIds:[]});case END_DRAG:return _objectSpread$2({},t,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return t}}function reduce$2(t=0,e){switch(e.type){case ADD_SOURCE:case ADD_TARGET:return t+1;case REMOVE_SOURCE:case REMOVE_TARGET:return t-1;default:return t}}function reduce$1(t=0){return t+1}function _defineProperty$1(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _objectSpread$1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable}))),n.forEach(function(o){_defineProperty$1(t,o,r[o])})}return t}function reduce(t={},e){return{dirtyHandlerIds:reduce$5(t.dirtyHandlerIds,{type:e.type,payload:_objectSpread$1({},e.payload,{prevTargetIds:get(t,"dragOperation.targetIds",[])})}),dragOffset:reduce$4(t.dragOffset,e),refCount:reduce$2(t.refCount,e),dragOperation:reduce$3(t.dragOperation,e),stateId:reduce$1(t.stateId)}}function createDragDropManager(t,e=void 0,r={},n=!1){const o=makeStoreInstance(n),i=new DragDropMonitorImpl(o,new HandlerRegistryImpl(o)),s=new DragDropManagerImpl(o,i),c=t(s,e,r);return s.receiveBackend(c),s}function makeStoreInstance(t){const e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return createStore(reduce,t&&e&&e({name:"dnd-core",instanceId:"dnd-core"}))}function _objectWithoutProperties(t,e){if(t==null)return{};var r=_objectWithoutPropertiesLoose(t,e),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function _objectWithoutPropertiesLoose(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,i;for(i=0;i<n.length;i++)o=n[i],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}let refCount=0;const INSTANCE_SYM=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var DndProvider=react.exports.memo(function t(e){var{children:r}=e,n=_objectWithoutProperties(e,["children"]);const[o,i]=getDndContextValue(n);return react.exports.useEffect(()=>{if(i){const s=getGlobalContext();return++refCount,()=>{--refCount===0&&(s[INSTANCE_SYM]=null)}}},[]),jsx(DndContext.Provider,{value:o,children:r})});function getDndContextValue(t){if("manager"in t)return[{dragDropManager:t.manager},!1];const e=createSingletonDndContext(t.backend,t.context,t.options,t.debugMode),r=!t.context;return[e,r]}function createSingletonDndContext(t,e=getGlobalContext(),r,n){const o=e;return o[INSTANCE_SYM]||(o[INSTANCE_SYM]={dragDropManager:createDragDropManager(t,e,r,n)}),o[INSTANCE_SYM]}function getGlobalContext(){return typeof global<"u"?global:window}var fastDeepEqual=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,o,i;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(o=n;o--!==0;)if(!t(e[o],r[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(r).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[o]))return!1;for(o=n;o--!==0;){var s=i[o];if(!t(e[s],r[s]))return!1}return!0}return e!==e&&r!==r};const useIsomorphicLayoutEffect=typeof window<"u"?react.exports.useLayoutEffect:react.exports.useEffect;function useCollector(t,e,r){const[n,o]=react.exports.useState(()=>e(t)),i=react.exports.useCallback(()=>{const s=e(t);fastDeepEqual(n,s)||(o(s),r&&r())},[n,t,r]);return useIsomorphicLayoutEffect(i),[n,i]}function useMonitorOutput(t,e,r){const[n,o]=useCollector(t,e,r);return useIsomorphicLayoutEffect(function(){const s=t.getHandlerId();if(s!=null)return t.subscribeToStateChange(o,{handlerIds:[s]})},[t,o]),n}function useCollectedProps(t,e,r){return useMonitorOutput(e,t||(()=>({})),()=>r.reconnect())}function useOptionalFactory(t,e){const r=[...e||[]];return e==null&&typeof t!="function"&&r.push(t),react.exports.useMemo(()=>typeof t=="function"?t():t,r)}function useConnectDragSource(t){return react.exports.useMemo(()=>t.hooks.dragSource(),[t])}function useConnectDragPreview(t){return react.exports.useMemo(()=>t.hooks.dragPreview(),[t])}let isCallingCanDrag=!1,isCallingIsDragging=!1;class DragSourceMonitorImpl{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){invariant(!isCallingCanDrag,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return isCallingCanDrag=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{isCallingCanDrag=!1}}isDragging(){if(!this.sourceId)return!1;invariant(!isCallingIsDragging,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return isCallingIsDragging=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{isCallingIsDragging=!1}}subscribeToStateChange(e,r){return this.internalMonitor.subscribeToStateChange(e,r)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,r){return this.internalMonitor.isOverTarget(e,r)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}let isCallingCanDrop=!1;class DropTargetMonitorImpl{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,r){return this.internalMonitor.subscribeToStateChange(e,r)}canDrop(){if(!this.targetId)return!1;invariant(!isCallingCanDrop,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return isCallingCanDrop=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{isCallingCanDrop=!1}}isOver(e){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,e):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}function registerTarget(t,e,r){const n=r.getRegistry(),o=n.addTarget(t,e);return[o,()=>n.removeTarget(o)]}function registerSource(t,e,r){const n=r.getRegistry(),o=n.addSource(t,e);return[o,()=>n.removeSource(o)]}function shallowEqual(t,e,r,n){let o=r?r.call(n,t,e):void 0;if(o!==void 0)return!!o;if(t===e)return!0;if(typeof t!="object"||!t||typeof e!="object"||!e)return!1;const i=Object.keys(t),s=Object.keys(e);if(i.length!==s.length)return!1;const c=Object.prototype.hasOwnProperty.bind(e);for(let u=0;u<i.length;u++){const l=i[u];if(!c(l))return!1;const d=t[l],g=e[l];if(o=r?r.call(n,d,g,l):void 0,o===!1||o===void 0&&d!==g)return!1}return!0}function isRef(t){return t!==null&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function throwIfCompositeComponentElement(t){if(typeof t.type=="string")return;const e=t.type.displayName||t.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${e} into a <div>, or turn it into a drag source or a drop target itself.`)}function wrapHookToRecognizeElement(t){return(e=null,r=null)=>{if(!react.exports.isValidElement(e)){const i=e;return t(i,r),i}const n=e;return throwIfCompositeComponentElement(n),cloneWithRef(n,r?i=>t(i,r):t)}}function wrapConnectorHooks(t){const e={};return Object.keys(t).forEach(r=>{const n=t[r];if(r.endsWith("Ref"))e[r]=t[r];else{const o=wrapHookToRecognizeElement(n);e[r]=()=>o}}),e}function setRef(t,e){typeof t=="function"?t(e):t.current=e}function cloneWithRef(t,e){const r=t.ref;return invariant(typeof r!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),r?react.exports.cloneElement(t,{ref:n=>{setRef(r,n),setRef(e,n)}}):react.exports.cloneElement(t,{ref:e})}class SourceConnector{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,r=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return r&&this.disconnectDragSource(),this.handlerId?e?(r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),r):(this.lastConnectedDragSource=e,r):r}reconnectDragPreview(e=!1){const r=this.dragPreview,n=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(n&&this.disconnectDragPreview(),!!this.handlerId){if(!r){this.lastConnectedDragPreview=r;return}n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=r,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,r,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!shallowEqual(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!shallowEqual(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=wrapConnectorHooks({dragSource:(r,n)=>{this.clearDragSource(),this.dragSourceOptions=n||null,isRef(r)?this.dragSourceRef=r:this.dragSourceNode=r,this.reconnectDragSource()},dragPreview:(r,n)=>{this.clearDragPreview(),this.dragPreviewOptions=n||null,isRef(r)?this.dragPreviewRef=r:this.dragPreviewNode=r,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}class TargetConnector{get connectTarget(){return this.dropTarget}reconnect(){const e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();const r=this.dropTarget;if(!!this.handlerId){if(!r){this.lastConnectedDropTarget=r;return}e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=r,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,r,this.dropTargetOptions))}}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!shallowEqual(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=wrapConnectorHooks({dropTarget:(r,n)=>{this.clearDropTarget(),this.dropTargetOptions=n,isRef(r)?this.dropTargetRef=r:this.dropTargetNode=r,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}function useDragDropManager(){const{dragDropManager:t}=react.exports.useContext(DndContext);return invariant(t!=null,"Expected drag drop context"),t}function useDragSourceConnector(t,e){const r=useDragDropManager(),n=react.exports.useMemo(()=>new SourceConnector(r.getBackend()),[r]);return useIsomorphicLayoutEffect(()=>(n.dragSourceOptions=t||null,n.reconnect(),()=>n.disconnectDragSource()),[n,t]),useIsomorphicLayoutEffect(()=>(n.dragPreviewOptions=e||null,n.reconnect(),()=>n.disconnectDragPreview()),[n,e]),n}function useDragSourceMonitor(){const t=useDragDropManager();return react.exports.useMemo(()=>new DragSourceMonitorImpl(t),[t])}class DragSourceImpl{beginDrag(){const e=this.spec,r=this.monitor;let n=null;return typeof e.item=="object"?n=e.item:typeof e.item=="function"?n=e.item(r):n={},n!=null?n:null}canDrag(){const e=this.spec,r=this.monitor;return typeof e.canDrag=="boolean"?e.canDrag:typeof e.canDrag=="function"?e.canDrag(r):!0}isDragging(e,r){const n=this.spec,o=this.monitor,{isDragging:i}=n;return i?i(o):r===e.getSourceId()}endDrag(){const e=this.spec,r=this.monitor,n=this.connector,{end:o}=e;o&&o(r.getItem(),r),n.reconnect()}constructor(e,r,n){this.spec=e,this.monitor=r,this.connector=n}}function useDragSource(t,e,r){const n=react.exports.useMemo(()=>new DragSourceImpl(t,e,r),[e,r]);return react.exports.useEffect(()=>{n.spec=t},[t]),n}function useDragType(t){return react.exports.useMemo(()=>{const e=t.type;return invariant(e!=null,"spec.type must be defined"),e},[t])}function useRegisteredDragSource(t,e,r){const n=useDragDropManager(),o=useDragSource(t,e,r),i=useDragType(t);useIsomorphicLayoutEffect(function(){if(i!=null){const[c,u]=registerSource(i,o,n);return e.receiveHandlerId(c),r.receiveHandlerId(c),u}},[n,e,r,o,i])}function useDrag(t,e){const r=useOptionalFactory(t,e);invariant(!r.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const n=useDragSourceMonitor(),o=useDragSourceConnector(r.options,r.previewOptions);return useRegisteredDragSource(r,n,o),[useCollectedProps(r.collect,n,o),useConnectDragSource(o),useConnectDragPreview(o)]}function useConnectDropTarget(t){return react.exports.useMemo(()=>t.hooks.dropTarget(),[t])}function useDropTargetConnector(t){const e=useDragDropManager(),r=react.exports.useMemo(()=>new TargetConnector(e.getBackend()),[e]);return useIsomorphicLayoutEffect(()=>(r.dropTargetOptions=t||null,r.reconnect(),()=>r.disconnectDropTarget()),[t]),r}function useDropTargetMonitor(){const t=useDragDropManager();return react.exports.useMemo(()=>new DropTargetMonitorImpl(t),[t])}function useAccept(t){const{accept:e}=t;return react.exports.useMemo(()=>(invariant(t.accept!=null,"accept must be defined"),Array.isArray(e)?e:[e]),[e])}class DropTargetImpl{canDrop(){const e=this.spec,r=this.monitor;return e.canDrop?e.canDrop(r.getItem(),r):!0}hover(){const e=this.spec,r=this.monitor;e.hover&&e.hover(r.getItem(),r)}drop(){const e=this.spec,r=this.monitor;if(e.drop)return e.drop(r.getItem(),r)}constructor(e,r){this.spec=e,this.monitor=r}}function useDropTarget(t,e){const r=react.exports.useMemo(()=>new DropTargetImpl(t,e),[e]);return react.exports.useEffect(()=>{r.spec=t},[t]),r}function useRegisteredDropTarget(t,e,r){const n=useDragDropManager(),o=useDropTarget(t,e),i=useAccept(t);useIsomorphicLayoutEffect(function(){const[c,u]=registerTarget(i,o,n);return e.receiveHandlerId(c),r.receiveHandlerId(c),u},[n,e,o,r,i.map(s=>s.toString()).join("|")])}function useDrop(t,e){const r=useOptionalFactory(t,e),n=useDropTargetMonitor(),o=useDropTargetConnector(r.options);return useRegisteredDropTarget(r,n,o),[useCollectedProps(r.collect,n,o),useConnectDropTarget(o)]}const name="@modou/render",generateRecoilKey=t=>`@${name}/${t}`,widgetsAtom=Recoil_index_7({key:generateRecoilKey("widgetsAtom"),default:[]}),widgetByIdSelector=Recoil_index_8({key:generateRecoilKey("widgetByIdSelector"),get:({get:t})=>lodash.exports.keyBy(t(widgetsAtom),"widgetId"),cachePolicy_UNSTABLE:{eviction:"most-recent"}}),widgetSelector=Recoil_index_10({key:generateRecoilKey("widgetSelector"),get:t=>({get:e})=>e(widgetByIdSelector)[t],cachePolicy_UNSTABLE:{eviction:"most-recent"}});var WidgetDragType=(t=>(t[t.Add=0]="Add",t[t.Move=1]="Move",t))(WidgetDragType||{});const EMPTY_WIDGET_MIN_HEIGHT="36px",DROP_CONTAINER_LIMIT=6,DROP_ELEMENT_ACTIVE_BG_COLOR="rgba(0,0,0,.1)",useWidgetBgColor=({isActive:t,element:e,isContainer:r})=>{const n=Recoil_index_19(dropIndicatorAtom),o=react.exports.useRef({initialized:!1,value:""});react.exports.useEffect(()=>{!r||(o.current.initialized||(o.current={value:getComputedStyle(e).backgroundColor,initialized:!0}),t&&!n.show?e.style.backgroundColor=DROP_ELEMENT_ACTIVE_BG_COLOR:e.style.backgroundColor=o.current.value)},[n.show,e,e.style,t,r])},useWidgetMinHeight=({canSetMinHeight:t,element:e})=>{const r=react.exports.useRef({initialized:!1});react.exports.useEffect(()=>{var n;r.current.initialized||(r.current={value:getComputedStyle(e).minHeight,initialized:!0}),t?e.style.minHeight=EMPTY_WIDGET_MIN_HEIGHT:e.style.minHeight=(n=r.current.value)!=null?n:"auto"},[e,e.innerHTML,t])},useWidgetDrop=({widgetId:t,slotName:e})=>{const r=react.exports.useContext(AppFactoryContext),n=Recoil_index_19(widgetSelector(t)),{addWidget:o}=useAddWidget(),{moveWidget:i}=useMoveWidget(),s=`[data-widget-id=${t}]${e?`[data-widget-slot-name=${e}]`:""}`,c=document.querySelector(s),u=!!e&&lodash.exports.isEmpty(n.slots[e]),l=Recoil_index_23(dropIndicatorAtom),d=Recoil_index_30(({snapshot:m})=>()=>m.getLoadable(dropIndicatorAtom).contents,[]),g=Recoil_index_30(({snapshot:m})=>()=>m.getLoadable(widgetRelationByWidgetIdSelector).contents,[]),[{canDrop:p,isOverCurrent:f},h]=useDrop(()=>({accept:Object.keys(r.widgetByType),drop:(m,v)=>{if(v.didDrop())return;const _=d(),E=g(),{parent:S,slotName:w}=E[n.widgetId];if(m.type===WidgetDragType.Move)switch(_.insertPosition){case DropIndicatorInsertPositionEnum.Before:S&&w&&i({sourceWidgetId:m.widget.widgetId,targetWidgetId:S.props.widgetId,targetSlotName:w,targetPosition:S.props.slots[w].findIndex(T=>n.widgetId===T)});break;case DropIndicatorInsertPositionEnum.After:S&&w&&i({sourceWidgetId:m.widget.widgetId,targetWidgetId:S.props.widgetId,targetSlotName:w,targetPosition:S.props.slots[w].findIndex(T=>n.widgetId===T)+1});break;case DropIndicatorInsertPositionEnum.Inner:i({sourceWidgetId:m.widget.widgetId,targetWidgetId:n.widgetId,targetSlotName:e,targetPosition:n.slots[e].length});break}else switch(_.insertPosition){case DropIndicatorInsertPositionEnum.Before:S&&w&&o({sourceWidget:m.widget,targetWidgetId:S.props.widgetId,targetSlotName:w,targetPosition:S.props.slots[w].findIndex(T=>n.widgetId===T)});break;case DropIndicatorInsertPositionEnum.After:S&&w&&o({sourceWidget:m.widget,targetWidgetId:S.props.widgetId,targetSlotName:w,targetPosition:S.props.slots[w].findIndex(T=>n.widgetId===T)+1});break;case DropIndicatorInsertPositionEnum.Inner:o({sourceWidget:m.widget,targetWidgetId:n.widgetId,targetSlotName:e,targetPosition:n.slots[e].length});break}return{widget:n}},hover:(m,v)=>{var x,A;if(!v.isOver({shallow:!0}))return;const _=c.getClientRects()[0],E=(x=v.getClientOffset())!=null?x:{x:0,y:0};if(!E)return;const S={x:E.x-_.x,y:E.y-_.y},w=c.offsetWidth===((A=c.parentElement)==null?void 0:A.clientWidth),T=S.y<=DROP_CONTAINER_LIMIT||_.height-S.y<DROP_CONTAINER_LIMIT,R=S.x<=DROP_CONTAINER_LIMIT||_.width-S.x<DROP_CONTAINER_LIMIT,C=S.y*2>_.height,D=S.x*2>_.width,I=C||D?DropIndicatorInsertPositionEnum.After:DropIndicatorInsertPositionEnum.Before,O=K(!!e).with(!0,()=>R||T?I:DropIndicatorInsertPositionEnum.Inner).with(!1,()=>I).exhaustive(),P=K(w).with(!0,()=>({position:C?DropIndicatorPositionEnum.Bottom:DropIndicatorPositionEnum.Top,show:e?T:!0,insertPosition:O})).with(!1,()=>({position:D?DropIndicatorPositionEnum.Right:DropIndicatorPositionEnum.Left,show:e?R:!0,insertPosition:O})).exhaustive();l(P)},collect:m=>({canDrop:m.canDrop(),isOver:m.isOver(),isOverCurrent:m.isOver({shallow:!0})})}),[c,n]);h(c);const y=p&&f;return useWidgetBgColor({isActive:y,element:c,isContainer:!!e}),useWidgetMinHeight({canSetMinHeight:u,element:c}),{isEmptySlot:u,widget:n,element:c,isActive:y}},DEFAULT_DEPS=[],useElementRect=(t,e={deps:DEFAULT_DEPS})=>{var i,s,c,u;const[r,n]=react.exports.useState({x:0,y:0,width:0,height:0});return react.exports.useEffect(()=>{const l=t.getClientRects()[0];n({x:l.x,y:l.y,width:l.width,height:l.height})},[t,...e.deps]),{style:{width:`${(i=r.width)!=null?i:0}px`,height:`${(s=r.height)!=null?s:0}px`,left:`${(c=r.x)!=null?c:0}px`,top:`${(u=r.y)!=null?u:0}px`},rect:r}},WidgetPropsPanel=()=>{const t=Recoil_index_19(widgetByIdSelector$1),[e,r]=Recoil_index_21(selectedWidgetIdAtom),n=t[e],o=Recoil_index_23(widgetSelector$1(e)),i=Recoil_index_19(isRootWidgetSelector(e)),s=react.exports.useContext(AppFactoryContext),c=react.exports.useMemo(()=>s.widgetByType[n.widgetType].metadata,[s.widgetByType,n.widgetType]),{removeWidget:u}=useRemoveWidget(),l=Object.entries(c.jsonPropsSchema.properties.props.properties).filter(([,d])=>Reflect.has(d,SETTER_KEY)).map(([d,g])=>{const p=Reflect.get(g,SETTER_KEY),f=s.setterByType[p.type];return jsx(Form.Item,{tooltip:p.description,label:p.label,children:jsx(f,{options:p,value:n.props[d],onChange:h=>{o(produce(y=>{y.props[d]=h}))}})},d)});return jsxs(Form,{className:classes$5.panel,labelWrap:!0,size:"small",children:[jsx(Form.Item,{label:"\u7EC4\u4EF6\u7C7B\u578B",children:jsx(Typography.Text,{children:c.widgetName})}),jsx(Form.Item,{label:"\u7EC4\u4EF6\u540D\u79F0",children:jsx(Input,{value:n.widgetName,onChange:d=>{o(produce(g=>{g.widgetName=d.target.value}))},placeholder:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u540D\u79F0"})}),jsx(Divider,{style:{margin:"8px 0"}}),l,!i&&jsx(Form.Item,{wrapperCol:{span:24},children:jsx(Button,{block:!0,danger:!0,onClick:()=>{u(e),r("")},children:"\u5220\u9664"})})]})},PagePropsPanel=()=>{const[t,e]=Recoil_index_21(pageSelector);return jsx(Form,{className:classes$5.panel,labelWrap:!0,size:"small",children:jsx(Form.Item,{label:"\u9875\u9762\u540D\u79F0",children:jsx(Input,{onChange:r=>{e(produce(n=>{n.name=r.target.value}))},value:t.name})})})},CanvasDesignerPropsPanel=()=>{const t=Recoil_index_19(selectedWidgetIdAtom);return jsx("div",{style:{padding:"16px"},children:t?jsx(WidgetPropsPanel,{}):jsx(PagePropsPanel,{})})},classes$5={panel:mcss({name:"94eplg-panel",styles:"& .ant-form-item{margin-bottom:12px!important;&-control-input-content{justify-content:flex-end!important;.ant-input-number{flex:1!important;}}};label:panel;"})},RecoilWidgetsSync=({children:t,page:e,onPageChange:r})=>{const n=Recoil_index_23(selectedWidgetIdAtom),[o,i]=react.exports.useState("");return jsx(RecoilSync_index_1,{storeKey:PAGE_ATOM_KEY_STORE_KEY,listen:({updateItem:s})=>{e.id!==o&&(n(""),i(e.id)),PAGE_ATOM_STATUS.canUpdate&&s(PAGE_ATOM_KEY,e),PAGE_ATOM_STATUS.canUpdate=!0},read:s=>{if(s===PAGE_ATOM_KEY)return e},write:({diff:s})=>{for(const[c,u]of s)c===PAGE_ATOM_KEY&&r(u)},children:t})},WidgetBlock=({metadata:t})=>{const e=react.exports.useContext(AppFactoryContext),[{isDragging:r},n,o]=useDrag(()=>({type:t.widgetType,item:()=>{const c=WidgetMetadata.mrSchemeToDefaultJson(e.widgetByType[t.widgetType].metadata.jsonPropsSchema),u={...c,widgetId:generateId(),widgetName:`${c.widgetName}-${generateId(4)}`};return{type:WidgetDragType.Add,widget:u}},end:(c,u)=>{u.getDropResult()},collect:c=>({isDragging:c.isDragging(),handlerId:c.getHandlerId()}),options:{dropEffect:"copy"}})),i=react.exports.useRef(null);react.exports.useEffect(()=>{o(i,{offsetX:0,offsetY:0})},[o]);const s=r?.3:1;return jsxs(Col,{className:classes$4.widgetWrapper,style:{opacity:s},span:12,children:[jsxs(Card,{ref:i,size:"small",className:`${classes$4.widget} ${classes$4.previewWidget}`,style:{fontSize:"12px"},bodyStyle:{padding:"4px",width:"80px",backgroundColor:"rgba(0,0,0,.04)"},children:[jsx("div",{className:classes$4.previewWidgetIcon,children:t.icon}),jsx("div",{children:t.widgetName})]}),jsxs(Card,{ref:n,size:"small",className:classes$4.widget,bodyStyle:{padding:"8px 0",backgroundColor:"rgba(0,0,0,.04)"},children:[jsx("div",{className:classes$4.widgetIcon,children:t.icon}),jsx("div",{children:t.widgetName})]})]})},CanvasDesignerWidgetStencil=()=>{const t=react.exports.useContext(AppFactoryContext),e=react.exports.useMemo(()=>Object.values(t.widgetByType).reduce((r,n)=>(lodash.exports.isEmpty(r[n.group])?r[n.group]={name:getWidgetGroupLabel(n.group),widgets:[n]}:r[n.group].widgets.push(n),r),{[WidgetGroupEnum.Container]:{name:getWidgetGroupLabel(WidgetGroupEnum.Container),widgets:[]},[WidgetGroupEnum.Input]:{name:getWidgetGroupLabel(WidgetGroupEnum.Input),widgets:[]},[WidgetGroupEnum.Button]:{name:getWidgetGroupLabel(WidgetGroupEnum.Button),widgets:[]}}),[t.widgetByType]);return jsx("div",{className:classes$4.widgetsPanel,children:Object.entries(e).map(([r,{name:n,widgets:o}])=>jsxs("div",{className:classes$4.widgetsPanel,children:[jsx(Typography.Title,{level:5,children:n}),jsx(Row,{gutter:[8,8],children:o.map(({metadata:i})=>jsx(WidgetBlock,{metadata:i},i.widgetType))})]},r))})},classes$4={widgetWrapper:mcss({name:"1xbfhhi-widgetWrapper",styles:"background-color:white;label:widgetWrapper;"}),widget:mcss({name:"16mydx8-widget",styles:"text-align:center;cursor:move;user-select:none;overflow:hidden;label:widget;"}),previewWidget:mcss({name:"1lvxwgx-previewWidget",styles:"position:absolute;z-index:0;label:previewWidget;"}),previewWidgetIcon:mcss({name:"16zhy51-previewWidgetIcon",styles:"font-size:14px;line-height:14px;label:previewWidgetIcon;"}),widgetIcon:mcss({name:"16wlq57-widgetIcon",styles:"font-size:24px;line-height:24px;label:widgetIcon;"}),widgetsPanel:mcss({name:"1s1pbqc-widgetsPanel",styles:"padding:16px;label:widgetsPanel;"}),widgetGroup:mcss({name:"pcgbme-widgetGroup",styles:"padding:16px;label:widgetGroup;"})},WidgetWrapper=({widgetId:t})=>{const e=Recoil_index_19(widgetSelector(t)),r=react.exports.useContext(AppFactoryContext),n=react.exports.useMemo(()=>r.widgetByType[e.widgetType].component,[e.widgetType,r.widgetByType]),o=react.exports.useMemo(()=>Object.entries(e.slots||{}).map(([c,u])=>({key:c,elements:u.map(l=>jsx(WidgetWrapper,{widgetId:l},l))})).reduce((c,{key:u,elements:l})=>(Reflect.set(c,u,l),c),{}),[e.slots]),i=react.exports.useMemo(()=>({id:t,widgetId:t}),[t]),s=react.exports.useMemo(()=>Object.keys(o).reduce((c,u)=>(c[u]=u,c),{}),[o]);return jsx(n,{...e.props,renderSlots:o,renderSlotNames:s,instance:i})},MemoWidgetWrapper=react.exports.memo(WidgetWrapper),ReactRender=({widgets:t,rootWidgetId:e})=>{const r=Recoil_index_23(widgetsAtom);return react.exports.useEffect(()=>{r(t)},[r,t]),Recoil_index_19(widgetSelector(e))?jsx(MemoWidgetWrapper,{widgetId:e}):jsx(Spin,{size:"large"})},CanvasDesignerCanvas=()=>{const{widgets:t,rootWidgetId:e}=Recoil_index_19(pageSelector);return jsx("div",{className:classes$3.wrapper,children:jsx(ReactRender,{rootWidgetId:e,widgets:t})})},classes$3={wrapper:mcss({name:"gdtjax-wrapper",styles:"height:100%;position:revert;padding:16px;label:wrapper;"})},HoveringIndicator=({canvasRef:t})=>{const{style:e}=useWidgetHovering(t);return jsx("div",{className:"border-sky-400 border-dashed absolute",style:{...e,zIndex:999999}})},useWidgetSelected=t=>{const e=Recoil_index_23(selectedWidgetIdAtom);useEventListener("click",r=>{const n=getRawElement(r.target,t.current),o=getWidgetIdFromElement(n);e(o)},{target:t})},buttonStyle={height:"16px",lineHeight:"16px",fontSize:"12px",display:"flex",justifyContent:"center",alignItems:"center"},boxStyle={transform:"translateY(-100%)",marginTop:"-2px",borderRadius:"3px",height:"16px",display:"flex",alignItems:"center"},SelectedToolBox=()=>{const t=Recoil_index_19(selectedWidgetIdAtom),e=Recoil_index_19(widgetSelector(t)),r=Recoil_index_19(widgetRelationByWidgetIdSelector),[{isDragging:n},o,i]=useDrag(()=>({type:e.widgetType,item:()=>({type:WidgetDragType.Move,widget:e}),collect:c=>({isDragging:c.isDragging()}),options:{dropEffect:"copy"}}),[e]),s=n?"0.4":"1";return react.exports.useEffect(()=>{const c=getElementFromWidgetId(t);c&&(c.style.opacity=s,i(c))},[s,i,t]),n||!r[t].parent?null:jsx("div",{style:boxStyle,className:"bg-blue-300 absolute left-0 pointer-events-auto",children:jsxs(Button.Group,{style:buttonStyle,size:"small",children:[jsx(Button,{ref:o,style:buttonStyle,className:"cursor-move",type:"primary",icon:jsx(FullscreenOutlined,{style:buttonStyle})}),jsx(Button,{style:buttonStyle,type:"primary",children:"2"}),jsx(Button,{style:buttonStyle,type:"primary",children:"3"})]})})},SelectIndicatorContent=()=>{var h,y,m,v;const t=Recoil_index_19(selectedWidgetIdAtom),[e,r]=react.exports.useState({x:0,y:0,width:0,height:0}),n=Recoil_index_19(widgetsSelector),[o,i]=react.exports.useState(!1),[s,c]=react.exports.useState(0);react.exports.useEffect(()=>{Promise.resolve().then(()=>{c($=>$+1)})},[n]),react.exports.useEffect(()=>{if(!t){i(!1);return}const $=getElementFromWidgetId(t);if($){const _=$.getClientRects()[0];r({x:_.x,y:_.y,width:_.width,height:_.height}),i(!0)}else r({x:0,y:0,width:0,height:0}),i(!1)},[t,s]);const u={width:`${(h=e.width)!=null?h:0}px`,height:`${(y=e.height)!=null?y:0}px`,left:`${(m=e.x)!=null?m:0}px`,top:`${(v=e.y)!=null?v:0}px`,display:o?"block":"none"},l=Recoil_index_19(widgetSelector(t)),[{isDragging:d},g,p]=useDrag(()=>({type:l.widgetType,item:()=>({type:WidgetDragType.Move,widget:l}),collect:$=>({isDragging:$.isDragging()}),options:{dropEffect:"copy"}}),[l]),f=d?"0.4":"1";return react.exports.useEffect(()=>{const $=getElementFromWidgetId(t);$&&($.style.opacity=f,p($))},[f,p,t]),jsx("div",{ref:g,className:"border-sky-400 border-dashed absolute z-50",style:u,children:jsx(SelectedToolBox,{})})},SelectedIndicator=({canvasRef:t})=>(useWidgetSelected(t),Recoil_index_19(selectedWidgetIdAtom)?jsx(SelectIndicatorContent,{}):null),DROP_INDICATOR_PX="3px",DROP_INDICATOR_OFFSET_PX="-2px",WidgetDrop=({widgetId:t,slotName:e})=>{const r=Recoil_index_19(widgetsSelector),{isEmptySlot:n,widget:o,isActive:i,element:s}=useWidgetDrop({widgetId:t,slotName:e}),c=Recoil_index_19(dropIndicatorAtom),[u,l]=react.exports.useState(0),{style:d}=useElementRect(s,{deps:[u]});react.exports.useEffect(()=>{Promise.resolve().then(()=>{l(p=>p+1)})},[r]);const g=react.exports.useMemo(()=>{if(!c.show)return{};switch(c.position){case DropIndicatorPositionEnum.Top:return{width:"100%",height:DROP_INDICATOR_PX,top:DROP_INDICATOR_OFFSET_PX,left:0};case DropIndicatorPositionEnum.Right:return{width:DROP_INDICATOR_PX,height:"100%",top:0,right:DROP_INDICATOR_OFFSET_PX};case DropIndicatorPositionEnum.Bottom:return{width:"100%",height:DROP_INDICATOR_PX,bottom:DROP_INDICATOR_OFFSET_PX,left:0};case DropIndicatorPositionEnum.Left:return{width:DROP_INDICATOR_PX,height:"100%",top:0,left:DROP_INDICATOR_OFFSET_PX};default:return{}}},[c.position,c.show]);return jsxs(Fragment,{children:[n?jsx(Row,{justify:"center",align:"middle",className:"border-dashed border-gray-400 fixed pointer-events-none",style:d,children:jsx(Col,{children:jsx(Typography.Text,{type:"secondary",strong:!0,children:o.widgetType})})}):null,i?jsx(Row,{className:"pointer-events-none fixed",style:{...d,zIndex:999},children:jsx("div",{className:"absolute bg-red-500",style:g})}):null]})},MemoWidgetDrop=react.exports.memo(WidgetDrop),DropIndicator=({canvasRef:t})=>{const e=Recoil_index_19(widgetByIdSelector$1),[r,n]=react.exports.useState([]);useMutationObserver$1(()=>{const i=[...document.querySelectorAll("[data-widget-id]")];n(i.map(s=>({widgetId:getWidgetIdFromElement(s),slotName:getWidgetSlotNameFromElement(s)})).filter(s=>!!s))},t,{childList:!0,subtree:!0});const o=react.exports.useMemo(()=>r.filter(({widgetId:i})=>Reflect.has(e,i)),[r,e]);return jsx(Fragment,{children:o.map(({widgetId:i,slotName:s})=>jsx(MemoWidgetDrop,{widgetId:i,slotName:s},i))})},DesignerIndicator=({canvasRef:t})=>jsxs("div",{className:"fixed inset-0 pointer-events-none",children:[jsx(HoveringIndicator,{canvasRef:t}),jsx(SelectedIndicator,{canvasRef:t}),jsx(DropIndicator,{canvasRef:t})]});function memoize(t){let e=null;return()=>(e==null&&(e=t()),e)}function without(t,e){return t.filter(r=>r!==e)}function union(t,e){const r=new Set,n=i=>r.add(i);t.forEach(n),e.forEach(n);const o=[];return r.forEach(i=>o.push(i)),o}class EnterLeaveCounter{enter(e){const r=this.entered.length,n=o=>this.isNodeInDocument(o)&&(!o.contains||o.contains(e));return this.entered=union(this.entered.filter(n),[e]),r===0&&this.entered.length>0}leave(e){const r=this.entered.length;return this.entered=without(this.entered.filter(this.isNodeInDocument),e),r>0&&this.entered.length===0}reset(){this.entered=[]}constructor(e){this.entered=[],this.isNodeInDocument=e}}class NativeDragSource{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(e=>{Object.defineProperty(this.item,e,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${e}" until the drop event.`),null}})})}loadDataTransfer(e){if(e){const r={};Object.keys(this.config.exposeProperties).forEach(n=>{const o=this.config.exposeProperties[n];o!=null&&(r[n]={value:o(e,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,r)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(e,r){return r===e.getSourceId()}endDrag(){}constructor(e){this.config=e,this.item={},this.initializeExposedProperties()}}const FILE="__NATIVE_FILE__",URL$1="__NATIVE_URL__",TEXT="__NATIVE_TEXT__",HTML="__NATIVE_HTML__",NativeTypes=Object.freeze(Object.defineProperty({__proto__:null,FILE,URL:URL$1,TEXT,HTML},Symbol.toStringTag,{value:"Module"}));function getDataFromDataTransfer(t,e,r){const n=e.reduce((o,i)=>o||t.getData(i),"");return n!=null?n:r}const nativeTypesConfig={[FILE]:{exposeProperties:{files:t=>Array.prototype.slice.call(t.files),items:t=>t.items,dataTransfer:t=>t},matchesTypes:["Files"]},[HTML]:{exposeProperties:{html:(t,e)=>getDataFromDataTransfer(t,e,""),dataTransfer:t=>t},matchesTypes:["Html","text/html"]},[URL$1]:{exposeProperties:{urls:(t,e)=>getDataFromDataTransfer(t,e,"").split(`
`),dataTransfer:t=>t},matchesTypes:["Url","text/uri-list"]},[TEXT]:{exposeProperties:{text:(t,e)=>getDataFromDataTransfer(t,e,""),dataTransfer:t=>t},matchesTypes:["Text","text/plain"]}};function createNativeDragSource(t,e){const r=nativeTypesConfig[t];if(!r)throw new Error(`native type ${t} has no configuration`);const n=new NativeDragSource(r);return n.loadDataTransfer(e),n}function matchNativeItemType(t){if(!t)return null;const e=Array.prototype.slice.call(t.types||[]);return Object.keys(nativeTypesConfig).filter(r=>{const n=nativeTypesConfig[r];return n!=null&&n.matchesTypes?n.matchesTypes.some(o=>e.indexOf(o)>-1):!1})[0]||null}const isFirefox=memoize(()=>/firefox/i.test(navigator.userAgent)),isSafari=memoize(()=>Boolean(window.safari));class MonotonicInterpolant{interpolate(e){const{xs:r,ys:n,c1s:o,c2s:i,c3s:s}=this;let c=r.length-1;if(e===r[c])return n[c];let u=0,l=s.length-1,d;for(;u<=l;){d=Math.floor(.5*(u+l));const f=r[d];if(f<e)u=d+1;else if(f>e)l=d-1;else return n[d]}c=Math.max(0,l);const g=e-r[c],p=g*g;return n[c]+o[c]*g+i[c]*p+s[c]*g*p}constructor(e,r){const{length:n}=e,o=[];for(let f=0;f<n;f++)o.push(f);o.sort((f,h)=>e[f]<e[h]?-1:1);const i=[],s=[];let c,u;for(let f=0;f<n-1;f++)c=e[f+1]-e[f],u=r[f+1]-r[f],i.push(c),s.push(u/c);const l=[s[0]];for(let f=0;f<i.length-1;f++){const h=s[f],y=s[f+1];if(h*y<=0)l.push(0);else{c=i[f];const m=i[f+1],v=c+m;l.push(3*v/((v+m)/h+(v+c)/y))}}l.push(s[s.length-1]);const d=[],g=[];let p;for(let f=0;f<l.length-1;f++){p=s[f];const h=l[f],y=1/i[f],m=h+l[f+1]-p-p;d.push((p-h-m)*y),g.push(m*y*y)}this.xs=e,this.ys=r,this.c1s=l,this.c2s=d,this.c3s=g}}const ELEMENT_NODE=1;function getNodeClientOffset(t){const e=t.nodeType===ELEMENT_NODE?t:t.parentElement;if(!e)return null;const{top:r,left:n}=e.getBoundingClientRect();return{x:n,y:r}}function getEventClientOffset(t){return{x:t.clientX,y:t.clientY}}function isImageNode(t){var e;return t.nodeName==="IMG"&&(isFirefox()||!(!((e=document.documentElement)===null||e===void 0)&&e.contains(t)))}function getDragPreviewSize(t,e,r,n){let o=t?e.width:r,i=t?e.height:n;return isSafari()&&t&&(i/=window.devicePixelRatio,o/=window.devicePixelRatio),{dragPreviewWidth:o,dragPreviewHeight:i}}function getDragPreviewOffset(t,e,r,n,o){const i=isImageNode(e),c=getNodeClientOffset(i?t:e),u={x:r.x-c.x,y:r.y-c.y},{offsetWidth:l,offsetHeight:d}=t,{anchorX:g,anchorY:p}=n,{dragPreviewWidth:f,dragPreviewHeight:h}=getDragPreviewSize(i,e,l,d),y=()=>{let w=new MonotonicInterpolant([0,.5,1],[u.y,u.y/d*h,u.y+h-d]).interpolate(p);return isSafari()&&i&&(w+=(window.devicePixelRatio-1)*h),w},m=()=>new MonotonicInterpolant([0,.5,1],[u.x,u.x/l*f,u.x+f-l]).interpolate(g),{offsetX:v,offsetY:$}=o,_=v===0||v,E=$===0||$;return{x:_?v:m(),y:E?$:y()}}class OptionsReader{get window(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}get document(){var e;return!((e=this.globalContext)===null||e===void 0)&&e.document?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var e;return((e=this.optionsArgs)===null||e===void 0?void 0:e.rootElement)||this.window}constructor(e,r){this.ownerDocument=null,this.globalContext=e,this.optionsArgs=r}}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable}))),n.forEach(function(o){_defineProperty(t,o,r[o])})}return t}class HTML5BackendImpl{profile(){var e,r;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((e=this.dragStartSourceIds)===null||e===void 0?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((r=this.dragOverTargetIds)===null||r===void 0?void 0:r.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const e=this.rootElement;if(e!==void 0){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}teardown(){const e=this.rootElement;if(e!==void 0&&(e.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var r;(r=this.window)===null||r===void 0||r.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(e,r,n){return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,r),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDragSource(e,r,n){this.sourceNodes.set(e,r),this.sourceNodeOptions.set(e,n);const o=s=>this.handleDragStart(s,e),i=s=>this.handleSelectStart(s);return r.setAttribute("draggable","true"),r.addEventListener("dragstart",o),r.addEventListener("selectstart",i),()=>{this.sourceNodes.delete(e),this.sourceNodeOptions.delete(e),r.removeEventListener("dragstart",o),r.removeEventListener("selectstart",i),r.setAttribute("draggable","false")}}connectDropTarget(e,r){const n=s=>this.handleDragEnter(s,e),o=s=>this.handleDragOver(s,e),i=s=>this.handleDrop(s,e);return r.addEventListener("dragenter",n),r.addEventListener("dragover",o),r.addEventListener("drop",i),()=>{r.removeEventListener("dragenter",n),r.removeEventListener("dragover",o),r.removeEventListener("drop",i)}}addEventListeners(e){!e.addEventListener||(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(e){!e.removeEventListener||(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const e=this.monitor.getSourceId(),r=this.sourceNodeOptions.get(e);return _objectSpread({dropEffect:this.altKeyPressed?"copy":"move"},r||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const e=this.monitor.getSourceId(),r=this.sourcePreviewNodeOptions.get(e);return _objectSpread({anchorX:.5,anchorY:.5,captureDraggingState:!1},r||{})}isDraggingNativeItem(){const e=this.monitor.getItemType();return Object.keys(NativeTypes).some(r=>NativeTypes[r]===e)}beginDragNativeItem(e,r){this.clearCurrentDragSourceNode(),this.currentNativeSource=createNativeDragSource(e,r),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(e){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;const r=1e3;this.mouseMoveTimeoutTimer=setTimeout(()=>{var n;return(n=this.rootElement)===null||n===void 0?void 0:n.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},r)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var e;(e=this.window)===null||e===void 0||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(e,r){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(r))}handleDragEnter(e,r){this.dragEnterTargetIds.unshift(r)}handleDragOver(e,r){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(r)}handleDrop(e,r){this.dropTargetIds.unshift(r)}constructor(e,r,n){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=o=>{const i=this.sourceNodes.get(o);return i&&getNodeClientOffset(i)||null},this.endDragNativeItem=()=>{!this.isDraggingNativeItem()||(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=o=>Boolean(o&&this.document&&this.document.body&&this.document.body.contains(o)),this.endDragIfSourceWasRemovedFromDOM=()=>{const o=this.currentDragSourceNode;o==null||this.isNodeInDocument(o)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=o=>{this.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(o||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<"u"&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=o=>{if(o.defaultPrevented)return;const{dragStartSourceIds:i}=this;this.dragStartSourceIds=null;const s=getEventClientOffset(o);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(i||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:s});const{dataTransfer:c}=o,u=matchNativeItemType(c);if(this.monitor.isDragging()){if(c&&typeof c.setDragImage=="function"){const d=this.monitor.getSourceId(),g=this.sourceNodes.get(d),p=this.sourcePreviewNodes.get(d)||g;if(p){const{anchorX:f,anchorY:h,offsetX:y,offsetY:m}=this.getCurrentSourcePreviewNodeOptions(),_=getDragPreviewOffset(g,p,s,{anchorX:f,anchorY:h},{offsetX:y,offsetY:m});c.setDragImage(p,_.x,_.y)}}try{c==null||c.setData("application/json",{})}catch{}this.setCurrentDragSourceNode(o.target);const{captureDraggingState:l}=this.getCurrentSourcePreviewNodeOptions();l?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(u)this.beginDragNativeItem(u);else{if(c&&!c.types&&(o.target&&!o.target.hasAttribute||!o.target.hasAttribute("draggable")))return;o.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=o=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var i;(i=this.currentNativeSource)===null||i===void 0||i.loadDataTransfer(o.dataTransfer)}if(!this.enterLeaveCounter.enter(o.target)||this.monitor.isDragging())return;const{dataTransfer:c}=o,u=matchNativeItemType(c);u&&this.beginDragNativeItem(u,c)},this.handleTopDragEnter=o=>{const{dragEnterTargetIds:i}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=o.altKey,i.length>0&&this.actions.hover(i,{clientOffset:getEventClientOffset(o)}),i.some(c=>this.monitor.canDropOnTarget(c))&&(o.preventDefault(),o.dataTransfer&&(o.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=o=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var i;(i=this.currentNativeSource)===null||i===void 0||i.loadDataTransfer(o.dataTransfer)}},this.handleTopDragOver=o=>{const{dragOverTargetIds:i}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){o.preventDefault(),o.dataTransfer&&(o.dataTransfer.dropEffect="none");return}this.altKeyPressed=o.altKey,this.lastClientOffset=getEventClientOffset(o),this.scheduleHover(i),(i||[]).some(c=>this.monitor.canDropOnTarget(c))?(o.preventDefault(),o.dataTransfer&&(o.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?o.preventDefault():(o.preventDefault(),o.dataTransfer&&(o.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=o=>{this.isDraggingNativeItem()&&o.preventDefault(),this.enterLeaveCounter.leave(o.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=o=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var i;o.preventDefault(),(i=this.currentNativeSource)===null||i===void 0||i.loadDataTransfer(o.dataTransfer)}else matchNativeItemType(o.dataTransfer)&&o.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=o=>{const{dropTargetIds:i}=this;this.dropTargetIds=[],this.actions.hover(i,{clientOffset:getEventClientOffset(o)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=o=>{const i=o.target;typeof i.dragDrop=="function"&&(i.tagName==="INPUT"||i.tagName==="SELECT"||i.tagName==="TEXTAREA"||i.isContentEditable||(o.preventDefault(),i.dragDrop()))},this.options=new OptionsReader(r,n),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new EnterLeaveCounter(this.isNodeInDocument)}}const HTML5Backend=function t(e,r,n){return new HTML5BackendImpl(e,r,n)},CanvasDesignerOutlineTree=()=>{const t=Recoil_index_19(pageOutlineTreeSelector),[e,r]=Recoil_index_21(selectedWidgetIdAtom),n=[e||t.key],o=Recoil_index_19(widgetRelationByWidgetIdSelector),{moveWidget:i}=useMoveWidget(),s=react.exports.useContext(AppFactoryContext),c=([g])=>{const p=g===t.key?"":g;r(p)},u=({dropNode:g,dropPosition:p})=>{var y;console.log("dropNode",g,p);const{widget:f}=g;if(!f)return!1;const h=s.widgetByType[f.widgetType].metadata;return p===-1?!!o[f.widgetId].parent:p===0?!!((y=h.slots)!=null&&y.children):p===1?!!o[f.widgetId].parent:!1},l=g=>{const p=g.node.pos.split("-"),f=g.dropPosition-Number(p[p.length-1]),h=g.dragNode.widget,y=g.node.widget;if(!h||!y)return;const m=o[y.widgetId].parent,v="children";switch(f){case-1:m&&v&&i({sourceWidgetId:h.widgetId,targetWidgetId:m.props.widgetId,targetSlotName:v,targetPosition:m.props.slots[v].findIndex($=>y.widgetId===$)});break;case 1:m&&v&&i({sourceWidgetId:h.widgetId,targetWidgetId:m.props.widgetId,targetSlotName:v,targetPosition:m.props.slots[v].findIndex($=>y.widgetId===$)+1});break;case 0:i({sourceWidgetId:h.widgetId,targetWidgetId:y.widgetId,targetSlotName:v,targetPosition:0});break}console.log("dropPosition",f,g)},d=react.exports.useRef();return jsx("div",{className:classes$2.treeWrapper,children:jsx(Tree,{ref:d,showLine:!0,allowDrop:u,switcherIcon:jsx(DownOutlined,{}),selectedKeys:n,onSelect:c,defaultExpandAll:!0,draggable:{icon:!1},blockNode:!0,onDrop:l,treeData:[t]})})},classes$2={treeWrapper:mcss({name:"12n5wsf-treeWrapper",styles:"padding:16px 8px;label:treeWrapper;"})},CanvasDesignerKeyPress=()=>{const[t,e]=Recoil_index_21(selectedWidgetIdAtom),{removeWidget:r}=useRemoveWidget();return useKeyPress("delete",()=>{t&&(r(t),e(""))}),null},CanvasDesigner=({page:t,onPageChange:e})=>{const r=react.exports.useRef(null),n=Recoil_index_23(selectedWidgetIdAtom);return jsx(Recoil_index_4,{children:jsx(RecoilWidgetsSync,{page:t,onPageChange:e,children:jsx(DndProvider,{backend:HTML5Backend,children:jsxs("div",{className:classes$1.wrapper,children:[jsx("div",{className:`${classes$1.section} ${classes$1.sectionLeft}`,children:jsx(Tabs,{className:classes$1.designerPanelTabs,type:"card",tabBarGutter:0,items:[{key:"CanvasDesignerOutlineTree",label:"\u5927\u7EB2\u6811",children:jsx(CanvasDesignerOutlineTree,{})}]})}),jsxs("div",{className:`${classes$1.section} ${classes$1.canvasWrapper}`,ref:r,onClick:()=>n(""),children:[jsx(CanvasDesignerCanvas,{}),jsx(DesignerIndicator,{canvasRef:r}),jsx(CanvasDesignerKeyPress,{})]}),jsx("div",{className:`${classes$1.section} ${classes$1.sectionRight}`,children:jsx(Tabs,{className:classes$1.designerPanelTabs,type:"card",tabBarGutter:0,items:[{key:"CanvasDesignerWidgetStencil",label:"\u7EC4\u4EF6\u5217\u8868",children:jsx(CanvasDesignerWidgetStencil,{})},{key:"CanvasDesignerPropsPanel",label:"\u5C5E\u6027",children:jsx(CanvasDesignerPropsPanel,{})}]})})]})})})})},classes$1={wrapper:mcss({name:"1qh1dfk-wrapper",styles:"height:100%;display:flex;justify-content:space-between;label:wrapper;"}),section:mcss({name:"1y5zf7j-section",styles:"height:100%;background-color:white;label:section;"}),sectionLeft:mcss({name:"811yyd-sectionLeft",styles:"width:220px;label:sectionLeft;"}),sectionRight:mcss({name:"1tym3q0-sectionRight",styles:"width:280px;label:sectionRight;"}),canvasWrapper:mcss({name:"1vfvizn-canvasWrapper",styles:"position:revert;flex:1;border:1px solid rgba(0,0,0,.05);border-top:none;border-bottom:0;label:canvasWrapper;"}),designerPanelTabs:mcss({name:"ypyq22-designerPanelTabs",styles:"&>.ant-tabs-nav{margin-bottom:0;}& .ant-tabs-nav-list{display:flex;width:100%;& .ant-tabs-tab{flex:1;border-radius:0!important;display:flex;justify-content:center;align-items:center;&.ant-tabs-tab-active{border-bottom-color:rgba(5, 5, 5, 0.13)!important;}}};label:designerPanelTabs;"})},widgetFactory=AppFactory.create({widgets:[{component:ButtonWidget,metadata:buttonWidgetMetadata,group:WidgetGroupEnum.Button},{component:RowWidget,metadata:rowWidgetMetadata,group:WidgetGroupEnum.Container},{component:ColWidget,metadata:colWidgetMetadata,group:WidgetGroupEnum.Container},{component:InputWidget,metadata:inputWidgetMetadata,group:WidgetGroupEnum.Input}],setters:{[SetterTypeEnum.Select]:SelectSetter,[SetterTypeEnum.String]:StringSetter,[SetterTypeEnum.Boolean]:BooleanSetter,[SetterTypeEnum.Number]:NumberSetter}}),Page=()=>{const{pageId:t,appId:e}=useParams(),[r,n]=Recoil_index_21(Metadata.pageSelector(t)),o=useNavigate();return react.exports.useLayoutEffect(()=>{r||o(generateRouterPath(ROUTER_PATH.APP,{appId:e}),{replace:!0})},[e,o,r]),jsx(Row,{justify:"center",align:"middle",className:classes.page,children:jsx(Col,{span:24,className:classes.container,children:r&&jsx(AppFactoryContext.Provider,{value:widgetFactory,children:jsx(CanvasDesigner,{page:r,onPageChange:n})})})})},classes={page:mcss({name:"1f3h1pk-page",styles:"height:100%;label:page;"}),container:mcss({name:"cpv84f-container",styles:"height:100%;label:container;"})};export{Page};
